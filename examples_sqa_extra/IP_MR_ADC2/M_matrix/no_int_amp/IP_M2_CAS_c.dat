 For Help :: help = True
--------------------------------------------------------------
M[s_casci_a:f_casci_a, s_c:f_c] =- np.einsum('J, Jx, Ix->IJ', e_core_so, t2_ca, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('Ja, xa, Ix->IJ', h_ce_so, t1_ae, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('ix, Jixy, Iy->IJ', h_ca_so, t1_ccaa, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('ia, Jiax, Ix->IJ', h_ce_so, t1_ccea, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('xa, Ja, Ix->IJ', h_ae_so, t1_ce, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('xy, Jx, Iy->IJ', h_aa_so, t2_ca, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('Jixy, izxy, Iz->IJ', t1_ccaa, v_caaa_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('Jixy, ijjx, Iy->IJ', t1_ccaa, v_ccca_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('Jiax, iyxa, Iy->IJ', t1_ccea, v_caae_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('Jiax, ijja, Ix->IJ', t1_ccea, v_ccce_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('Jiab, ixab, Ix->IJ', t1_ccee, v_caee_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('Ja, ixia, Ix->IJ', t1_ce, v_cace_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('ix, Jxiy, Iy->IJ', t1_ca, v_caca_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('ix, Jixy, Iy->IJ', t1_ca, v_ccaa_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('ixyz, Jiyz, Ix->IJ', t1_caaa, v_ccaa_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('ixay, Jiya, Ix->IJ', t1_caea, v_ccae_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('ixab, Jiab, Ix->IJ', t1_caee, v_ccee_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('ijxy, ijJx, Iy->IJ', t1_ccaa, v_ccca_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('ijax, ijJa, Ix->IJ', t1_ccea, v_ccce_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('ia, Jixa, Ix->IJ', t1_ce, v_ccae_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('xa, Jiia, Ix->IJ', t1_ae, v_ccce_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('ia, ixJa, Ix->IJ', t1_ce, v_cace_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('Jx, iyix, Iy->IJ', t2_ca, v_caca_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('J, Jixy, ix, Iy->IJ', e_core_so, t1_ccaa, t1_ca, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('J, Jixy, izxy, Iz->IJ', e_core_so, t1_ccaa, t1_caaa, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('J, Jiax, ia, Ix->IJ', e_core_so, t1_ccea, t1_ce, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('J, Jiax, iyax, Iy->IJ', e_core_so, t1_ccea, t1_caea, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('J, Jiab, ixab, Ix->IJ', e_core_so, t1_ccee, t1_caee, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('J, Ja, xa, Ix->IJ', e_core_so, t1_ce, t1_ae, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('i, Jixy, ix, Iy->IJ', e_core_so, t1_ccaa, t1_ca, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('i, Jixy, izxy, Iz->IJ', e_core_so, t1_ccaa, t1_caaa, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('i, Jiax, ia, Ix->IJ', e_core_so, t1_ccea, t1_ce, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('i, Jiax, iyax, Iy->IJ', e_core_so, t1_ccea, t1_caea, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('i, Jiab, ixab, Ix->IJ', e_core_so, t1_ccee, t1_caee, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('i, ix, Jixy, Iy->IJ', e_core_so, t1_ca, t1_ccaa, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('i, ixyz, Jiyz, Ix->IJ', e_core_so, t1_caaa, t1_ccaa, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('i, ixay, Jiay, Ix->IJ', e_core_so, t1_caea, t1_ccea, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('i, ixab, Jiab, Ix->IJ', e_core_so, t1_caee, t1_ccee, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('i, ia, Jiax, Ix->IJ', e_core_so, t1_ce, t1_ccea, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('a, xa, Ja, Ix->IJ', e_extern_so, t1_ae, t1_ce, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('a, ia, Jiax, Ix->IJ', e_extern_so, t1_ce, t1_ccea, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('a, ixay, Jiay, Ix->IJ', e_extern_so, t1_caea, t1_ccea, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('a, ixab, Jiab, Ix->IJ', e_extern_so, t1_caee, t1_ccee, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('xy, iz, Jxiy, Iz->IJ', rdm_ca_so, t1_ca, v_caca_so, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('xy, Jixz, iy, Iz->IJ', h_aa_so, t1_ccaa, t1_ca, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('xy, Jixz, iz, Iy->IJ', h_aa_so, t1_ccaa, t1_ca, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('xy, Jixz, iwyz, Iw->IJ', h_aa_so, t1_ccaa, t1_caaa, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xy, Jiax, ia, Iy->IJ', h_aa_so, t1_ccea, t1_ce, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('xy, Jiax, izay, Iz->IJ', h_aa_so, t1_ccea, t1_caea, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xy, xa, Ja, Iy->IJ', h_aa_so, t1_ae, t1_ce, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xy, ixzw, Jizw, Iy->IJ', h_aa_so, t1_caaa, t1_ccaa, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('xy, ixaz, Jiaz, Iy->IJ', h_aa_so, t1_caea, t1_ccea, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xy, ixab, Jiab, Iy->IJ', h_aa_so, t1_caee, t1_ccee, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xyzw, Jixy, iz, Iw->IJ', v_aaaa_so, t1_ccaa, t1_ca, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('xyzw, Jixy, iuzw, Iu->IJ', v_aaaa_so, t1_ccaa, t1_caaa, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('ixiy, Jjyz, jz, Ix->IJ', v_caca_so, t1_ccaa, t1_ca, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('ixiy, Jjay, ja, Ix->IJ', v_caca_so, t1_ccea, t1_ce, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('ixiy, jx, Jjyz, Iz->IJ', v_caca_so, t1_ca, t1_ccaa, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('ixiy, ya, Ja, Ix->IJ', v_caca_so, t1_ae, t1_ce, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('ixiy, jyzw, Jjzw, Ix->IJ', v_caca_so, t1_caaa, t1_ccaa, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('ixiy, jyaz, Jjaz, Ix->IJ', v_caca_so, t1_caea, t1_ccea, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('ixiy, jyab, Jjab, Ix->IJ', v_caca_so, t1_caee, t1_ccee, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('ixiy, jzxw, Jjyw, Iz->IJ', v_caca_so, t1_caaa, t1_ccaa, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('ixiy, jzax, Jjay, Iz->IJ', v_caca_so, t1_caea, t1_ccea, trdm_c_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('J, Jxyz, Iyzx->IJ', e_core_so, t2_caaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('Ja, xyaz, Ixyz->IJ', h_ce_so, t1_aaea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('ix, Jiyz, Iyzx->IJ', h_ca_so, t1_ccaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('xa, Jyaz, Ixzy->IJ', h_ae_so, t1_caea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xy, Jxzw, Izwy->IJ', h_aa_so, t2_caaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('xy, Jzxw, Iywz->IJ', h_aa_so, t2_caaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('Jxay, zwya, Izwx->IJ', t1_caea, v_aaae_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('Jxay, izia, Iyzx->IJ', t1_caea, v_cace_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('Jxab, yzab, Iyzx->IJ', t1_caee, v_aaee_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('Jixy, iwxz, Iywz->IJ', t1_ccaa, v_caaa_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('Jixy, ijjz, Ixyz->IJ', t1_ccaa, v_ccca_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('Jiax, izya, Ixzy->IJ', t1_ccea, v_caae_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('Ja, yzxa, Iyzx->IJ', t1_ce, v_aaae_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xyaz, Jwza, Ixyw->IJ', t1_aaea, v_caae_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xyaz, Jiia, Ixyz->IJ', t1_aaea, v_ccce_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xyab, Jzab, Ixyz->IJ', t1_aaee, v_caee_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('ix, Jiyz, Iyzx->IJ', t1_ca, v_ccaa_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('ix, Jyiz, Ixzy->IJ', t1_ca, v_caca_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('ixyz, Jiyw, Ixwz->IJ', t1_caaa, v_ccaa_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('ixyz, Jyiw, Izwx->IJ', t1_caaa, v_caca_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('ixay, Jiza, Ixzy->IJ', t1_caea, v_ccae_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('ixay, izJa, Iyzx->IJ', t1_caea, v_cace_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('ijxy, ijJz, Ixyz->IJ', t1_ccaa, v_ccca_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('xa, Jayz, Iyzx->IJ', t1_ae, v_ceaa_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('xa, Jyza, Ixzy->IJ', t1_ae, v_caae_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('Jx, xyzw, Izwy->IJ', t2_ca, v_aaaa_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('Jxyz, ixiw, Iyzw->IJ', t2_caaa, v_caca_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('Jxyz, yzwu, Iwux->IJ', t2_caaa, v_aaaa_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('Jxyz, iwiy, Izwx->IJ', t2_caaa, v_caca_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('J, Jxay, za, Iyzx->IJ', e_core_so, t1_caea, t1_ae, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('J, Jxay, zway, Izwx->IJ', e_core_so, t1_caea, t1_aaea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.125 * np.einsum('J, Jxab, yzab, Iyzx->IJ', e_core_so, t1_caee, t1_aaee, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('J, Jixy, iz, Ixyz->IJ', e_core_so, t1_ccaa, t1_ca, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('J, Jixy, izxw, Iyzw->IJ', e_core_so, t1_ccaa, t1_caaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('J, Jiax, iyaz, Ixyz->IJ', e_core_so, t1_ccea, t1_caea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('J, Ja, xyaz, Ixyz->IJ', e_core_so, t1_ce, t1_aaea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('i, Jixy, iz, Ixyz->IJ', e_core_so, t1_ccaa, t1_ca, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('i, Jixy, izxw, Iyzw->IJ', e_core_so, t1_ccaa, t1_caaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('i, Jiax, iyaz, Ixyz->IJ', e_core_so, t1_ccea, t1_caea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('i, ixyz, Jiyw, Ixwz->IJ', e_core_so, t1_caaa, t1_ccaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('i, ixay, Jiaz, Ixzy->IJ', e_core_so, t1_caea, t1_ccea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('a, xa, Jyaz, Ixzy->IJ', e_extern_so, t1_ae, t1_caea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('a, xyaz, Ja, Ixyz->IJ', e_extern_so, t1_aaea, t1_ce, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('a, xyaz, Jwaz, Ixyw->IJ', e_extern_so, t1_aaea, t1_caea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('a, xyab, Jzab, Ixyz->IJ', e_extern_so, t1_aaee, t1_caee, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('a, ixay, Jiaz, Ixzy->IJ', e_extern_so, t1_caea, t1_ccea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('xy, izwu, Jxiy, Iwuz->IJ', rdm_ca_so, t1_caaa, v_caca_so, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('xy, Jxaz, wa, Izwy->IJ', h_aa_so, t1_caea, t1_ae, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('xy, Jxaz, wuaz, Iwuy->IJ', h_aa_so, t1_caea, t1_aaea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.125 * np.einsum('xy, Jxab, zwab, Izwy->IJ', h_aa_so, t1_caee, t1_aaee, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xy, Jzax, wa, Iywz->IJ', h_aa_so, t1_caea, t1_ae, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('xy, Jzax, wuay, Iwuz->IJ', h_aa_so, t1_caea, t1_aaea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xy, Jixz, iw, Iyzw->IJ', h_aa_so, t1_ccaa, t1_ca, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('xy, Jixz, iwyu, Izwu->IJ', h_aa_so, t1_ccaa, t1_caaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('xy, Jixz, iwzu, Iywu->IJ', h_aa_so, t1_ccaa, t1_caaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xy, Jiax, izaw, Iyzw->IJ', h_aa_so, t1_ccea, t1_caea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xy, xzaw, Ja, Iyzw->IJ', h_aa_so, t1_aaea, t1_ce, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xy, xzaw, Juaw, Iyzu->IJ', h_aa_so, t1_aaea, t1_caea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('xy, xzab, Jwab, Iyzw->IJ', h_aa_so, t1_aaee, t1_caee, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('xy, ix, Jizw, Izwy->IJ', h_aa_so, t1_ca, t1_ccaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xy, xa, Jzaw, Iywz->IJ', h_aa_so, t1_ae, t1_caea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xy, zwax, Ja, Izwy->IJ', h_aa_so, t1_aaea, t1_ce, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xy, ixzw, Jizu, Iyuw->IJ', h_aa_so, t1_caaa, t1_ccaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xy, ixaz, Jiaw, Iywz->IJ', h_aa_so, t1_caea, t1_ccea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xy, izxw, Jiwu, Izuy->IJ', h_aa_so, t1_caaa, t1_ccaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('xy, izax, Jiaw, Izwy->IJ', h_aa_so, t1_caea, t1_ccea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xyzw, Juax, ya, Izwu->IJ', v_aaaa_so, t1_caea, t1_ae, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.125 * np.einsum('xyzw, Jixy, iu, Izwu->IJ', v_aaaa_so, t1_ccaa, t1_ca, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xyzw, Jixy, iuzv, Iwuv->IJ', v_aaaa_so, t1_ccaa, t1_caaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('xyzw, Jixu, iz, Iwuy->IJ', v_aaaa_so, t1_ccaa, t1_ca, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('xyzw, Jixu, iyuv, Izwv->IJ', v_aaaa_so, t1_ccaa, t1_caaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xyzw, Jixu, iu, Izwy->IJ', v_aaaa_so, t1_ccaa, t1_ca, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('xyzw, Jixu, ivzw, Iuvy->IJ', v_aaaa_so, t1_ccaa, t1_caaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('xyzw, Jixu, ivzu, Iwvy->IJ', v_aaaa_so, t1_ccaa, t1_caaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xyzw, Jiax, iyau, Izwu->IJ', v_aaaa_so, t1_ccea, t1_caea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('xyzw, Jiax, ia, Izwy->IJ', v_aaaa_so, t1_ccea, t1_ce, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('xyzw, Jiax, iuaz, Iwuy->IJ', v_aaaa_so, t1_ccea, t1_caea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.125 * np.einsum('xyzw, xyau, Ja, Izwu->IJ', v_aaaa_so, t1_aaea, t1_ce, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.125 * np.einsum('xyzw, xyau, Jvau, Izwv->IJ', v_aaaa_so, t1_aaea, t1_caea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.0625 * np.einsum('xyzw, xyab, Juab, Izwu->IJ', v_aaaa_so, t1_aaee, t1_caee, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('xyzw, xa, Ja, Izwy->IJ', v_aaaa_so, t1_ae, t1_ce, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.125 * np.einsum('xyzw, ixuv, Jiuv, Izwy->IJ', v_aaaa_so, t1_caaa, t1_ccaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xyzw, ixau, Jiau, Izwy->IJ', v_aaaa_so, t1_caea, t1_ccea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.125 * np.einsum('xyzw, ixab, Jiab, Izwy->IJ', v_aaaa_so, t1_caee, t1_ccee, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('ixiy, Jxaz, wa, Izwy->IJ', v_caca_so, t1_caea, t1_ae, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('ixiy, Jxaz, wuaz, Iwuy->IJ', v_caca_so, t1_caea, t1_aaea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.125 * np.einsum('ixiy, Jxab, zwab, Izwy->IJ', v_caca_so, t1_caee, t1_aaee, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('ixiy, Jzay, wa, Ixwz->IJ', v_caca_so, t1_caea, t1_ae, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('ixiy, Jjyz, jw, Ixzw->IJ', v_caca_so, t1_ccaa, t1_ca, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('ixiy, Jjyz, jwzu, Ixwu->IJ', v_caca_so, t1_ccaa, t1_caaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('ixiy, Jjay, jzaw, Ixzw->IJ', v_caca_so, t1_ccea, t1_caea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('ixiy, jx, Jjzw, Izwy->IJ', v_caca_so, t1_ca, t1_ccaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('ixiy, yzaw, Ja, Ixzw->IJ', v_caca_so, t1_aaea, t1_ce, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('ixiy, yzaw, Juaw, Ixzu->IJ', v_caca_so, t1_aaea, t1_caea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('ixiy, yzab, Jwab, Ixzw->IJ', v_caca_so, t1_aaee, t1_caee, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('ixiy, ya, Jzaw, Ixwz->IJ', v_caca_so, t1_ae, t1_caea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('ixiy, zwax, Ja, Izwy->IJ', v_caca_so, t1_aaea, t1_ce, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('ixiy, zwax, Juay, Izwu->IJ', v_caca_so, t1_aaea, t1_caea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('ixiy, jyzw, Jjzu, Ixuw->IJ', v_caca_so, t1_caaa, t1_ccaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('ixiy, jyaz, Jjaw, Ixwz->IJ', v_caca_so, t1_caea, t1_ccea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += np.einsum('ixiy, jzxw, Jjyu, Izuw->IJ', v_caca_so, t1_caaa, t1_ccaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('ixiy, jzxw, Jjwu, Izuy->IJ', v_caca_so, t1_caaa, t1_ccaa, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('ixiy, jzax, Jjaw, Izwy->IJ', v_caca_so, t1_caea, t1_ccea, trdm_cca_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('Jxay, wuza, Iywuxz->IJ', t1_caea, v_aaae_so, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('Jixy, iuzw, Ixyuzw->IJ', t1_ccaa, v_caaa_so, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('xyaz, Jawu, Izwuxy->IJ', t1_aaea, v_ceaa_so, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('xyaz, Jwua, Ixyuzw->IJ', t1_aaea, v_caae_so, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('ixyz, Jiwu, Ixwuyz->IJ', t1_caaa, v_ccaa_so, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('ixyz, Jwiu, Iyzuxw->IJ', t1_caaa, v_caca_so, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('Jxyz, ywuv, Izuvxw->IJ', t2_caaa, v_aaaa_so, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('Jxyz, wuxv, Iyzvwu->IJ', t2_caaa, v_aaaa_so, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('J, Jxay, zwau, Iyzwxu->IJ', e_core_so, t1_caea, t1_aaea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.125 * np.einsum('J, Jixy, izwu, Ixyzwu->IJ', e_core_so, t1_ccaa, t1_caaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('i, Jixy, izwu, Ixyzwu->IJ', e_core_so, t1_ccaa, t1_caaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.5 * np.einsum('a, xyaz, Jwau, Ixyuzw->IJ', e_extern_so, t1_aaea, t1_caea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('xy, Jxaz, wuav, Izwuyv->IJ', h_aa_so, t1_caea, t1_aaea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xy, Jzax, wuav, Iywuzv->IJ', h_aa_so, t1_caea, t1_aaea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xy, Jixz, iwuv, Iyzwuv->IJ', h_aa_so, t1_ccaa, t1_caaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('xy, xzaw, Juav, Iyzvwu->IJ', h_aa_so, t1_aaea, t1_caea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('xy, zwax, Juav, Izwvyu->IJ', h_aa_so, t1_aaea, t1_caea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.125 * np.einsum('xy, ixzw, Jiuv, Iyuvzw->IJ', h_aa_so, t1_caaa, t1_ccaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xy, izxw, Jiuv, Izuvyw->IJ', h_aa_so, t1_caaa, t1_ccaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('xyzw, Jzau, va, Iwuvxy->IJ', v_aaaa_so, t1_caea, t1_ae, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.125 * np.einsum('xyzw, Jzau, vsaw, Iuvsxy->IJ', v_aaaa_so, t1_caea, t1_aaea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.125 * np.einsum('xyzw, Jzau, vsau, Iwvsxy->IJ', v_aaaa_so, t1_caea, t1_aaea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.0625 * np.einsum('xyzw, Jzab, uvab, Iwuvxy->IJ', v_aaaa_so, t1_caee, t1_aaee, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('xyzw, Juax, yvas, Izwvus->IJ', v_aaaa_so, t1_caea, t1_aaea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xyzw, Juax, va, Izwvyu->IJ', v_aaaa_so, t1_caea, t1_ae, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('xyzw, Juax, vsaz, Iwvsyu->IJ', v_aaaa_so, t1_caea, t1_aaea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.0625 * np.einsum('xyzw, Jixy, iuvs, Izwuvs->IJ', v_aaaa_so, t1_ccaa, t1_caaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.125 * np.einsum('xyzw, Jixu, iyvs, Izwuvs->IJ', v_aaaa_so, t1_ccaa, t1_caaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xyzw, Jixu, iv, Izwuyv->IJ', v_aaaa_so, t1_ccaa, t1_ca, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= np.einsum('xyzw, Jixu, ivzs, Iwuvys->IJ', v_aaaa_so, t1_ccaa, t1_caaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('xyzw, Jixu, ivus, Izwvys->IJ', v_aaaa_so, t1_ccaa, t1_caaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xyzw, Jiax, iuav, Izwuyv->IJ', v_aaaa_so, t1_ccea, t1_caea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.125 * np.einsum('xyzw, xyau, Jvas, Izwsuv->IJ', v_aaaa_so, t1_aaea, t1_caea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xyzw, xuav, Ja, Izwuyv->IJ', v_aaaa_so, t1_aaea, t1_ce, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xyzw, xuav, Jsav, Izwuys->IJ', v_aaaa_so, t1_aaea, t1_caea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.125 * np.einsum('xyzw, xuab, Jvab, Izwuyv->IJ', v_aaaa_so, t1_aaee, t1_caee, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xyzw, xa, Juav, Izwvyu->IJ', v_aaaa_so, t1_ae, t1_caea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.125 * np.einsum('xyzw, iz, Jiuv, Iwuvxy->IJ', v_aaaa_so, t1_ca, t1_ccaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.125 * np.einsum('xyzw, uvaz, Ja, Iwuvxy->IJ', v_aaaa_so, t1_aaea, t1_ce, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xyzw, ixuv, Jius, Izwsyv->IJ', v_aaaa_so, t1_caaa, t1_ccaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xyzw, ixau, Jiav, Izwvyu->IJ', v_aaaa_so, t1_caea, t1_ccea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.0625 * np.einsum('xyzw, iuzw, Jivs, Iuvsxy->IJ', v_aaaa_so, t1_caaa, t1_ccaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xyzw, iuzv, Jivs, Iwusxy->IJ', v_aaaa_so, t1_caaa, t1_ccaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('xyzw, iuaz, Jiav, Iwuvxy->IJ', v_aaaa_so, t1_caea, t1_ccea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('ixiy, Jxaz, wuav, Izwuyv->IJ', v_caca_so, t1_caea, t1_aaea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('ixiy, Jzay, wuav, Ixwuzv->IJ', v_caca_so, t1_caea, t1_aaea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('ixiy, Jjyz, jwuv, Ixzwuv->IJ', v_caca_so, t1_ccaa, t1_caaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.5 * np.einsum('ixiy, yzaw, Juav, Ixzvwu->IJ', v_caca_so, t1_aaea, t1_caea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.25 * np.einsum('ixiy, zwax, Juav, Izwvyu->IJ', v_caca_so, t1_aaea, t1_caea, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.125 * np.einsum('ixiy, jyzw, Jjuv, Ixuvzw->IJ', v_caca_so, t1_caaa, t1_ccaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('ixiy, jzxw, Jjuv, Izuvyw->IJ', v_caca_so, t1_caaa, t1_ccaa, trdm_cccaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.125 * np.einsum('xyzw, Jzau, vsat, Iwuvsxyt->IJ', v_aaaa_so, t1_caea, t1_aaea, trdm_ccccaaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.125 * np.einsum('xyzw, Juax, vsat, Izwvsyut->IJ', v_aaaa_so, t1_caea, t1_aaea, trdm_ccccaaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.125 * np.einsum('xyzw, Jixu, ivst, Izwuvyst->IJ', v_aaaa_so, t1_ccaa, t1_caaa, trdm_ccccaaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.25 * np.einsum('xyzw, xuav, Jsat, Izwutyvs->IJ', v_aaaa_so, t1_aaea, t1_caea, trdm_ccccaaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.125 * np.einsum('xyzw, uvaz, Jsat, Iwuvtxys->IJ', v_aaaa_so, t1_aaea, t1_caea, trdm_ccccaaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] -= 0.0625 * np.einsum('xyzw, ixuv, Jist, Izwstyuv->IJ', v_aaaa_so, t1_caaa, t1_ccaa, trdm_ccccaaa_so, optimize = True)
M[s_casci_a:f_casci_a, s_c:f_c] += 0.125 * np.einsum('xyzw, iuzv, Jist, Iwustxyv->IJ', v_aaaa_so, t1_caaa, t1_ccaa, trdm_ccccaaa_so, optimize = True)
