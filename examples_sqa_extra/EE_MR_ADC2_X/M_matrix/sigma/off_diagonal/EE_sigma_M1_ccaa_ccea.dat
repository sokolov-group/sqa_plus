
    _____ ____    ___ 
   / ___// __ \  /   |SQA Code geneator for quasi-particle systems (Extention).
   \__ \/ / / / / /| |author:  Koushik Chatterjee
  ___/ / /_/ / / ___ |date:  August 31, 2018
 /____/\___\_\/_/  |_|Copyright (C) 2018-2019  Koushik Chatterjee (koushikchatterjee7@gmail.com)
                      
 This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
 without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 See the GNU General Public License for more details.
--------------------------------------------------------------
------------------------ Hamiltonian(1) ----------------------
Perturbation(V) type = All 
Done ...
Commutation: Done ...
Done ...
--------------------------------------------------------------
First Commutator

------------------------ SQA Automation ----------------------

Computing expectation value with respect to virtual:=>
Done ...
--------------------------------------------------------------
Normal ordering with respect to core:=>
Done ...
--------------------------------------------------------------
Computing expectation value with respect to core:=>
Done ...
--------------------------------------------------------------
Contract delta function for non-dummy indices: =>
Done ...
--------------------------------------------------------------
Dummy indices relabelling:=>
Done ...
--------------------------------------------------------------
Reorder tensor indices according to (Core < Active < Virtual): =>
Done ...
--------------------------------------------------------------

----------------------- Final results ------------------------
 (  -1.00000) X(I,J,a,X) h(Y,a) 
 (   1.00000) X(I,J,a,Y) h(X,a) 
 (  -1.00000) X(I,J,a,X) v(i,Y,i,a) 
 (   1.00000) X(I,J,a,Y) v(i,X,i,a) 
 (  -1.00000) X(I,J,a,x) v(X,Y,x,a) 
 (   1.00000) X(I,i,a,X) v(i,Y,J,a) 
 (  -1.00000) X(I,i,a,Y) v(i,X,J,a) 
 (  -1.00000) X(J,i,a,X) v(i,Y,I,a) 
 (   1.00000) X(J,i,a,Y) v(i,X,I,a) 
 (  -1.00000) X(I,J,a,X) e(a) t1(Y,a) 
 (   1.00000) X(I,J,a,Y) e(a) t1(X,a) 
 (   1.00000) X(I,J,a,x) e(a) t1(X,Y,a,x) 
 (   1.00000) X(I,J,a,X) h(Y,x) t1(x,a) 
 (  -1.00000) X(I,J,a,Y) h(X,x) t1(x,a) 
 (   1.00000) X(I,J,a,x) h(X,y) t1(Y,y,a,x) 
 (  -1.00000) X(I,J,a,x) h(Y,y) t1(X,y,a,x) 
 (   1.00000) X(I,J,a,x) h(x,y) t1(X,Y,a,y) 
 (   1.00000) X(I,J,a,X) t1(x,a) v(i,x,i,Y) 
 (  -1.00000) X(I,J,a,Y) t1(x,a) v(i,x,i,X) 
 (   1.00000) X(I,J,a,x) t1(X,Y,a,y) v(i,x,i,y) 
 (  -1.00000) X(I,J,a,x) t1(X,y,a,x) v(i,y,i,Y) 
 (   1.00000) X(I,J,a,x) t1(Y,y,a,x) v(i,y,i,X) 
 (   1.00000) X(I,J,a,x) t1(y,a) v(X,Y,x,y) 
 (  -0.50000) X(I,J,a,x) t1(y,z,a,x) v(X,Y,y,z) 
 (  -1.00000) X(I,J,a,x) h(X,a) cre(Y) des(x) 
 (   1.00000) X(I,J,a,x) h(Y,a) cre(X) des(x) 
 (   1.00000) X(I,J,a,X) v(Y,x,y,a) cre(y) des(x) 
 (  -1.00000) X(I,J,a,Y) v(X,x,y,a) cre(y) des(x) 
 (   1.00000) X(I,J,a,x) v(X,Y,y,a) cre(y) des(x) 
 (   1.00000) X(I,J,a,x) v(X,y,x,a) cre(Y) des(y) 
 (  -1.00000) X(I,J,a,x) v(i,X,i,a) cre(Y) des(x) 
 (  -1.00000) X(I,J,a,x) v(Y,y,x,a) cre(X) des(y) 
 (   1.00000) X(I,J,a,x) v(i,Y,i,a) cre(X) des(x) 
 (  -1.00000) X(I,i,a,X) v(i,x,J,a) cre(Y) des(x) 
 (   1.00000) X(I,i,a,Y) v(i,x,J,a) cre(X) des(x) 
 (   1.00000) X(I,i,a,x) v(i,X,J,a) cre(Y) des(x) 
 (  -1.00000) X(I,i,a,x) v(i,Y,J,a) cre(X) des(x) 
 (   1.00000) X(J,i,a,X) v(i,x,I,a) cre(Y) des(x) 
 (  -1.00000) X(J,i,a,Y) v(i,x,I,a) cre(X) des(x) 
 (  -1.00000) X(J,i,a,x) v(i,X,I,a) cre(Y) des(x) 
 (   1.00000) X(J,i,a,x) v(i,Y,I,a) cre(X) des(x) 
 (  -1.00000) X(I,J,a,X) e(a) t1(Y,x,a,y) cre(y) des(x) 
 (   1.00000) X(I,J,a,Y) e(a) t1(X,x,a,y) cre(y) des(x) 
 (  -1.00000) X(I,J,a,x) e(a) t1(X,Y,a,y) cre(y) des(x) 
 (  -1.00000) X(I,J,a,x) e(a) t1(X,a) cre(Y) des(x) 
 (  -1.00000) X(I,J,a,x) e(a) t1(X,y,a,x) cre(Y) des(y) 
 (   1.00000) X(I,J,a,x) e(a) t1(Y,a) cre(X) des(x) 
 (   1.00000) X(I,J,a,x) e(a) t1(Y,y,a,x) cre(X) des(y) 
 (   1.00000) X(I,J,a,X) h(Y,x) t1(x,y,a,z) cre(z) des(y) 
 (   1.00000) X(I,J,a,X) h(x,y) t1(Y,x,a,z) cre(z) des(y) 
 (  -1.00000) X(I,J,a,X) h(x,y) t1(Y,z,a,x) cre(y) des(z) 
 (  -1.00000) X(I,J,a,Y) h(X,x) t1(x,y,a,z) cre(z) des(y) 
 (  -1.00000) X(I,J,a,Y) h(x,y) t1(X,x,a,z) cre(z) des(y) 
 (   1.00000) X(I,J,a,Y) h(x,y) t1(X,z,a,x) cre(y) des(z) 
 (  -1.00000) X(I,J,a,x) h(X,y) t1(Y,y,a,z) cre(z) des(x) 
 (   1.00000) X(I,J,a,x) h(X,y) t1(y,a) cre(Y) des(x) 
 (   1.00000) X(I,J,a,x) h(X,y) t1(y,z,a,x) cre(Y) des(z) 
 (   1.00000) X(I,J,a,x) h(Y,y) t1(X,y,a,z) cre(z) des(x) 
 (  -1.00000) X(I,J,a,x) h(Y,y) t1(y,a) cre(X) des(x) 
 (  -1.00000) X(I,J,a,x) h(Y,y) t1(y,z,a,x) cre(X) des(z) 
 (  -1.00000) X(I,J,a,x) h(x,y) t1(X,z,a,y) cre(Y) des(z) 
 (   1.00000) X(I,J,a,x) h(x,y) t1(Y,z,a,y) cre(X) des(z) 
 (  -1.00000) X(I,J,a,x) h(y,z) t1(X,Y,a,y) cre(z) des(x) 
 (   1.00000) X(I,J,a,x) h(y,z) t1(X,y,a,x) cre(Y) des(z) 
 (  -1.00000) X(I,J,a,x) h(y,z) t1(Y,y,a,x) cre(X) des(z) 
 (   1.00000) X(I,J,a,X) t1(Y,x,a,y) v(i,x,i,z) cre(y) des(z) 
 (  -1.00000) X(I,J,a,X) t1(Y,x,a,y) v(i,z,i,y) cre(z) des(x) 
 (   1.00000) X(I,J,a,X) t1(x,a) v(Y,y,x,z) cre(z) des(y) 
 (   0.50000) X(I,J,a,X) t1(x,y,a,z) v(Y,w,x,y) cre(z) des(w) 
 (   1.00000) X(I,J,a,X) t1(x,y,a,z) v(i,x,i,Y) cre(z) des(y) 
 (  -1.00000) X(I,J,a,Y) t1(X,x,a,y) v(i,x,i,z) cre(y) des(z) 
 (   1.00000) X(I,J,a,Y) t1(X,x,a,y) v(i,z,i,y) cre(z) des(x) 
 (  -1.00000) X(I,J,a,Y) t1(x,a) v(X,y,x,z) cre(z) des(y) 
 (  -0.50000) X(I,J,a,Y) t1(x,y,a,z) v(X,w,x,y) cre(z) des(w) 
 (  -1.00000) X(I,J,a,Y) t1(x,y,a,z) v(i,x,i,X) cre(z) des(y) 
 (   1.00000) X(I,J,a,x) t1(X,Y,a,y) v(y,z,x,w) cre(w) des(z) 
 (  -1.00000) X(I,J,a,x) t1(X,Y,a,y) v(i,z,i,y) cre(z) des(x) 
 (  -1.00000) X(I,J,a,x) t1(X,y,a,x) v(Y,z,y,w) cre(w) des(z) 
 (   1.00000) X(I,J,a,x) t1(X,y,a,x) v(i,y,i,z) cre(Y) des(z) 
 (   1.00000) X(I,J,a,x) t1(X,y,a,z) v(Y,z,x,w) cre(w) des(y) 
 (  -1.00000) X(I,J,a,x) t1(X,y,a,z) v(Y,w,x,y) cre(z) des(w) 
 (  -1.00000) X(I,J,a,x) t1(X,y,a,z) v(i,x,i,z) cre(Y) des(y) 
 (   1.00000) X(I,J,a,x) t1(X,y,a,z) v(i,y,i,Y) cre(z) des(x) 
 (   1.00000) X(I,J,a,x) t1(Y,y,a,x) v(X,z,y,w) cre(w) des(z) 
 (  -1.00000) X(I,J,a,x) t1(Y,y,a,x) v(i,y,i,z) cre(X) des(z) 
 (  -1.00000) X(I,J,a,x) t1(Y,y,a,z) v(X,z,x,w) cre(w) des(y) 
 (   1.00000) X(I,J,a,x) t1(Y,y,a,z) v(X,w,x,y) cre(z) des(w) 
 (   1.00000) X(I,J,a,x) t1(Y,y,a,z) v(i,x,i,z) cre(X) des(y) 
 (  -1.00000) X(I,J,a,x) t1(Y,y,a,z) v(i,y,i,X) cre(z) des(x) 
 (   1.00000) X(I,J,a,x) t1(y,a) v(X,Y,y,z) cre(z) des(x) 
 (  -1.00000) X(I,J,a,x) t1(y,a) v(X,z,x,y) cre(Y) des(z) 
 (   1.00000) X(I,J,a,x) t1(y,a) v(Y,z,x,y) cre(X) des(z) 
 (   1.00000) X(I,J,a,x) t1(y,a) v(i,y,i,X) cre(Y) des(x) 
 (  -1.00000) X(I,J,a,x) t1(y,a) v(i,y,i,Y) cre(X) des(x) 
 (   1.00000) X(I,J,a,x) t1(y,z,a,x) v(X,Y,y,w) cre(w) des(z) 
 (   0.50000) X(I,J,a,x) t1(y,z,a,x) v(X,w,y,z) cre(Y) des(w) 
 (  -0.50000) X(I,J,a,x) t1(y,z,a,x) v(Y,w,y,z) cre(X) des(w) 
 (   1.00000) X(I,J,a,x) t1(y,z,a,x) v(i,y,i,X) cre(Y) des(z) 
 (  -1.00000) X(I,J,a,x) t1(y,z,a,x) v(i,y,i,Y) cre(X) des(z) 
 (   1.00000) X(I,J,a,x) t1(y,z,a,w) v(X,Y,x,y) cre(w) des(z) 
 (   0.50000) X(I,J,a,x) t1(y,z,a,w) v(X,Y,y,z) cre(w) des(x) 
 (  -1.00000) X(I,J,a,x) v(X,y,z,a) cre(Y) cre(z) des(x) des(y) 
 (   1.00000) X(I,J,a,x) v(Y,y,z,a) cre(X) cre(z) des(x) des(y) 
 (  -1.00000) X(I,i,a,x) v(i,y,J,a) cre(X) cre(Y) des(x) des(y) 
 (   1.00000) X(J,i,a,x) v(i,y,I,a) cre(X) cre(Y) des(x) des(y) 
 (   1.00000) X(I,J,a,x) e(a) t1(X,y,a,z) cre(Y) cre(z) des(x) des(y) 
 (  -1.00000) X(I,J,a,x) e(a) t1(Y,y,a,z) cre(X) cre(z) des(x) des(y) 
 (  -1.00000) X(I,J,a,x) h(X,y) t1(y,z,a,w) cre(Y) cre(w) des(x) des(z) 
 (   1.00000) X(I,J,a,x) h(Y,y) t1(y,z,a,w) cre(X) cre(w) des(x) des(z) 
 (  -1.00000) X(I,J,a,x) h(y,z) t1(X,y,a,w) cre(Y) cre(w) des(x) des(z) 
 (   1.00000) X(I,J,a,x) h(y,z) t1(X,w,a,y) cre(Y) cre(z) des(x) des(w) 
 (   1.00000) X(I,J,a,x) h(y,z) t1(Y,y,a,w) cre(X) cre(w) des(x) des(z) 
 (  -1.00000) X(I,J,a,x) h(y,z) t1(Y,w,a,y) cre(X) cre(z) des(x) des(w) 
 (   0.50000) X(I,J,a,X) t1(Y,x,a,y) v(y,z,w,u) cre(w) cre(u) des(x) des(z) 
 (  -0.50000) X(I,J,a,X) t1(Y,x,a,y) v(z,w,x,u) cre(y) cre(u) des(z) des(w) 
 (  -0.25000) X(I,J,a,X) t1(x,y,a,z) v(Y,z,w,u) cre(w) cre(u) des(x) des(y) 
 (  -1.00000) X(I,J,a,X) t1(x,y,a,z) v(Y,w,x,u) cre(z) cre(u) des(y) des(w) 
 (  -0.50000) X(I,J,a,Y) t1(X,x,a,y) v(y,z,w,u) cre(w) cre(u) des(x) des(z) 
 (   0.50000) X(I,J,a,Y) t1(X,x,a,y) v(z,w,x,u) cre(y) cre(u) des(z) des(w) 
 (   0.25000) X(I,J,a,Y) t1(x,y,a,z) v(X,z,w,u) cre(w) cre(u) des(x) des(y) 
 (   1.00000) X(I,J,a,Y) t1(x,y,a,z) v(X,w,x,u) cre(z) cre(u) des(y) des(w) 
 (   0.50000) X(I,J,a,x) t1(X,Y,a,y) v(y,z,w,u) cre(w) cre(u) des(x) des(z) 
 (  -0.50000) X(I,J,a,x) t1(X,y,a,x) v(z,w,y,u) cre(Y) cre(u) des(z) des(w) 
 (   0.50000) X(I,J,a,x) t1(X,y,a,z) v(Y,z,w,u) cre(w) cre(u) des(x) des(y) 
 (  -1.00000) X(I,J,a,x) t1(X,y,a,z) v(Y,w,y,u) cre(z) cre(u) des(x) des(w) 
 (  -1.00000) X(I,J,a,x) t1(X,y,a,z) v(i,y,i,w) cre(Y) cre(z) des(x) des(w) 
 (   1.00000) X(I,J,a,x) t1(X,y,a,z) v(z,w,x,u) cre(Y) cre(u) des(y) des(w) 
 (  -0.50000) X(I,J,a,x) t1(X,y,a,z) v(w,u,x,y) cre(Y) cre(z) des(w) des(u) 
 (   1.00000) X(I,J,a,x) t1(X,y,a,z) v(i,w,i,z) cre(Y) cre(w) des(x) des(y) 
 (   0.50000) X(I,J,a,x) t1(Y,y,a,x) v(z,w,y,u) cre(X) cre(u) des(z) des(w) 
 (  -0.50000) X(I,J,a,x) t1(Y,y,a,z) v(X,z,w,u) cre(w) cre(u) des(x) des(y) 
 (   1.00000) X(I,J,a,x) t1(Y,y,a,z) v(X,w,y,u) cre(z) cre(u) des(x) des(w) 
 (   1.00000) X(I,J,a,x) t1(Y,y,a,z) v(i,y,i,w) cre(X) cre(z) des(x) des(w) 
 (  -1.00000) X(I,J,a,x) t1(Y,y,a,z) v(z,w,x,u) cre(X) cre(u) des(y) des(w) 
 (   0.50000) X(I,J,a,x) t1(Y,y,a,z) v(w,u,x,y) cre(X) cre(z) des(w) des(u) 
 (  -1.00000) X(I,J,a,x) t1(Y,y,a,z) v(i,w,i,z) cre(X) cre(w) des(x) des(y) 
 (  -1.00000) X(I,J,a,x) t1(y,a) v(X,z,y,w) cre(Y) cre(w) des(x) des(z) 
 (   1.00000) X(I,J,a,x) t1(y,a) v(Y,z,y,w) cre(X) cre(w) des(x) des(z) 
 (  -1.00000) X(I,J,a,x) t1(y,z,a,x) v(X,w,y,u) cre(Y) cre(u) des(z) des(w) 
 (   1.00000) X(I,J,a,x) t1(y,z,a,x) v(Y,w,y,u) cre(X) cre(u) des(z) des(w) 
 (   1.00000) X(I,J,a,x) t1(y,z,a,w) v(X,Y,y,u) cre(w) cre(u) des(x) des(z) 
 (  -0.50000) X(I,J,a,x) t1(y,z,a,w) v(X,w,x,u) cre(Y) cre(u) des(y) des(z) 
 (  -1.00000) X(I,J,a,x) t1(y,z,a,w) v(X,u,x,y) cre(Y) cre(w) des(z) des(u) 
 (  -0.50000) X(I,J,a,x) t1(y,z,a,w) v(X,u,y,z) cre(Y) cre(w) des(x) des(u) 
 (   0.50000) X(I,J,a,x) t1(y,z,a,w) v(Y,w,x,u) cre(X) cre(u) des(y) des(z) 
 (   1.00000) X(I,J,a,x) t1(y,z,a,w) v(Y,u,x,y) cre(X) cre(w) des(z) des(u) 
 (   0.50000) X(I,J,a,x) t1(y,z,a,w) v(Y,u,y,z) cre(X) cre(w) des(x) des(u) 
 (  -1.00000) X(I,J,a,x) t1(y,z,a,w) v(i,y,i,X) cre(Y) cre(w) des(x) des(z) 
 (   1.00000) X(I,J,a,x) t1(y,z,a,w) v(i,y,i,Y) cre(X) cre(w) des(x) des(z) 
 (   0.50000) X(I,J,a,x) t1(X,y,a,z) v(z,w,u,v) cre(Y) cre(u) cre(v) des(x) des(y) des(w) 
 (  -0.50000) X(I,J,a,x) t1(X,y,a,z) v(w,u,y,v) cre(Y) cre(z) cre(v) des(x) des(w) des(u) 
 (  -0.50000) X(I,J,a,x) t1(Y,y,a,z) v(z,w,u,v) cre(X) cre(u) cre(v) des(x) des(y) des(w) 
 (   0.50000) X(I,J,a,x) t1(Y,y,a,z) v(w,u,y,v) cre(X) cre(z) cre(v) des(x) des(w) des(u) 
 (  -0.25000) X(I,J,a,x) t1(y,z,a,w) v(X,w,u,v) cre(Y) cre(u) cre(v) des(x) des(y) des(z) 
 (  -1.00000) X(I,J,a,x) t1(y,z,a,w) v(X,u,y,v) cre(Y) cre(w) cre(v) des(x) des(z) des(u) 
 (   0.25000) X(I,J,a,x) t1(y,z,a,w) v(Y,w,u,v) cre(X) cre(u) cre(v) des(x) des(y) des(z) 
 (   1.00000) X(I,J,a,x) t1(y,z,a,w) v(Y,u,y,v) cre(X) cre(w) cre(v) des(x) des(z) des(u) 

Total terms : 157
SQA automation time :  10.328 seconds

----------------------- SQA EINSUM ---------------------------
  ___  _  _  _  __  _ _  _   _ 
 | __|| || \| |/ _|| | || \_/ | Einsum generator: Transform into einsum.
 | _| | || \  |\_ \| U || \_/ | author:  Koushik Chatterjee
 |___||_||_|\_||__/|___||_| |_| date:  August 31, 2018
                                VERSION : 1
 Copywight (C) 2018-2019  Koushik Chatterjee (koushikchatterjee7@gmail.com)

 For Help :: help = True
--------------------------------------------------------------
temp =- np.einsum('IJaX, Ya->IJXY', X, h_ae_so, optimize = True)
temp += np.einsum('IJaY, Xa->IJXY', X, h_ae_so, optimize = True)
temp -= np.einsum('IJaX, iYia->IJXY', X, v_cace_so, optimize = True)
temp += np.einsum('IJaY, iXia->IJXY', X, v_cace_so, optimize = True)
temp -= np.einsum('IJax, XYxa->IJXY', X, v_aaae_so, optimize = True)
temp += np.einsum('IiaX, iYJa->IJXY', X, v_cace_so, optimize = True)
temp -= np.einsum('IiaY, iXJa->IJXY', X, v_cace_so, optimize = True)
temp -= np.einsum('JiaX, iYIa->IJXY', X, v_cace_so, optimize = True)
temp += np.einsum('JiaY, iXIa->IJXY', X, v_cace_so, optimize = True)
temp -= np.einsum('IJaX, a, Ya->IJXY', X, e_extern_so, t1_ae, optimize = True)
temp += np.einsum('IJaY, a, Xa->IJXY', X, e_extern_so, t1_ae, optimize = True)
temp += np.einsum('IJax, a, XYax->IJXY', X, e_extern_so, t1_aaea, optimize = True)
temp += np.einsum('IJaX, Yx, xa->IJXY', X, h_aa_so, t1_ae, optimize = True)
temp -= np.einsum('IJaY, Xx, xa->IJXY', X, h_aa_so, t1_ae, optimize = True)
temp += np.einsum('IJax, Xy, Yyax->IJXY', X, h_aa_so, t1_aaea, optimize = True)
temp -= np.einsum('IJax, Yy, Xyax->IJXY', X, h_aa_so, t1_aaea, optimize = True)
temp += np.einsum('IJax, xy, XYay->IJXY', X, h_aa_so, t1_aaea, optimize = True)
temp += np.einsum('IJaX, xa, ixiY->IJXY', X, t1_ae, v_caca_so, optimize = True)
temp -= np.einsum('IJaY, xa, ixiX->IJXY', X, t1_ae, v_caca_so, optimize = True)
temp += np.einsum('IJax, XYay, ixiy->IJXY', X, t1_aaea, v_caca_so, optimize = True)
temp -= np.einsum('IJax, Xyax, iyiY->IJXY', X, t1_aaea, v_caca_so, optimize = True)
temp += np.einsum('IJax, Yyax, iyiX->IJXY', X, t1_aaea, v_caca_so, optimize = True)
temp += np.einsum('IJax, ya, XYxy->IJXY', X, t1_ae, v_aaaa_so, optimize = True)
temp -= 0.5 * np.einsum('IJax, yzax, XYyz->IJXY', X, t1_aaea, v_aaaa_so, optimize = True)
temp -= np.einsum('IJax, Xa, Yx->IJXY', X, h_ae_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, Ya, Xx->IJXY', X, h_ae_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJaX, Yxya, yx->IJXY', X, v_aaae_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJaY, Xxya, yx->IJXY', X, v_aaae_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, XYya, yx->IJXY', X, v_aaae_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, Xyxa, Yy->IJXY', X, v_aaae_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, iXia, Yx->IJXY', X, v_cace_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, Yyxa, Xy->IJXY', X, v_aaae_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, iYia, Xx->IJXY', X, v_cace_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IiaX, ixJa, Yx->IJXY', X, v_cace_so, rdm_ca_so, optimize = True)
temp += np.einsum('IiaY, ixJa, Xx->IJXY', X, v_cace_so, rdm_ca_so, optimize = True)
temp += np.einsum('Iiax, iXJa, Yx->IJXY', X, v_cace_so, rdm_ca_so, optimize = True)
temp -= np.einsum('Iiax, iYJa, Xx->IJXY', X, v_cace_so, rdm_ca_so, optimize = True)
temp += np.einsum('JiaX, ixIa, Yx->IJXY', X, v_cace_so, rdm_ca_so, optimize = True)
temp -= np.einsum('JiaY, ixIa, Xx->IJXY', X, v_cace_so, rdm_ca_so, optimize = True)
temp -= np.einsum('Jiax, iXIa, Yx->IJXY', X, v_cace_so, rdm_ca_so, optimize = True)
temp += np.einsum('Jiax, iYIa, Xx->IJXY', X, v_cace_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJaX, a, Yxay, yx->IJXY', X, e_extern_so, t1_aaea, rdm_ca_so, optimize = True)
temp += np.einsum('IJaY, a, Xxay, yx->IJXY', X, e_extern_so, t1_aaea, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, a, XYay, yx->IJXY', X, e_extern_so, t1_aaea, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, a, Xa, Yx->IJXY', X, e_extern_so, t1_ae, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, a, Xyax, Yy->IJXY', X, e_extern_so, t1_aaea, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, a, Ya, Xx->IJXY', X, e_extern_so, t1_ae, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, a, Yyax, Xy->IJXY', X, e_extern_so, t1_aaea, rdm_ca_so, optimize = True)
temp += np.einsum('IJaX, Yx, xyaz, zy->IJXY', X, h_aa_so, t1_aaea, rdm_ca_so, optimize = True)
temp += np.einsum('IJaX, xy, Yxaz, zy->IJXY', X, h_aa_so, t1_aaea, rdm_ca_so, optimize = True)
temp -= np.einsum('IJaX, xy, Yzax, yz->IJXY', X, h_aa_so, t1_aaea, rdm_ca_so, optimize = True)
temp -= np.einsum('IJaY, Xx, xyaz, zy->IJXY', X, h_aa_so, t1_aaea, rdm_ca_so, optimize = True)
temp -= np.einsum('IJaY, xy, Xxaz, zy->IJXY', X, h_aa_so, t1_aaea, rdm_ca_so, optimize = True)
temp += np.einsum('IJaY, xy, Xzax, yz->IJXY', X, h_aa_so, t1_aaea, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, Xy, Yyaz, zx->IJXY', X, h_aa_so, t1_aaea, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, Xy, ya, Yx->IJXY', X, h_aa_so, t1_ae, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, Xy, yzax, Yz->IJXY', X, h_aa_so, t1_aaea, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, Yy, Xyaz, zx->IJXY', X, h_aa_so, t1_aaea, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, Yy, ya, Xx->IJXY', X, h_aa_so, t1_ae, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, Yy, yzax, Xz->IJXY', X, h_aa_so, t1_aaea, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, xy, Xzay, Yz->IJXY', X, h_aa_so, t1_aaea, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, xy, Yzay, Xz->IJXY', X, h_aa_so, t1_aaea, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, yz, XYay, zx->IJXY', X, h_aa_so, t1_aaea, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, yz, Xyax, Yz->IJXY', X, h_aa_so, t1_aaea, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, yz, Yyax, Xz->IJXY', X, h_aa_so, t1_aaea, rdm_ca_so, optimize = True)
temp += np.einsum('IJaX, Yxay, ixiz, yz->IJXY', X, t1_aaea, v_caca_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJaX, Yxay, iziy, zx->IJXY', X, t1_aaea, v_caca_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJaX, xa, Yyxz, zy->IJXY', X, t1_ae, v_aaaa_so, rdm_ca_so, optimize = True)
temp += 0.5 * np.einsum('IJaX, xyaz, Ywxy, zw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJaX, xyaz, ixiY, zy->IJXY', X, t1_aaea, v_caca_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJaY, Xxay, ixiz, yz->IJXY', X, t1_aaea, v_caca_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJaY, Xxay, iziy, zx->IJXY', X, t1_aaea, v_caca_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJaY, xa, Xyxz, zy->IJXY', X, t1_ae, v_aaaa_so, rdm_ca_so, optimize = True)
temp -= 0.5 * np.einsum('IJaY, xyaz, Xwxy, zw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJaY, xyaz, ixiX, zy->IJXY', X, t1_aaea, v_caca_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, XYay, yzxw, wz->IJXY', X, t1_aaea, v_aaaa_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, XYay, iziy, zx->IJXY', X, t1_aaea, v_caca_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, Xyax, Yzyw, wz->IJXY', X, t1_aaea, v_aaaa_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, Xyax, iyiz, Yz->IJXY', X, t1_aaea, v_caca_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, Xyaz, Yzxw, wy->IJXY', X, t1_aaea, v_aaaa_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, Xyaz, Ywxy, zw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, Xyaz, ixiz, Yy->IJXY', X, t1_aaea, v_caca_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, Xyaz, iyiY, zx->IJXY', X, t1_aaea, v_caca_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, Yyax, Xzyw, wz->IJXY', X, t1_aaea, v_aaaa_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, Yyax, iyiz, Xz->IJXY', X, t1_aaea, v_caca_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, Yyaz, Xzxw, wy->IJXY', X, t1_aaea, v_aaaa_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, Yyaz, Xwxy, zw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, Yyaz, ixiz, Xy->IJXY', X, t1_aaea, v_caca_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, Yyaz, iyiX, zx->IJXY', X, t1_aaea, v_caca_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, ya, XYyz, zx->IJXY', X, t1_ae, v_aaaa_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, ya, Xzxy, Yz->IJXY', X, t1_ae, v_aaaa_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, ya, Yzxy, Xz->IJXY', X, t1_ae, v_aaaa_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, ya, iyiX, Yx->IJXY', X, t1_ae, v_caca_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, ya, iyiY, Xx->IJXY', X, t1_ae, v_caca_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, yzax, XYyw, wz->IJXY', X, t1_aaea, v_aaaa_so, rdm_ca_so, optimize = True)
temp += 0.5 * np.einsum('IJax, yzax, Xwyz, Yw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ca_so, optimize = True)
temp -= 0.5 * np.einsum('IJax, yzax, Ywyz, Xw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, yzax, iyiX, Yz->IJXY', X, t1_aaea, v_caca_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, yzax, iyiY, Xz->IJXY', X, t1_aaea, v_caca_so, rdm_ca_so, optimize = True)
temp += np.einsum('IJax, yzaw, XYxy, wz->IJXY', X, t1_aaea, v_aaaa_so, rdm_ca_so, optimize = True)
temp += 0.5 * np.einsum('IJax, yzaw, XYyz, wx->IJXY', X, t1_aaea, v_aaaa_so, rdm_ca_so, optimize = True)
temp -= np.einsum('IJax, Xyza, Yzxy->IJXY', X, v_aaae_so, rdm_ccaa_so, optimize = True)
temp += np.einsum('IJax, Yyza, Xzxy->IJXY', X, v_aaae_so, rdm_ccaa_so, optimize = True)
temp -= np.einsum('Iiax, iyJa, XYxy->IJXY', X, v_cace_so, rdm_ccaa_so, optimize = True)
temp += np.einsum('Jiax, iyIa, XYxy->IJXY', X, v_cace_so, rdm_ccaa_so, optimize = True)
temp += np.einsum('IJax, a, Xyaz, Yzxy->IJXY', X, e_extern_so, t1_aaea, rdm_ccaa_so, optimize = True)
temp -= np.einsum('IJax, a, Yyaz, Xzxy->IJXY', X, e_extern_so, t1_aaea, rdm_ccaa_so, optimize = True)
temp -= np.einsum('IJax, Xy, yzaw, Ywxz->IJXY', X, h_aa_so, t1_aaea, rdm_ccaa_so, optimize = True)
temp += np.einsum('IJax, Yy, yzaw, Xwxz->IJXY', X, h_aa_so, t1_aaea, rdm_ccaa_so, optimize = True)
temp -= np.einsum('IJax, yz, Xyaw, Ywxz->IJXY', X, h_aa_so, t1_aaea, rdm_ccaa_so, optimize = True)
temp += np.einsum('IJax, yz, Xway, Yzxw->IJXY', X, h_aa_so, t1_aaea, rdm_ccaa_so, optimize = True)
temp += np.einsum('IJax, yz, Yyaw, Xwxz->IJXY', X, h_aa_so, t1_aaea, rdm_ccaa_so, optimize = True)
temp -= np.einsum('IJax, yz, Yway, Xzxw->IJXY', X, h_aa_so, t1_aaea, rdm_ccaa_so, optimize = True)
temp += 0.5 * np.einsum('IJaX, Yxay, yzwu, wuxz->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= 0.5 * np.einsum('IJaX, Yxay, zwxu, yuzw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= 0.25 * np.einsum('IJaX, xyaz, Yzwu, wuxy->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= np.einsum('IJaX, xyaz, Ywxu, zuyw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= 0.5 * np.einsum('IJaY, Xxay, yzwu, wuxz->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp += 0.5 * np.einsum('IJaY, Xxay, zwxu, yuzw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp += 0.25 * np.einsum('IJaY, xyaz, Xzwu, wuxy->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp += np.einsum('IJaY, xyaz, Xwxu, zuyw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp += 0.5 * np.einsum('IJax, XYay, yzwu, wuxz->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= 0.5 * np.einsum('IJax, Xyax, zwyu, Yuzw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp += 0.5 * np.einsum('IJax, Xyaz, Yzwu, wuxy->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= np.einsum('IJax, Xyaz, Ywyu, zuxw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= np.einsum('IJax, Xyaz, iyiw, Yzxw->IJXY', X, t1_aaea, v_caca_so, rdm_ccaa_so, optimize = True)
temp += np.einsum('IJax, Xyaz, zwxu, Yuyw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= 0.5 * np.einsum('IJax, Xyaz, wuxy, Yzwu->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp += np.einsum('IJax, Xyaz, iwiz, Ywxy->IJXY', X, t1_aaea, v_caca_so, rdm_ccaa_so, optimize = True)
temp += 0.5 * np.einsum('IJax, Yyax, zwyu, Xuzw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= 0.5 * np.einsum('IJax, Yyaz, Xzwu, wuxy->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp += np.einsum('IJax, Yyaz, Xwyu, zuxw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp += np.einsum('IJax, Yyaz, iyiw, Xzxw->IJXY', X, t1_aaea, v_caca_so, rdm_ccaa_so, optimize = True)
temp -= np.einsum('IJax, Yyaz, zwxu, Xuyw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp += 0.5 * np.einsum('IJax, Yyaz, wuxy, Xzwu->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= np.einsum('IJax, Yyaz, iwiz, Xwxy->IJXY', X, t1_aaea, v_caca_so, rdm_ccaa_so, optimize = True)
temp -= np.einsum('IJax, ya, Xzyw, Ywxz->IJXY', X, t1_ae, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp += np.einsum('IJax, ya, Yzyw, Xwxz->IJXY', X, t1_ae, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= np.einsum('IJax, yzax, Xwyu, Yuzw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp += np.einsum('IJax, yzax, Ywyu, Xuzw->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp += np.einsum('IJax, yzaw, XYyu, wuxz->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= 0.5 * np.einsum('IJax, yzaw, Xwxu, Yuyz->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= np.einsum('IJax, yzaw, Xuxy, Ywzu->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= 0.5 * np.einsum('IJax, yzaw, Xuyz, Ywxu->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp += 0.5 * np.einsum('IJax, yzaw, Ywxu, Xuyz->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp += np.einsum('IJax, yzaw, Yuxy, Xwzu->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp += 0.5 * np.einsum('IJax, yzaw, Yuyz, Xwxu->IJXY', X, t1_aaea, v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= np.einsum('IJax, yzaw, iyiX, Ywxz->IJXY', X, t1_aaea, v_caca_so, rdm_ccaa_so, optimize = True)
temp += np.einsum('IJax, yzaw, iyiY, Xwxz->IJXY', X, t1_aaea, v_caca_so, rdm_ccaa_so, optimize = True)
temp += 0.5 * np.einsum('IJax, Xyaz, zwuv, Yuvxyw->IJXY', X, t1_aaea, v_aaaa_so, rdm_cccaaa_so, optimize = True)
temp -= 0.5 * np.einsum('IJax, Xyaz, wuyv, Yzvxwu->IJXY', X, t1_aaea, v_aaaa_so, rdm_cccaaa_so, optimize = True)
temp -= 0.5 * np.einsum('IJax, Yyaz, zwuv, Xuvxyw->IJXY', X, t1_aaea, v_aaaa_so, rdm_cccaaa_so, optimize = True)
temp += 0.5 * np.einsum('IJax, Yyaz, wuyv, Xzvxwu->IJXY', X, t1_aaea, v_aaaa_so, rdm_cccaaa_so, optimize = True)
temp -= 0.25 * np.einsum('IJax, yzaw, Xwuv, Yuvxyz->IJXY', X, t1_aaea, v_aaaa_so, rdm_cccaaa_so, optimize = True)
temp -= np.einsum('IJax, yzaw, Xuyv, Ywvxzu->IJXY', X, t1_aaea, v_aaaa_so, rdm_cccaaa_so, optimize = True)
temp += 0.25 * np.einsum('IJax, yzaw, Ywuv, Xuvxyz->IJXY', X, t1_aaea, v_aaaa_so, rdm_cccaaa_so, optimize = True)
temp += np.einsum('IJax, yzaw, Yuyv, Xwvxzu->IJXY', X, t1_aaea, v_aaaa_so, rdm_cccaaa_so, optimize = True)
