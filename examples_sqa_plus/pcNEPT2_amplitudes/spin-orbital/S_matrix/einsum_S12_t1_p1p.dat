S12  = einsum('XY,ZW->XWZY', np.identity(ncas_so), rdm_ca_so, optimize = einsum_type)
S12 -= einsum('XZ,YW->XWZY', np.identity(ncas_so), rdm_ca_so, optimize = einsum_type)
S12 -= einsum('YZWX->XWZY', rdm_ccaa_so, optimize = einsum_type).copy()
