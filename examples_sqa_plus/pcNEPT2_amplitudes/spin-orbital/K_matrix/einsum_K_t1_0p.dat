K_caca  = einsum('YZ,XW->XYWZ', h_aa_so, rdm_ca_so, optimize = einsum_type)
K_caca -= einsum('Wx,YZ,Xx->XYWZ', h_aa_so, np.identity(ncas_so), rdm_ca_so, optimize = einsum_type)
K_caca += einsum('Wx,XZYx->XYWZ', h_aa_so, rdm_ccaa_so, optimize = einsum_type)
K_caca += einsum('Zx,XxWY->XYWZ', h_aa_so, rdm_ccaa_so, optimize = einsum_type)
K_caca -= 1/2 * einsum('WYxy,XZxy->XYWZ', v_aaaa_so, rdm_ccaa_so, optimize = einsum_type)
K_caca -= einsum('YxZy,XxWy->XYWZ', v_aaaa_so, rdm_ccaa_so, optimize = einsum_type)
K_caca += 1/2 * einsum('YZ,Wxyz,Xxyz->XYWZ', np.identity(ncas_so), v_aaaa_so, rdm_ccaa_so, optimize = einsum_type)
K_caca += 1/2 * einsum('Wxyz,XZxYyz->XYWZ', v_aaaa_so, rdm_cccaaa_so, optimize = einsum_type)
K_caca += 1/2 * einsum('Zxyz,XyzWYx->XYWZ', v_aaaa_so, rdm_cccaaa_so, optimize = einsum_type)
