K12 =- einsum('WX,YZ->XYWZ', h_aa_so, rdm_ca_so, optimize = einsum_type)
K12 += einsum('XY,WZ->XYWZ', h_aa_so, rdm_ca_so, optimize = einsum_type)
K12 -= einsum('WYXx,xZ->XYWZ', v_aaaa_so, rdm_ca_so, optimize = einsum_type)
K12 += einsum('Wx,XY,xZ->XYWZ', h_aa_so, np.identity(ncas_so), rdm_ca_so, optimize = einsum_type)
K12 -= einsum('Yx,WX,xZ->XYWZ', h_aa_so, np.identity(ncas_so), rdm_ca_so, optimize = einsum_type)
K12 += einsum('Zx,WX,Yx->XYWZ', h_aa_so, np.identity(ncas_so), rdm_ca_so, optimize = einsum_type)
K12 -= einsum('Zx,XY,Wx->XYWZ', h_aa_so, np.identity(ncas_so), rdm_ca_so, optimize = einsum_type)
K12 += einsum('Wx,YxXZ->XYWZ', h_aa_so, rdm_ccaa_so, optimize = einsum_type)
K12 -= einsum('Yx,WxXZ->XYWZ', h_aa_so, rdm_ccaa_so, optimize = einsum_type)
K12 += einsum('Zx,WYXx->XYWZ', h_aa_so, rdm_ccaa_so, optimize = einsum_type)
K12 -= 1/2 * einsum('WYxy,xyXZ->XYWZ', v_aaaa_so, rdm_ccaa_so, optimize = einsum_type)
K12 += einsum('WxXy,YyZx->XYWZ', v_aaaa_so, rdm_ccaa_so, optimize = einsum_type)
K12 += 1/2 * einsum('XZxy,WYxy->XYWZ', v_aaaa_so, rdm_ccaa_so, optimize = einsum_type)
K12 -= einsum('XxYy,WxZy->XYWZ', v_aaaa_so, rdm_ccaa_so, optimize = einsum_type)
K12 += 1/2 * einsum('WX,Yxyz,yzZx->XYWZ', np.identity(ncas_so), v_aaaa_so, rdm_ccaa_so, optimize = einsum_type)
K12 -= 1/2 * einsum('WX,Zxyz,Yxyz->XYWZ', np.identity(ncas_so), v_aaaa_so, rdm_ccaa_so, optimize = einsum_type)
K12 -= 1/2 * einsum('XY,Wxyz,yzZx->XYWZ', np.identity(ncas_so), v_aaaa_so, rdm_ccaa_so, optimize = einsum_type)
K12 += 1/2 * einsum('XY,Zxyz,Wxyz->XYWZ', np.identity(ncas_so), v_aaaa_so, rdm_ccaa_so, optimize = einsum_type)
K12 += 1/2 * einsum('Wxyz,YyzXZx->XYWZ', v_aaaa_so, rdm_cccaaa_so, optimize = einsum_type)
K12 -= 1/2 * einsum('Yxyz,WyzXZx->XYWZ', v_aaaa_so, rdm_cccaaa_so, optimize = einsum_type)
K12 += 1/2 * einsum('Zxyz,WYxXyz->XYWZ', v_aaaa_so, rdm_cccaaa_so, optimize = einsum_type)
