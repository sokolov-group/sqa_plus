
----------------------------------------------------------------------------------
sqa_plus: Code generator for quasi-particle systems.
Copyright 2009-2022 SecondQuantizationAlgebra Developers. All Rights Reserved.
Available at https://github.com/sokolov-group/sqa_plus

Licensed under the GNU General Public License v3.0;

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
----------------------------------------------------------------------------------
# Spin-Adapted V_{(I,A)}:

# Creating spin-integrated  H^(1) = V + [H^(0), T - T^\dag]:
## Creating spin-integrated  H^(0)...
17 spin-integrated H^(0) terms created.

## Creating spin-integrated T - T^\dag...
108 spin-integrated A terms created.

## Selecting spin-integrated T - T^\dag...
 (   1.00000) t1(c3a,v1a) cre(v1a) des(c3a) 
 (  -1.00000) t1(c3a,v1a) cre(c3a) des(v1a) 
 (   1.00000) t1(c3b,v1b) cre(v1b) des(c3b) 
 (  -1.00000) t1(c3b,v1b) cre(c3b) des(v1b) 
4 spin-integrated A terms selected.

## Calculating [H^(0), T - T^\dag]:
8 spin-integrated terms created.
8 spin-integrated V + H^(1) terms created.

## Creating spin-integrated T - T^\dag...
108 spin-integrated A terms created.

## Calculating [V + H^(1), T - T^\dag]:
316 spin-integrated terms created.

## Calculating a^\dag_p a_q [V + H^(1), T - T^\dag]:
# Defining a^\dag_p a_q...

## Calculating a^\dag_p a_q [V + H^(1), T - T^\dag]:
316 spin-integrated a^\dag_p a_q [V + H1, A1] terms created.


---------------------------------- SQA Automation --------------------------------

Computing expectation value with respect to virtual:=>
Done!
----------------------------------------------------------------------------------
Normal ordering with respect to core:=>
Done!
----------------------------------------------------------------------------------
Computing expectation value with respect to core:=>
Done!
----------------------------------------------------------------------------------
Contract delta function for non-dummy indices: =>
Done!
----------------------------------------------------------------------------------
Dummy indices relabelling...
Done!
----------------------------------------------------------------------------------
Reordering indices according to core < active < virtual...
Done!
----------------------------------------------------------------------------------

--------------------------------- Final results ----------------------------------

 (  -0.50000) e(i) t1(i,a) t1(I,i,A,a) 
 (   0.50000) e(a) t1(i,a) t1(I,i,A,a) 
 (  -0.50000) e(i) t1(i,a) t1(I,i,A,a) 
 (   0.50000) e(a) t1(i,a) t1(I,i,A,a) 

Total terms : 4
SQA automation time :  0.391 seconds

--------------- Converting Spin-Integrated Tensors to Spin-Adapted ---------------

----------------------------------------------------------------------------------
Convert Cre/Des objects to RDM objects...
Done!
----------------------------------------------------------------------------------
Reorder RDM tensor indices in Chemists' notation...
Done!
----------------------------------------------------------------------------------
Reorder RDM tensor indices according to: alpha < beta
Done!
----------------------------------------------------------------------------------
Reordering indices according to core < active < virtual...
Done!
----------------------------------------------------------------------------------
Dummy indices relabelling...
Done!
----------------------------------------------------------------------------------
----------------------------------------------------------------------------------
Converting Kronecker Deltas to spin-adapted formulation...
Done!
----------------------------------------------------------------------------------
Converting 1e- integrals to spin-adapted formulation...
Done!
----------------------------------------------------------------------------------
Converting 2e- integrals to spin-adapted formulation...
Done!
----------------------------------------------------------------------------------
Converting eigenvalues to spin-adapted formulation...
Done!
----------------------------------------------------------------------------------
Converting RDMs to spin-adapted formulation...

Converting 1-RDMs to spin-adapted formulation...
Converting 2-RDMs to spin-adapted formulation...
Converting 3-RDMs to spin-adapted formulation...
Converting 4-RDMs to spin-adapted formulation...
Done!
----------------------------------------------------------------------------------
Converting T amplitudes to spin-adapted formulation...
Done!
----------------------------------------------------------------------------------

Combining 6 spin-adapted terms...

Reordering indices according to core < active < virtual...
Done!
----------------------------------------------------------------------------------
Dummy indices relabelling...
Done!
----------------------------------------------------------------------------------

2 spin-adapted terms combined.

----------------------------------------------------------------------------------

----------------------------- Spin-adapted equations -----------------------------

 (   1.00000) e(a) t1(i,a) t1(I,i,A,a) 
 (  -0.50000) e(a) t1(i,a) t1(I,i,a,A) 
 (  -1.00000) e(i) t1(i,a) t1(I,i,A,a) 
 (   0.50000) e(i) t1(i,a) t1(I,i,a,A) 

Total spin-integrated terms: 4
Total spin-adapted terms: 4
Spin-adaptation automation time :  0.006 seconds

----------------------------------------------------------------------------------

------------------------------------ WARNING -------------------------------------
Terms with a contraction over repeating dummy core indices of 2e- integrals
will be removed. Set "rm_core_int" flag to FALSE to preserve terms

0 terms removed:
----------------------------------------------------------------------------------
Remaining terms: 4


# Equations using genEinsum:
V1  = einsum('a,ia,IiAa->IA', e_extern, t1_ce, t1_ccee, optimize = einsum_type)
V1 -= 1/2 * einsum('a,ia,IiaA->IA', e_extern, t1_ce, t1_ccee, optimize = einsum_type)
V1 -= einsum('i,ia,IiAa->IA', e_core, t1_ce, t1_ccee, optimize = einsum_type)
V1 += 1/2 * einsum('i,ia,IiaA->IA', e_core, t1_ce, t1_ccee, optimize = einsum_type)
