K_aa_bb =- 1/3 * einsum('Wx,XZYx->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
K_aa_bb -= 1/6 * einsum('Wx,XZxY->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
K_aa_bb += 1/6 * einsum('Zx,WYXx->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
K_aa_bb += 1/3 * einsum('Zx,WYxX->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
K_aa_bb -= 1/6 * einsum('WYxy,XZxy->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
K_aa_bb -= 1/3 * einsum('WYxy,XZyx->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
K_aa_bb -= 1/4 * einsum('Wxyz,XZxYyz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_aa_bb += 1/12 * einsum('Wxyz,XZxYzy->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_aa_bb -= 1/12 * einsum('Wxyz,XZxyYz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_aa_bb += 1/12 * einsum('Wxyz,XZxyzY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_aa_bb += 1/12 * einsum('Wxyz,XZxzYy->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_aa_bb += 1/12 * einsum('Wxyz,XZxzyY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_aa_bb += 1/6 * einsum('YxyZ,WyXx->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
K_aa_bb += 1/3 * einsum('YxyZ,WyxX->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
K_aa_bb += 1/12 * einsum('Zxyz,XyzWYx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_aa_bb -= 1/12 * einsum('Zxyz,XyzWxY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_aa_bb += 1/4 * einsum('Zxyz,XyzYWx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_aa_bb -= 1/12 * einsum('Zxyz,XyzYxW->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_aa_bb -= 1/12 * einsum('Zxyz,XyzxWY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_aa_bb -= 1/12 * einsum('Zxyz,XyzxYW->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
