M_c_cca_a_bab =- einsum('LIKY->IKLY', v_xxxa, optimize = einsum_type).copy()
M_c_cca_a_bab += einsum('KY,IL->IKLY', h_xa, np.identity(ncvs), optimize = einsum_type)
M_c_cca_a_bab += 1/2 * einsum('LIKx,Yx->IKLY', v_xxxa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab -= einsum('K,IL,KY->IKLY', e_cvs, np.identity(ncvs), t1_xa, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('Kx,IL,Yx->IKLY', h_xa, np.identity(ncvs), rdm_ca, optimize = einsum_type)
M_c_cca_a_bab += einsum('Yx,IL,Kx->IKLY', h_aa, np.identity(ncvs), t1_xa, optimize = einsum_type)
M_c_cca_a_bab += einsum('IL,KYxy,xy->IKLY', np.identity(ncvs), v_xaaa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('IL,KxyY,yx->IKLY', np.identity(ncvs), v_xaaa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('IL,Kxyz,Yyxz->IKLY', np.identity(ncvs), v_xaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab += 1/2 * einsum('K,IL,Kx,Yx->IKLY', e_cvs, np.identity(ncvs), t1_xa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab -= einsum('K,IL,KxYy,xy->IKLY', e_cvs, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab += 1/2 * einsum('K,IL,KxyY,xy->IKLY', e_cvs, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab += 1/2 * einsum('K,IL,Kxyz,Yxyz->IKLY', e_cvs, np.identity(ncvs), t1_xaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab += einsum('Yx,IL,Kyxz,yz->IKLY', h_aa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('Yx,IL,Kyzx,yz->IKLY', h_aa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('xy,IL,Kx,Yy->IKLY', h_aa, np.identity(ncvs), t1_xa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab -= einsum('xy,IL,KxYz,yz->IKLY', h_aa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab += 1/2 * einsum('xy,IL,KxzY,yz->IKLY', h_aa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab += 1/2 * einsum('xy,IL,Kxzw,Yyzw->IKLY', h_aa, np.identity(ncvs), t1_xaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab += einsum('xy,IL,KzYx,yz->IKLY', h_aa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('xy,IL,Kzwx,Yzwy->IKLY', h_aa, np.identity(ncvs), t1_xaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('xy,IL,KzxY,yz->IKLY', h_aa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('xy,IL,Kzxw,Yzyw->IKLY', h_aa, np.identity(ncvs), t1_xaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab += einsum('IL,Kx,Yxyz,yz->IKLY', np.identity(ncvs), t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('IL,Kx,Yyzx,zy->IKLY', np.identity(ncvs), t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('IL,Kx,xyzw,Yzyw->IKLY', np.identity(ncvs), t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab -= einsum('IL,KxYy,xzwu,ywzu->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab += einsum('IL,KxYy,yzwu,xwzu->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab += 1/2 * einsum('IL,KxyY,xzwu,ywzu->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('IL,KxyY,yzwu,xwzu->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('IL,Kxyz,Ywuy,xwzu->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('IL,Kxyz,Ywuz,xwuy->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab += 1/2 * einsum('IL,Kxyz,Ywxu,yzwu->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab += einsum('IL,Kxyz,Yywu,xuzw->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab += einsum('IL,Kxyz,Yywz,xw->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('IL,Kxyz,Yzwu,xuyw->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('IL,Kxyz,Yzwy,xw->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
M_c_cca_a_bab -= 1/24 * einsum('IL,Kxyz,xwuv,Ywvuyz->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab -= 1/24 * einsum('IL,Kxyz,xwuv,Ywvuzy->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab -= 1/24 * einsum('IL,Kxyz,xwuv,Ywvyuz->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab += 11/24 * einsum('IL,Kxyz,xwuv,Ywvyzu->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab -= 1/24 * einsum('IL,Kxyz,xwuv,Ywvzuy->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab -= 1/24 * einsum('IL,Kxyz,xwuv,Ywvzyu->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab += 1/6 * einsum('IL,Kxyz,ywuv,Yxuvwz->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab += 1/6 * einsum('IL,Kxyz,ywuv,Yxuvzw->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab += 1/6 * einsum('IL,Kxyz,ywuv,Yxuwvz->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab -= 1/3 * einsum('IL,Kxyz,ywuv,Yxuwzv->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab += 1/6 * einsum('IL,Kxyz,ywuv,Yxuzvw->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab += 1/6 * einsum('IL,Kxyz,ywuv,Yxuzwv->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab -= 1/2 * einsum('IL,Kxyz,ywzu,Yxwu->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
M_c_cca_a_bab += 1/12 * einsum('IL,Kxyz,zwuv,Yxuvwy->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab += 1/12 * einsum('IL,Kxyz,zwuv,Yxuvyw->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab += 1/12 * einsum('IL,Kxyz,zwuv,Yxuwvy->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab += 1/12 * einsum('IL,Kxyz,zwuv,Yxuwyv->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab += 1/12 * einsum('IL,Kxyz,zwuv,Yxuyvw->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
M_c_cca_a_bab -= 5/12 * einsum('IL,Kxyz,zwuv,Yxuywv->IKLY', np.identity(ncvs), t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
