temp =  np.einsum('B, AB, UXYZ->XAYZBU', e_extern_so, np.identity(nextern_so), rdm_ccaa_so, optimize = True)
temp -= np.einsum('Ux, AB, XxYZ->XAYZBU', h_aa_so, np.identity(nextern_so), rdm_ccaa_so, optimize = True)
temp += np.einsum('Yx, AB, UXZx->XAYZBU', h_aa_so, np.identity(nextern_so), rdm_ccaa_so, optimize = True)
temp -= np.einsum('Zx, AB, UXYx->XAYZBU', h_aa_so, np.identity(nextern_so), rdm_ccaa_so, optimize = True)
temp += np.einsum('AB, iYix, UXZx->XAYZBU', np.identity(nextern_so), v_caca_so, rdm_ccaa_so, optimize = True)
temp -= np.einsum('AB, iZix, UXYx->XAYZBU', np.identity(nextern_so), v_caca_so, rdm_ccaa_so, optimize = True)
temp -= 0.5 * np.einsum('AB, xyYZ, UXxy->XAYZBU', np.identity(nextern_so), v_aaaa_so, rdm_ccaa_so, optimize = True)
temp -= np.einsum('AB, ixiU, XxYZ->XAYZBU', np.identity(nextern_so), v_caca_so, rdm_ccaa_so, optimize = True)
temp -= 0.5 * np.einsum('AB, Uxyz, XyzYZx->XAYZBU', np.identity(nextern_so), v_aaaa_so, rdm_cccaaa_so, optimize = True)
temp += 0.5 * np.einsum('AB, xyYz, UXzZxy->XAYZBU', np.identity(nextern_so), v_aaaa_so, rdm_cccaaa_so, optimize = True)
temp -= 0.5 * np.einsum('AB, xyZz, UXzYxy->XAYZBU', np.identity(nextern_so), v_aaaa_so, rdm_cccaaa_so, optimize = True)
