temp  = np.einsum('ix,ix->P', h_ca_so, t1_ca, optimize = True)
temp += np.einsum('ia,ia->P', h_ce_so, t1_ce, optimize = True)
temp -= np.einsum('ix,ijjx->P', t1_ca, v_ccca_so, optimize = True)
temp += 1/4 * np.einsum('ijxy,ijxy->P', t1_ccaa, v_ccaa_so, optimize = True)
temp += 1/2 * np.einsum('ijax,ijax->P', t1_ccea, v_ccea_so, optimize = True)
temp += 1/4 * np.einsum('ijab,ijab->P', t1_ccee, v_ccee_so, optimize = True)
temp -= np.einsum('ia,ijja->P', t1_ce, v_ccce_so, optimize = True)
temp -= np.einsum('ix,iy,Pyx->P', h_ca_so, t1_ca, trdm_ca_so, optimize = True)
temp += np.einsum('ix,iyxz,Pzy->P', h_ca_so, t1_caaa, trdm_ca_so, optimize = True)
temp += np.einsum('ia,ixay,Pyx->P', h_ce_so, t1_caea, trdm_ca_so, optimize = True)
temp += np.einsum('xa,ya,Pxy->P', h_ae_so, t1_ae, trdm_ca_so, optimize = True)
temp += np.einsum('ix,iyxz,Pyz->P', t1_ca, v_caaa_so, trdm_ca_so, optimize = True)
temp += np.einsum('ix,ijjy,Pxy->P', t1_ca, v_ccca_so, trdm_ca_so, optimize = True)
temp += 1/2 * np.einsum('ixyz,iwyz,Pwx->P', t1_caaa, v_caaa_so, trdm_ca_so, optimize = True)
temp -= np.einsum('ixyz,ijjy,Pzx->P', t1_caaa, v_ccca_so, trdm_ca_so, optimize = True)
temp += np.einsum('ixay,izay,Pzx->P', t1_caea, v_caea_so, trdm_ca_so, optimize = True)
temp -= np.einsum('ixay,ijja,Pyx->P', t1_caea, v_ccce_so, trdm_ca_so, optimize = True)
temp += 1/2 * np.einsum('ixab,iyab,Pyx->P', t1_caee, v_caee_so, trdm_ca_so, optimize = True)
temp -= 1/2 * np.einsum('ijxy,ijxz,Pyz->P', t1_ccaa, v_ccaa_so, trdm_ca_so, optimize = True)
temp -= 1/2 * np.einsum('ijax,ijay,Pxy->P', t1_ccea, v_ccea_so, trdm_ca_so, optimize = True)
temp += np.einsum('xa,iyia,Pyx->P', t1_ae, v_cace_so, trdm_ca_so, optimize = True)
temp += np.einsum('ia,ixay,Pxy->P', t1_ce, v_caea_so, trdm_ca_so, optimize = True)
temp += 1/2 * np.einsum('ix,iyzw,Pzwxy->P', h_ca_so, t1_caaa, trdm_ccaa_so, optimize = True)
temp -= 1/2 * np.einsum('xa,yzaw,Pxwyz->P', h_ae_so, t1_aaea, trdm_ccaa_so, optimize = True)
temp -= 1/4 * np.einsum('xyaz,wuaz,Pwuxy->P', t1_aaea, v_aaea_so, trdm_ccaa_so, optimize = True)
temp += 1/2 * np.einsum('xyaz,iwia,Pzwxy->P', t1_aaea, v_cace_so, trdm_ccaa_so, optimize = True)
temp -= 1/8 * np.einsum('xyab,zwab,Pzwxy->P', t1_aaee, v_aaee_so, trdm_ccaa_so, optimize = True)
temp += 1/2 * np.einsum('ix,iyzw,Pxyzw->P', t1_ca, v_caaa_so, trdm_ccaa_so, optimize = True)
temp -= np.einsum('ixyz,iwyu,Pzwxu->P', t1_caaa, v_caaa_so, trdm_ccaa_so, optimize = True)
temp += 1/2 * np.einsum('ixyz,ijjw,Pyzxw->P', t1_caaa, v_ccca_so, trdm_ccaa_so, optimize = True)
temp -= np.einsum('ixay,izaw,Pyzxw->P', t1_caea, v_caea_so, trdm_ccaa_so, optimize = True)
temp -= 1/8 * np.einsum('ijxy,ijzw,Pxyzw->P', t1_ccaa, v_ccaa_so, trdm_ccaa_so, optimize = True)
temp -= 1/2 * np.einsum('xa,yzaw,Pyzxw->P', t1_ae, v_aaea_so, trdm_ccaa_so, optimize = True)
temp += 1/4 * np.einsum('xyaz,wuav,Pzwuxyv->P', t1_aaea, v_aaea_so, trdm_cccaaa_so, optimize = True)
temp -= 1/4 * np.einsum('ixyz,iwuv,Pyzwxuv->P', t1_caaa, v_caaa_so, trdm_cccaaa_so, optimize = True)
