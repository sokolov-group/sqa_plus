K_caca_aa_aa =- 1/6 * einsum('Wx,XZYx->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
K_caca_aa_aa += 1/6 * einsum('Wx,XZxY->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
K_caca_aa_aa += 1/2 * einsum('YZ,WX->XYWZ', h_aa, rdm_ca, optimize = einsum_type)
K_caca_aa_aa -= 1/6 * einsum('Zx,WYXx->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
K_caca_aa_aa += 1/6 * einsum('Zx,WYxX->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
K_caca_aa_aa += 1/6 * einsum('WxYy,XZxy->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
K_caca_aa_aa -= 1/6 * einsum('WxYy,XZyx->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
K_caca_aa_aa -= 5/24 * einsum('Wxyz,XZyYxz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_caca_aa_aa -= 1/24 * einsum('Wxyz,XZyYzx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_caca_aa_aa += 1/8 * einsum('Wxyz,XZyxYz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_caca_aa_aa -= 1/24 * einsum('Wxyz,XZyxzY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_caca_aa_aa -= 1/24 * einsum('Wxyz,XZyzYx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_caca_aa_aa -= 1/24 * einsum('Wxyz,XZyzxY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_caca_aa_aa += 1/2 * einsum('YZxy,WyXx->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
K_caca_aa_aa -= 1/6 * einsum('YxyZ,WxXy->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
K_caca_aa_aa += 1/6 * einsum('YxyZ,WxyX->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
K_caca_aa_aa -= 5/24 * einsum('Zxyz,WYyXxz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_caca_aa_aa -= 1/24 * einsum('Zxyz,WYyXzx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_caca_aa_aa += 1/8 * einsum('Zxyz,WYyxXz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_caca_aa_aa -= 1/24 * einsum('Zxyz,WYyxzX->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_caca_aa_aa -= 1/24 * einsum('Zxyz,WYyzXx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_caca_aa_aa -= 1/24 * einsum('Zxyz,WYyzxX->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
K_caca_aa_aa -= 1/2 * einsum('Wx,YZ,Xx->XYWZ', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
K_caca_aa_aa -= 1/2 * einsum('YZ,Wxyz,Xyxz->XYWZ', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
