sigma_cce =- einsum('KLx,xB->KLB', X_aaa, h_ae, optimize = einsum_type)
sigma_cce += einsum('Kix,LixB->KLB', X_aaa, v_xxae, optimize = einsum_type)
sigma_cce -= einsum('Kix,ixBL->KLB', X_aaa, v_xaex, optimize = einsum_type)
sigma_cce -= einsum('Lix,KixB->KLB', X_aaa, v_xxae, optimize = einsum_type)
sigma_cce += einsum('Lix,ixBK->KLB', X_aaa, v_xaex, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('Kix,ixBL->KLB', X_abb, v_xaex, optimize = einsum_type)
sigma_cce += 1/2 * einsum('Lix,ixBK->KLB', X_abb, v_xaex, optimize = einsum_type)
sigma_cce += 1/2 * einsum('iKx,ixBL->KLB', X_bab, v_xaex, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('iLx,ixBK->KLB', X_bab, v_xaex, optimize = einsum_type)
sigma_cce -= einsum('KLx,B,xB->KLB', X_aaa, e_extern, t1_ae, optimize = einsum_type)
sigma_cce += einsum('KLx,xy,yB->KLB', X_aaa, h_aa, t1_ae, optimize = einsum_type)
sigma_cce -= einsum('KLx,yzxB,zy->KLB', X_aaa, v_aaae, rdm_ca, optimize = einsum_type)
sigma_cce += 1/2 * einsum('KLx,xyzB,yz->KLB', X_aaa, v_aaae, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('Kix,LiyB,xy->KLB', X_aaa, v_xxae, rdm_ca, optimize = einsum_type)
sigma_cce += 1/2 * einsum('Kix,iyBL,xy->KLB', X_aaa, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cce += 1/2 * einsum('Lix,KiyB,xy->KLB', X_aaa, v_xxae, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('Lix,iyBK,xy->KLB', X_aaa, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cce += 1/4 * einsum('Kix,iyBL,xy->KLB', X_abb, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/4 * einsum('Lix,iyBK,xy->KLB', X_abb, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/4 * einsum('iKx,iyBL,xy->KLB', X_bab, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cce += 1/4 * einsum('iLx,iyBK,xy->KLB', X_bab, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cce -= einsum('KLx,B,yxzB,zy->KLB', X_aaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce += 1/2 * einsum('KLx,B,xyzB,zy->KLB', X_aaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce -= einsum('KLx,yz,wxyB,zw->KLB', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce += einsum('KLx,yz,yxwB,zw->KLB', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce += 1/2 * einsum('KLx,yz,xwyB,zw->KLB', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,yz,xywB,zw->KLB', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce += einsum('KLx,xy,zywB,wz->KLB', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,xy,yzwB,wz->KLB', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,yB,xzwy,wz->KLB', X_aaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
sigma_cce += einsum('KLx,yB,xyzw,zw->KLB', X_aaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,yzwB,xuvz,wuyv->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,yzwB,xuvy,wuvz->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce += 1/2 * einsum('KLx,yzwB,xuwv,zyuv->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce += einsum('KLx,yzwB,xzuv,wvyu->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce += einsum('KLx,yzwB,xzuy,wu->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,yzwB,xyuv,wvzu->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,yzwB,xyuz,wu->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
sigma_cce -= einsum('KLx,yxzB,zwuv,yuwv->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce += einsum('KLx,yxzB,ywuv,zuwv->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce += 1/2 * einsum('KLx,xyzB,zwuv,yuwv->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,xyzB,ywuv,zuwv->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce =- einsum('KLx,xB->KLB', X_aaa, h_ae, optimize = einsum_type)
sigma_cce += einsum('Kix,LixB->KLB', X_aaa, v_xxae, optimize = einsum_type)
sigma_cce -= einsum('Kix,ixBL->KLB', X_aaa, v_xaex, optimize = einsum_type)
sigma_cce -= einsum('Lix,KixB->KLB', X_aaa, v_xxae, optimize = einsum_type)
sigma_cce += einsum('Lix,ixBK->KLB', X_aaa, v_xaex, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('Kix,ixBL->KLB', X_abb, v_xaex, optimize = einsum_type)
sigma_cce += 1/2 * einsum('Lix,ixBK->KLB', X_abb, v_xaex, optimize = einsum_type)
sigma_cce += 1/2 * einsum('iKx,ixBL->KLB', X_bab, v_xaex, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('iLx,ixBK->KLB', X_bab, v_xaex, optimize = einsum_type)
sigma_cce -= einsum('KLx,B,xB->KLB', X_aaa, e_extern, t1_ae, optimize = einsum_type)
sigma_cce += einsum('KLx,xy,yB->KLB', X_aaa, h_aa, t1_ae, optimize = einsum_type)
sigma_cce -= einsum('KLx,yzxB,zy->KLB', X_aaa, v_aaae, rdm_ca, optimize = einsum_type)
sigma_cce += 1/2 * einsum('KLx,xyzB,yz->KLB', X_aaa, v_aaae, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('Kix,LiyB,xy->KLB', X_aaa, v_xxae, rdm_ca, optimize = einsum_type)
sigma_cce += 1/2 * einsum('Kix,iyBL,xy->KLB', X_aaa, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cce += 1/2 * einsum('Lix,KiyB,xy->KLB', X_aaa, v_xxae, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('Lix,iyBK,xy->KLB', X_aaa, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cce += 1/4 * einsum('Kix,iyBL,xy->KLB', X_abb, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/4 * einsum('Lix,iyBK,xy->KLB', X_abb, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/4 * einsum('iKx,iyBL,xy->KLB', X_bab, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cce += 1/4 * einsum('iLx,iyBK,xy->KLB', X_bab, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cce -= einsum('KLx,B,yxzB,zy->KLB', X_aaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce += 1/2 * einsum('KLx,B,xyzB,zy->KLB', X_aaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce -= einsum('KLx,yz,wxyB,zw->KLB', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce += einsum('KLx,yz,yxwB,zw->KLB', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce += 1/2 * einsum('KLx,yz,xwyB,zw->KLB', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,yz,xywB,zw->KLB', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce += einsum('KLx,xy,zywB,wz->KLB', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,xy,yzwB,wz->KLB', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,yB,xzwy,wz->KLB', X_aaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
sigma_cce += einsum('KLx,yB,xyzw,zw->KLB', X_aaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,yzwB,xuvz,wuyv->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,yzwB,xuvy,wuvz->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce += 1/2 * einsum('KLx,yzwB,xuwv,zyuv->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce += einsum('KLx,yzwB,xzuv,wvyu->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce += einsum('KLx,yzwB,xzuy,wu->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,yzwB,xyuv,wvzu->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,yzwB,xyuz,wu->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
sigma_cce -= einsum('KLx,yxzB,zwuv,yuwv->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce += einsum('KLx,yxzB,ywuv,zuwv->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce += 1/2 * einsum('KLx,xyzB,zwuv,yuwv->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cce -= 1/2 * einsum('KLx,xyzB,ywuv,zuwv->KLB', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
