sigma_cca  = einsum('Lix,KWxi->KLW', X_aaa, v_xaax, optimize = einsum_type)
sigma_cca += einsum('Lix,KWxi->KLW', X_abb, v_xaax, optimize = einsum_type)
sigma_cca -= einsum('Lix,KixW->KLW', X_abb, v_xxaa, optimize = einsum_type)
sigma_cca += einsum('ijW,KjLi->KLW', X_abb, v_xxxx, optimize = einsum_type)
sigma_cca -= einsum('iKx,LixW->KLW', X_abb, v_xxaa, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Lix,KWyi,xy->KLW', X_aaa, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca += 1/6 * einsum('Lix,Kyzi,Wzxy->KLW', X_aaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/3 * einsum('Lix,Kyzi,Wzyx->KLW', X_aaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Lix,Kyxi,Wy->KLW', X_aaa, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Lix,KWyi,xy->KLW', X_abb, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Lix,KiyW,xy->KLW', X_abb, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Lix,Kiyz,Wyxz->KLW', X_abb, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/6 * einsum('Lix,Kyzi,Wzxy->KLW', X_abb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/6 * einsum('Lix,Kyzi,Wzyx->KLW', X_abb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Lix,Kixy,Wy->KLW', X_abb, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Lix,Kyxi,Wy->KLW', X_abb, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('iKx,LiyW,xy->KLW', X_abb, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('iKx,Liyz,Wyxz->KLW', X_abb, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/3 * einsum('iKx,Lyzi,Wzxy->KLW', X_abb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/6 * einsum('iKx,Lyzi,Wzyx->KLW', X_abb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/2 * einsum('iKx,Lixy,Wy->KLW', X_abb, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('ijx,KjLi,Wx->KLW', X_abb, v_xxxx, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Lix,Kiyz,yz,Wx->KLW', X_abb, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
sigma_cca += 1/4 * einsum('Lix,Kyzi,zy,Wx->KLW', X_abb, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('iKx,Liyz,yz,Wx->KLW', X_abb, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
sigma_cca += 1/4 * einsum('iKx,Lyzi,zy,Wx->KLW', X_abb, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
