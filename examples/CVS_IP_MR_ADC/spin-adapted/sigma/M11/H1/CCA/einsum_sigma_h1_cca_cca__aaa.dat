sigma_cca =- einsum('Kix,LWxi->KLW', X_aaa, v_xaax, optimize = einsum_type)
sigma_cca += einsum('Kix,LixW->KLW', X_aaa, v_xxaa, optimize = einsum_type)
sigma_cca += einsum('Lix,KWxi->KLW', X_aaa, v_xaax, optimize = einsum_type)
sigma_cca -= einsum('Lix,KixW->KLW', X_aaa, v_xxaa, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('ijW,KiLj->KLW', X_aaa, v_xxxx, optimize = einsum_type)
sigma_cca += 1/2 * einsum('ijW,KjLi->KLW', X_aaa, v_xxxx, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Kix,LWxi->KLW', X_abb, v_xaax, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Lix,KWxi->KLW', X_abb, v_xaax, optimize = einsum_type)
sigma_cca += 1/2 * einsum('iKx,LWxi->KLW', X_bab, v_xaax, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('iLx,KWxi->KLW', X_bab, v_xaax, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Kix,LWyi,xy->KLW', X_aaa, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Kix,LiyW,xy->KLW', X_aaa, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Kix,Liyz,Wyxz->KLW', X_aaa, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/6 * einsum('Kix,Lyzi,Wzxy->KLW', X_aaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/6 * einsum('Kix,Lyzi,Wzyx->KLW', X_aaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Kix,Lixy,Wy->KLW', X_aaa, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Kix,Lyxi,Wy->KLW', X_aaa, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Lix,KWyi,xy->KLW', X_aaa, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Lix,KiyW,xy->KLW', X_aaa, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Lix,Kiyz,Wyxz->KLW', X_aaa, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/6 * einsum('Lix,Kyzi,Wzxy->KLW', X_aaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/6 * einsum('Lix,Kyzi,Wzyx->KLW', X_aaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Lix,Kixy,Wy->KLW', X_aaa, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Lix,Kyxi,Wy->KLW', X_aaa, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/4 * einsum('ijx,KjLi,Wx->KLW', X_aaa, v_xxxx, rdm_ca, optimize = einsum_type)
sigma_cca += 1/4 * einsum('ijx,KiLj,Wx->KLW', X_aaa, v_xxxx, rdm_ca, optimize = einsum_type)
sigma_cca += 1/4 * einsum('Kix,LWyi,xy->KLW', X_abb, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/12 * einsum('Kix,Lyzi,Wzxy->KLW', X_abb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/6 * einsum('Kix,Lyzi,Wzyx->KLW', X_abb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/4 * einsum('Kix,Lyxi,Wy->KLW', X_abb, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/4 * einsum('Lix,KWyi,xy->KLW', X_abb, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca += 1/12 * einsum('Lix,Kyzi,Wzxy->KLW', X_abb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/6 * einsum('Lix,Kyzi,Wzyx->KLW', X_abb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/4 * einsum('Lix,Kyxi,Wy->KLW', X_abb, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/4 * einsum('iKx,LWyi,xy->KLW', X_bab, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca += 1/12 * einsum('iKx,Lyzi,Wzxy->KLW', X_bab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/6 * einsum('iKx,Lyzi,Wzyx->KLW', X_bab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/4 * einsum('iLx,KWyi,xy->KLW', X_bab, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/12 * einsum('iLx,Kyzi,Wzxy->KLW', X_bab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/6 * einsum('iLx,Kyzi,Wzyx->KLW', X_bab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/4 * einsum('iKx,Lyxi,Wy->KLW', X_bab, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca += 1/4 * einsum('iLx,Kyxi,Wy->KLW', X_bab, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Kix,Liyz,yz,Wx->KLW', X_aaa, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/4 * einsum('Kix,Lyzi,zy,Wx->KLW', X_aaa, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Lix,Kiyz,yz,Wx->KLW', X_aaa, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
sigma_cca += 1/4 * einsum('Lix,Kyzi,zy,Wx->KLW', X_aaa, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
sigma_cca =- einsum('Kix,LWxi->KLW', X_aaa, v_xaax, optimize = einsum_type)
sigma_cca += einsum('Kix,LixW->KLW', X_aaa, v_xxaa, optimize = einsum_type)
sigma_cca += einsum('Lix,KWxi->KLW', X_aaa, v_xaax, optimize = einsum_type)
sigma_cca -= einsum('Lix,KixW->KLW', X_aaa, v_xxaa, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('ijW,KiLj->KLW', X_aaa, v_xxxx, optimize = einsum_type)
sigma_cca += 1/2 * einsum('ijW,KjLi->KLW', X_aaa, v_xxxx, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Kix,LWxi->KLW', X_abb, v_xaax, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Lix,KWxi->KLW', X_abb, v_xaax, optimize = einsum_type)
sigma_cca += 1/2 * einsum('iKx,LWxi->KLW', X_bab, v_xaax, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('iLx,KWxi->KLW', X_bab, v_xaax, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Kix,LWyi,xy->KLW', X_aaa, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Kix,LiyW,xy->KLW', X_aaa, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Kix,Liyz,Wyxz->KLW', X_aaa, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/6 * einsum('Kix,Lyzi,Wzxy->KLW', X_aaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/6 * einsum('Kix,Lyzi,Wzyx->KLW', X_aaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Kix,Lixy,Wy->KLW', X_aaa, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Kix,Lyxi,Wy->KLW', X_aaa, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Lix,KWyi,xy->KLW', X_aaa, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Lix,KiyW,xy->KLW', X_aaa, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Lix,Kiyz,Wyxz->KLW', X_aaa, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/6 * einsum('Lix,Kyzi,Wzxy->KLW', X_aaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/6 * einsum('Lix,Kyzi,Wzyx->KLW', X_aaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Lix,Kixy,Wy->KLW', X_aaa, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Lix,Kyxi,Wy->KLW', X_aaa, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/4 * einsum('ijx,KjLi,Wx->KLW', X_aaa, v_xxxx, rdm_ca, optimize = einsum_type)
sigma_cca += 1/4 * einsum('ijx,KiLj,Wx->KLW', X_aaa, v_xxxx, rdm_ca, optimize = einsum_type)
sigma_cca += 1/4 * einsum('Kix,LWyi,xy->KLW', X_abb, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/12 * einsum('Kix,Lyzi,Wzxy->KLW', X_abb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/6 * einsum('Kix,Lyzi,Wzyx->KLW', X_abb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/4 * einsum('Kix,Lyxi,Wy->KLW', X_abb, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/4 * einsum('Lix,KWyi,xy->KLW', X_abb, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca += 1/12 * einsum('Lix,Kyzi,Wzxy->KLW', X_abb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/6 * einsum('Lix,Kyzi,Wzyx->KLW', X_abb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/4 * einsum('Lix,Kyxi,Wy->KLW', X_abb, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/4 * einsum('iKx,LWyi,xy->KLW', X_bab, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca += 1/12 * einsum('iKx,Lyzi,Wzxy->KLW', X_bab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/6 * einsum('iKx,Lyzi,Wzyx->KLW', X_bab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/4 * einsum('iLx,KWyi,xy->KLW', X_bab, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/12 * einsum('iLx,Kyzi,Wzxy->KLW', X_bab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/6 * einsum('iLx,Kyzi,Wzyx->KLW', X_bab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/4 * einsum('iKx,Lyxi,Wy->KLW', X_bab, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca += 1/4 * einsum('iLx,Kyxi,Wy->KLW', X_bab, v_xaax, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Kix,Liyz,yz,Wx->KLW', X_aaa, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/4 * einsum('Kix,Lyzi,zy,Wx->KLW', X_aaa, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Lix,Kiyz,yz,Wx->KLW', X_aaa, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
sigma_cca += 1/4 * einsum('Lix,Kyzi,zy,Wx->KLW', X_aaa, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
