sigma_cca =- einsum('KLa,Wa->KLW', X_aaa, h_ae, optimize = einsum_type)
sigma_cca -= einsum('Kia,LWai->KLW', X_aaa, v_xaex, optimize = einsum_type)
sigma_cca += einsum('Kia,iLWa->KLW', X_aaa, v_xxae, optimize = einsum_type)
sigma_cca += einsum('Lia,KWai->KLW', X_aaa, v_xaex, optimize = einsum_type)
sigma_cca -= einsum('Lia,iKWa->KLW', X_aaa, v_xxae, optimize = einsum_type)
sigma_cca -= einsum('Kia,LWai->KLW', X_abb, v_xaex, optimize = einsum_type)
sigma_cca += einsum('Lia,KWai->KLW', X_abb, v_xaex, optimize = einsum_type)
sigma_cca -= einsum('KLa,a,Wa->KLW', X_aaa, e_extern, t1_ae, optimize = einsum_type)
sigma_cca += 1/2 * einsum('KLa,xa,Wx->KLW', X_aaa, h_ae, rdm_ca, optimize = einsum_type)
sigma_cca += einsum('KLa,Wx,xa->KLW', X_aaa, h_aa, t1_ae, optimize = einsum_type)
sigma_cca += 1/2 * einsum('KLa,Wxya,yx->KLW', X_aaa, v_aaae, rdm_ca, optimize = einsum_type)
sigma_cca -= einsum('KLa,xyWa,xy->KLW', X_aaa, v_aaae, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('KLa,xyza,Wyzx->KLW', X_aaa, v_aaae, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Kia,Lxai,Wx->KLW', X_aaa, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Kia,iLxa,Wx->KLW', X_aaa, v_xxae, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Lia,Kxai,Wx->KLW', X_aaa, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Lia,iKxa,Wx->KLW', X_aaa, v_xxae, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('Kia,Lxai,Wx->KLW', X_abb, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('Lia,Kxai,Wx->KLW', X_abb, v_xaex, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('KLa,a,Wxya,xy->KLW', X_aaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cca -= einsum('KLa,a,xWya,xy->KLW', X_aaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('KLa,a,xa,Wx->KLW', X_aaa, e_extern, t1_ae, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('KLa,a,xyza,Wzyx->KLW', X_aaa, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
sigma_cca += einsum('KLa,Wx,yxza,zy->KLW', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('KLa,Wx,xyza,zy->KLW', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('KLa,xy,Wzxa,yz->KLW', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('KLa,xy,Wxza,yz->KLW', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cca -= einsum('KLa,xy,zWxa,yz->KLW', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('KLa,xy,zwxa,Wywz->KLW', X_aaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('KLa,xy,zxwa,Wwyz->KLW', X_aaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
sigma_cca += einsum('KLa,xy,xWza,yz->KLW', X_aaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('KLa,xy,xa,Wy->KLW', X_aaa, h_aa, t1_ae, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('KLa,xy,xzwa,Wwzy->KLW', X_aaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/2 * einsum('KLa,Wxya,yzwu,xwzu->KLW', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('KLa,Wxya,xzwu,ywzu->KLW', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cca -= einsum('KLa,xWya,yzwu,xwzu->KLW', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cca += einsum('KLa,xWya,xzwu,ywzu->KLW', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('KLa,xa,Wyzx,zy->KLW', X_aaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
sigma_cca += einsum('KLa,xa,Wxyz,yz->KLW', X_aaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('KLa,xa,xyzw,Wzyw->KLW', X_aaa, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('KLa,xyza,Wwuy,zwxu->KLW', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('KLa,xyza,Wwux,zwuy->KLW', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cca += 1/2 * einsum('KLa,xyza,Wwzu,yxwu->KLW', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cca += einsum('KLa,xyza,Wywu,zuxw->KLW', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cca += einsum('KLa,xyza,Wywx,zw->KLW', X_aaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('KLa,xyza,Wxwu,zuyw->KLW', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('KLa,xyza,Wxwy,zw->KLW', X_aaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
sigma_cca += 1/2 * einsum('KLa,xyza,zwuv,Wwvyxu->KLW', X_aaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
sigma_cca += 1/6 * einsum('KLa,xyza,ywuv,Wzuvwx->KLW', X_aaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
sigma_cca += 1/6 * einsum('KLa,xyza,ywuv,Wzuvxw->KLW', X_aaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
sigma_cca += 1/6 * einsum('KLa,xyza,ywuv,Wzuwvx->KLW', X_aaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
sigma_cca -= 1/3 * einsum('KLa,xyza,ywuv,Wzuwxv->KLW', X_aaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
sigma_cca += 1/6 * einsum('KLa,xyza,ywuv,Wzuxvw->KLW', X_aaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
sigma_cca += 1/6 * einsum('KLa,xyza,ywuv,Wzuxwv->KLW', X_aaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('KLa,xyza,ywxu,Wzwu->KLW', X_aaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
sigma_cca -= 1/2 * einsum('KLa,xyza,xwuv,Wzuywv->KLW', X_aaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
