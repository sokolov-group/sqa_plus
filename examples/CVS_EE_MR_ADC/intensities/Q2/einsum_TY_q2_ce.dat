einsum equations from TY_q2_ce.dat

TY[:, s_c:f_c, s_c:f_c] =- einsum('RPa,Qa->RPQ', Y_KC__aa, t2_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,Qiab,ib->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,Qiab,ib->RPQ', Y_KC__aa, t1_xvee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__aa, t1_xvee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__aa, t1_xvae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,iQxa,ix->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,iQxa,ix->RPQ', Y_KC__aa, t1_vxae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,xa,Qx->RPQ', Y_KC__aa, t1_ae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += einsum('Ria,Qiab,Pb->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qiba,Pb->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qixa,Px->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += einsum('Ria,iQxa,Px->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,Qxay,xy->RPQ', Y_KC__aa, t2_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qxya,xy->RPQ', Y_KC__aa, t2_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qiba,Pb->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qixa,Px->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__aa, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/2 * einsum('RPa,Qxab,yb,xy->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/2 * einsum('RPa,Qxab,yzwb,xwzy->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/4 * einsum('RPa,Qxba,yb,xy->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/4 * einsum('RPa,Qxba,yzwb,xwzy->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,xa,Qyxz,yz->RPQ', Y_KC__aa, t1_ae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,xa,Qyzx,yz->RPQ', Y_KC__aa, t1_ae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,xyza,Qwux,zuwy->RPQ', Y_KC__aa, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,xyza,Qwuy,zuxw->RPQ', Y_KC__aa, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,xyza,Qwxu,zuyw->RPQ', Y_KC__aa, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,xyza,Qwxy,zw->RPQ', Y_KC__aa, t1_aaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,xyza,Qwyu,zuxw->RPQ', Y_KC__aa, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,xyza,Qwyx,zw->RPQ', Y_KC__aa, t1_aaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,xyza,Qx,zy->RPQ', Y_KC__aa, t1_aaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,xyza,Qy,zx->RPQ', Y_KC__aa, t1_aaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/4 * einsum('RPa,xyza,Qzwu,yxwu->RPQ', Y_KC__aa, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += einsum('Ria,Qiab,Pxby,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/2 * einsum('Ria,Qiab,Pxyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/2 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)

TY[:, s_c:f_c, s_c:f_c] =- einsum('RPa,Qa->RPQ', Y_KC__bb, t2_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qiba,Pb->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qixa,Px->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,Qiab,ib->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,Qiab,ib->RPQ', Y_KC__bb, t1_xvee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__bb, t1_xvee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__bb, t1_xvae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,iQxa,ix->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,iQxa,ix->RPQ', Y_KC__bb, t1_vxae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,xa,Qx->RPQ', Y_KC__bb, t1_ae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += einsum('Ria,Qiab,Pb->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qiba,Pb->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qixa,Px->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += einsum('Ria,iQxa,Px->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,Qxay,xy->RPQ', Y_KC__bb, t2_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qxya,xy->RPQ', Y_KC__bb, t2_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__bb, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/2 * einsum('RPa,Qxab,yb,xy->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/2 * einsum('RPa,Qxab,yzwb,xwzy->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/4 * einsum('RPa,Qxba,yb,xy->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/4 * einsum('RPa,Qxba,yzwb,xwzy->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,xa,Qyxz,yz->RPQ', Y_KC__bb, t1_ae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,xa,Qyzx,yz->RPQ', Y_KC__bb, t1_ae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,xyza,Qwux,zuwy->RPQ', Y_KC__bb, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,xyza,Qwuy,zuxw->RPQ', Y_KC__bb, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,xyza,Qwxu,zuyw->RPQ', Y_KC__bb, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,xyza,Qwxy,zw->RPQ', Y_KC__bb, t1_aaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,xyza,Qwyu,zuxw->RPQ', Y_KC__bb, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,xyza,Qwyx,zw->RPQ', Y_KC__bb, t1_aaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/4 * einsum('RPa,xyza,Qx,zy->RPQ', Y_KC__bb, t1_aaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('RPa,xyza,Qy,zx->RPQ', Y_KC__bb, t1_aaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/4 * einsum('RPa,xyza,Qzwu,yxwu->RPQ', Y_KC__bb, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += einsum('Ria,Qiab,Pxby,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/2 * einsum('Ria,Qiab,Pxyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += 1/2 * einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] += einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_c:f_c] -= 1/2 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)

TY[:, s_v:f_v, s_v:f_v]  = einsum('Ria,Qiab,Pb->RPQ', Y_KC__aa, t1_vxee, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= einsum('Ria,Qiba,Pb->RPQ', Y_KC__aa, t1_vxee, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= einsum('Ria,Qixa,Px->RPQ', Y_KC__aa, t1_vxae, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += einsum('Ria,iQxa,Px->RPQ', Y_KC__aa, t1_xvae, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= einsum('Ria,Qiba,Pb->RPQ', Y_KC__bb, t1_vxee, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= einsum('Ria,Qixa,Px->RPQ', Y_KC__bb, t1_vxae, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += einsum('Ria,Qiab,Pxby,xy->RPQ', Y_KC__aa, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= 1/2 * einsum('Ria,Qiab,Pxyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__aa, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__aa, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= 1/2 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__bb, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)

TY[:, s_v:f_v, s_v:f_v] =- einsum('Ria,Qiba,Pb->RPQ', Y_KC__aa, t1_vxee, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= einsum('Ria,Qixa,Px->RPQ', Y_KC__aa, t1_vxae, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += einsum('Ria,Qiab,Pb->RPQ', Y_KC__bb, t1_vxee, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= einsum('Ria,Qiba,Pb->RPQ', Y_KC__bb, t1_vxee, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= einsum('Ria,Qixa,Px->RPQ', Y_KC__bb, t1_vxae, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += einsum('Ria,iQxa,Px->RPQ', Y_KC__bb, t1_xvae, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__aa, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += einsum('Ria,Qiab,Pxby,xy->RPQ', Y_KC__bb, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= 1/2 * einsum('Ria,Qiab,Pxyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__bb, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__bb, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] += einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_v:f_v] -= 1/2 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)

TY[:, s_a:f_a, s_a:f_a] =- einsum('Ria,iP,Qa->RPQ', Y_KC__aa, t1_xa, t1_ae, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__aa, t1_xvae, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_vxae, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Px->RPQ', Y_KC__aa, t2_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,iQxa,Px->RPQ', Y_KC__aa, t2_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,ixPa,Qx->RPQ', Y_KC__aa, t2_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ixaP,Qx->RPQ', Y_KC__aa, t2_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_vxae, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Px->RPQ', Y_KC__bb, t2_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ixaP,Qx->RPQ', Y_KC__bb, t2_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,iP,Qxya,xy->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,iP,xQya,xy->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,iQab,xb,Px->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,iQab,xyzb,Pzyx->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQba,xb,Px->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQba,xyzb,Pzyx->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQxy,xa,Py->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,iQxy,xyza,Pz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,iQxy,xzwa,Pzwy->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,iQxy,xzwa,Pzyw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,iQxy,ya,Px->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQxy,yxza,Pz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,iQxy,yzwa,Pzwx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,iQxy,yzwa,Pzxw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,iQxy,zwPa,yxwz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,iQxy,zwPa,yxzw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQxy,zxwa,Pzyw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,iQxy,zywa,Pzxw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijPa,jx,Qx->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijPa,jxyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPbx,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijba,jPbx,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jPxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,jPyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ijxa,jPyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,jPyz,Qxzy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijPa,jx,Qx->RPQ', Y_KC__aa, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijPa,jxyz,Qxyz->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPbx,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijba,jPbx,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jPxy,Qy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,jPyx,Qy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ijxa,jPyz,Qxyz->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,jPyz,Qxzy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__aa, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ix,Qxya,Py->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ix,xQya,Py->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ix,xyPa,Qy->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ix,yxPa,Qy->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,ixPy,Qa,yx->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ixPy,Qyza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ixPy,Qzwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,ixPy,yQza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixPy,ya,Qx->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixPy,yzwa,Qwzx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,ixPy,zQwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixPy,zwxa,Qywz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixPy,zywa,Qwxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixab,yPzb,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixab,yzQb,Pxyz->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixba,Pb,Qx->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixba,Pyzb,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixba,yPzb,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixba,yzQb,Pxyz->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixba,yzQb,Pxzy->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ixyP,Qa,yx->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,ixyP,Qyza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ixyP,Qzwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,ixyP,Qzwa,ywzx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ixyP,yQza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyP,ya,Qx->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyP,yzwa,Qwxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyP,yzwa,Qwzx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ixyP,zQwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyP,zwxa,Qywz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyP,zwxa,Qyzw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyP,zywa,Qwxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Qwxa,Pwyz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Qwxa,Pwzy->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Qywa,Pxwz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Qzwa,Pxwy->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Qzwa,Pxyw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,wQxa,Pwyz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixyz,wyPa,Qzwx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,wzPa,Qywx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyz,wzPa,Qyxw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixyz,yQwa,Pxwz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,ywPa,Qzwx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,yzPa,Qx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixyz,zQwa,Pxyw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyz,zwPa,Qywx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,zwPa,Qyxw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixyz,zyPa,Qx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jx,Qx->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jxyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jixa,jPxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyz,Qxzy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jx,Qx->RPQ', Y_KC__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jxyz,Qxyz->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jixa,jPxy,Qy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyx,Qy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyz,Qxzy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,iQab,xb,Px->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,iQab,xyzb,Pzyx->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQxy,xa,Py->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,iQxy,xzwa,Pzwy->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,iQxy,xzwa,Pzyw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQxy,yxza,Pz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,iQxy,yzwa,Pzwx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,iQxy,yzwa,Pzxw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,iQxy,zwPa,yxwz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/3 * einsum('Ria,iQxy,zwPa,yxzw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQxy,zxwa,Pzyw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPbx,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijba,jPbx,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jPxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,jPyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ijxa,jPyz,Qxzy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPbx,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijba,jPbx,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jPxy,Qy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,jPyz,Qxyz->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ijxa,jPyz,Qxzy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ix,Qxya,Py->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ix,yxPa,Qy->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixab,yPzb,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixab,yzQb,Pxyz->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixba,Pyzb,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ixba,yzQb,Pxyz->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixba,yzQb,Pxzy->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,ixyP,Qyza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,ixyP,Qzwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/3 * einsum('Ria,ixyP,Qzwa,ywzx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyP,ya,Qx->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,ixyP,yzwa,Qwxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyP,yzwa,Qwzx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyP,zwxa,Qywz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ixyP,zwxa,Qyzw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyP,zywa,Qwxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Qwxa,Pwyz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ixyz,Qwxa,Pwzy->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Qywa,Pxwz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,ixyz,Qzwa,Pxwy->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Qzwa,Pxyw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixyz,wyPa,Qzwx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ixyz,wzPa,Qywx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,wzPa,Qyxw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,zwPa,Qywx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ixyz,zwPa,Qyxw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixyz,zyPa,Qx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jx,Qx->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jxyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jixa,jPxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyz,Qxzy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jx,Qx->RPQ', Y_KC__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jxyz,Qxyz->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jixa,jPxy,Qy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyx,Qy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyz,Qxzy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)

TY[:, s_a:f_a, s_a:f_a]  = einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_vxae, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Px->RPQ', Y_KC__aa, t2_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ixaP,Qx->RPQ', Y_KC__aa, t2_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,iP,Qa->RPQ', Y_KC__bb, t1_xa, t1_ae, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__bb, t1_xvae, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_vxae, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Px->RPQ', Y_KC__bb, t2_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,iQxa,Px->RPQ', Y_KC__bb, t2_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,ixPa,Qx->RPQ', Y_KC__bb, t2_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ixaP,Qx->RPQ', Y_KC__bb, t2_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,iQab,xb,Px->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,iQab,xyzb,Pzyx->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQxy,xa,Py->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,iQxy,xzwa,Pzwy->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,iQxy,xzwa,Pzyw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQxy,yxza,Pz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,iQxy,yzwa,Pzwx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,iQxy,yzwa,Pzxw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,iQxy,zwPa,yxwz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/3 * einsum('Ria,iQxy,zwPa,yxzw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQxy,zxwa,Pzyw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPbx,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijba,jPbx,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jPxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,jPyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ijxa,jPyz,Qxzy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPbx,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijba,jPbx,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jPxy,Qy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,jPyz,Qxyz->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ijxa,jPyz,Qxzy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ix,Qxya,Py->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ix,yxPa,Qy->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixab,yPzb,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixab,yzQb,Pxyz->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixba,Pyzb,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ixba,yzQb,Pxyz->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixba,yzQb,Pxzy->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,ixyP,Qyza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,ixyP,Qzwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/3 * einsum('Ria,ixyP,Qzwa,ywzx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyP,ya,Qx->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,ixyP,yzwa,Qwxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyP,yzwa,Qwzx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyP,zwxa,Qywz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ixyP,zwxa,Qyzw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyP,zywa,Qwxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Qwxa,Pwyz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ixyz,Qwxa,Pwzy->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Qywa,Pxwz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,ixyz,Qzwa,Pxwy->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Qzwa,Pxyw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixyz,wyPa,Qzwx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ixyz,wzPa,Qywx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,wzPa,Qyxw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,zwPa,Qywx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ixyz,zwPa,Qyxw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixyz,zyPa,Qx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jx,Qx->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jxyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jixa,jPxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyz,Qxzy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jx,Qx->RPQ', Y_KC__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jxyz,Qxyz->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jixa,jPxy,Qy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyx,Qy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyz,Qxzy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,iP,Qxya,xy->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,iP,xQya,xy->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,iQab,xb,Px->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,iQab,xyzb,Pzyx->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQba,xb,Px->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQba,xyzb,Pzyx->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQxy,xa,Py->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,iQxy,xyza,Pz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,iQxy,xzwa,Pzwy->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,iQxy,xzwa,Pzyw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,iQxy,ya,Px->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQxy,yxza,Pz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,iQxy,yzwa,Pzwx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,iQxy,yzwa,Pzxw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,iQxy,zwPa,yxwz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,iQxy,zwPa,yxzw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,iQxy,zxwa,Pzyw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,iQxy,zywa,Pzxw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijPa,jx,Qx->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijPa,jxyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPbx,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijba,jPbx,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jPxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,jPyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ijxa,jPyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,jPyz,Qxzy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijPa,jx,Qx->RPQ', Y_KC__bb, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijPa,jxyz,Qxyz->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPbx,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijba,jPbx,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jPxy,Qy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,jPyx,Qy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ijxa,jPyz,Qxyz->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,jPyz,Qxzy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__bb, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ix,Qxya,Py->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ix,xQya,Py->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ix,xyPa,Qy->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ix,yxPa,Qy->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,ixPy,Qa,yx->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ixPy,Qyza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ixPy,Qzwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,ixPy,yQza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixPy,ya,Qx->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixPy,yzwa,Qwzx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= einsum('Ria,ixPy,zQwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixPy,zwxa,Qywz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixPy,zywa,Qwxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixab,yPzb,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixab,yzQb,Pxyz->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixba,Pb,Qx->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixba,Pyzb,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixba,yPzb,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixba,yzQb,Pxyz->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixba,yzQb,Pxzy->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ixyP,Qa,yx->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,ixyP,Qyza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/6 * einsum('Ria,ixyP,Qzwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/6 * einsum('Ria,ixyP,Qzwa,ywzx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ixyP,yQza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyP,ya,Qx->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyP,yzwa,Qwxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyP,yzwa,Qwzx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,ixyP,zQwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyP,zwxa,Qywz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyP,zwxa,Qyzw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyP,zywa,Qwxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Qwxa,Pwyz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Qwxa,Pwzy->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Qywa,Pxwz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Qzwa,Pxwy->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Qzwa,Pxyw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,wQxa,Pwyz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixyz,wyPa,Qzwx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,wzPa,Qywx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyz,wzPa,Qyxw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixyz,yQwa,Pxwz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,ywPa,Qzwx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,yzPa,Qx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixyz,zQwa,Pxyw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/12 * einsum('Ria,ixyz,zwPa,Qywx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,zwPa,Qyxw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,ixyz,zyPa,Qx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jx,Qx->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jxyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jixa,jPxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyz,Qxzy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jx,Qx->RPQ', Y_KC__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jiPa,jxyz,Qxyz->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/2 * einsum('Ria,jixa,jPxy,Qy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyx,Qy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/4 * einsum('Ria,jixa,jPyz,Qxzy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_a:f_a] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)

TY[:, s_e:f_e, s_e:f_e]  = einsum('RiQ,iP->RPQ', Y_KC__aa, t2_xe, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,ijPa,ja->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,ijxP,jx->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,ijPa,ja->RPQ', Y_KC__aa, t1_xvee, t1_ve, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,ijxP,jx->RPQ', Y_KC__aa, t1_xvae, t1_va, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('RiQ,ix,xP->RPQ', Y_KC__aa, t1_xa, t1_ae, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,jixP,jx->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__aa, t1_vxee, t1_ve, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,jixP,jx->RPQ', Y_KC__aa, t1_vxae, t1_va, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__aa, t1_xvee, t1_ve, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_vxee, t1_ve, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,ixPy,yx->RPQ', Y_KC__aa, t2_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,ixyP,yx->RPQ', Y_KC__aa, t2_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_vxee, t1_ve, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,ijxP,jy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,ijxP,jyxz,zy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,ijxP,jyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,ijxP,jyzx,zy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,ijxP,jy,xy->RPQ', Y_KC__aa, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,ijxP,jyxz,zy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,ijxP,jyzw,xyzw->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,ijxP,jyzx,zy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ix,xyzP,zy->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('RiQ,ix,yxzP,zy->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('RiQ,ixPa,ya,xy->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('RiQ,ixPa,yzwa,xwzy->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ixaP,ya,xy->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ixaP,yzwa,xwzy->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,wuxP,yzuw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('RiQ,ixyz,wyuP,xwzu->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ixyz,wzuP,xwyu->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('RiQ,ixyz,yP,xz->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ixyz,ywuP,xwzu->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ixyz,yzwP,xw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ixyz,zP,xy->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ixyz,zwuP,xwuy->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('RiQ,ixyz,zywP,xw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jixP,jy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,jixP,jyxz,zy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jixP,jyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jixP,jyzx,zy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jixP,jy,xy->RPQ', Y_KC__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,jixP,jyxz,zy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jixP,jyzw,xyzw->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jixP,jyzx,zy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('Ria,ixPa,yQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('Ria,ixPa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)

TY[:, s_e:f_e, s_e:f_e]  = einsum('RiQ,iP->RPQ', Y_KC__bb, t2_xe, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_vxee, t1_ve, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,ijPa,ja->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,ijxP,jx->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,ijPa,ja->RPQ', Y_KC__bb, t1_xvee, t1_ve, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,ijxP,jx->RPQ', Y_KC__bb, t1_xvae, t1_va, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('RiQ,ix,xP->RPQ', Y_KC__bb, t1_xa, t1_ae, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,jixP,jx->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__bb, t1_vxee, t1_ve, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,jixP,jx->RPQ', Y_KC__bb, t1_vxae, t1_va, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__bb, t1_xvee, t1_ve, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_vxee, t1_ve, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,ixPy,yx->RPQ', Y_KC__bb, t2_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,ixyP,yx->RPQ', Y_KC__bb, t2_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,ijxP,jy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,ijxP,jyxz,zy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,ijxP,jyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,ijxP,jyzx,zy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,ijxP,jy,xy->RPQ', Y_KC__bb, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,ijxP,jyxz,zy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,ijxP,jyzw,xyzw->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,ijxP,jyzx,zy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ix,xyzP,zy->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('RiQ,ix,yxzP,zy->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('RiQ,ixPa,ya,xy->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('RiQ,ixPa,yzwa,xwzy->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ixaP,ya,xy->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ixaP,yzwa,xwzy->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,wuxP,yzuw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('RiQ,ixyz,wyuP,xwzu->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ixyz,wzuP,xwyu->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('RiQ,ixyz,yP,xz->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ixyz,ywuP,xwzu->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ixyz,yzwP,xw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ixyz,zP,xy->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/4 * einsum('RiQ,ixyz,zwuP,xwuy->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('RiQ,ixyz,zywP,xw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jixP,jy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,jixP,jyxz,zy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jixP,jyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jixP,jyzx,zy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jixP,jy,xy->RPQ', Y_KC__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('RiQ,jixP,jyxz,zy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jixP,jyzw,xyzw->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('RiQ,jixP,jyzx,zy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('Ria,ixPa,yQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('Ria,ixPa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_e:f_e, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)

TY[:, s_c:f_c, s_v:f_v] =- einsum('RPa,Qa->RPQ', Y_KC__aa, t2_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,Qiab,ib->RPQ', Y_KC__aa, t1_vxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__aa, t1_vxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__aa, t1_vxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,Qiab,ib->RPQ', Y_KC__aa, t1_vvee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__aa, t1_vvee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__aa, t1_vvae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,iQxa,ix->RPQ', Y_KC__aa, t1_xvae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,iQxa,ix->RPQ', Y_KC__aa, t1_vvae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,xa,Qx->RPQ', Y_KC__aa, t1_ae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += einsum('Ria,Qiab,Pb->RPQ', Y_KC__aa, t1_vxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qiba,Pb->RPQ', Y_KC__aa, t1_vxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qixa,Px->RPQ', Y_KC__aa, t1_vxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += einsum('Ria,iQxa,Px->RPQ', Y_KC__aa, t1_xvae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,Qxay,xy->RPQ', Y_KC__aa, t2_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qxya,xy->RPQ', Y_KC__aa, t2_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qiba,Pb->RPQ', Y_KC__bb, t1_vxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qixa,Px->RPQ', Y_KC__bb, t1_vxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__aa, t1_vxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__aa, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__aa, t1_vxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__aa, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__aa, t1_vvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__aa, t1_vvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__aa, t1_vvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__aa, t1_vvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__aa, t1_vvae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__aa, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__aa, t1_vvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__aa, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('RPa,Qxab,yb,xy->RPQ', Y_KC__aa, t1_vaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('RPa,Qxab,yzwb,xwzy->RPQ', Y_KC__aa, t1_vaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/4 * einsum('RPa,Qxba,yb,xy->RPQ', Y_KC__aa, t1_vaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/4 * einsum('RPa,Qxba,yzwb,xwzy->RPQ', Y_KC__aa, t1_vaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__aa, t1_xvae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__aa, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__aa, t1_xvae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__aa, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__aa, t1_vvae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__aa, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__aa, t1_vvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__aa, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,xa,Qyxz,yz->RPQ', Y_KC__aa, t1_ae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,xa,Qyzx,yz->RPQ', Y_KC__aa, t1_ae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,xyza,Qwux,zuwy->RPQ', Y_KC__aa, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,xyza,Qwuy,zuxw->RPQ', Y_KC__aa, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,xyza,Qwxu,zuyw->RPQ', Y_KC__aa, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,xyza,Qwxy,zw->RPQ', Y_KC__aa, t1_aaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,xyza,Qwyu,zuxw->RPQ', Y_KC__aa, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,xyza,Qwyx,zw->RPQ', Y_KC__aa, t1_aaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,xyza,Qx,zy->RPQ', Y_KC__aa, t1_aaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,xyza,Qy,zx->RPQ', Y_KC__aa, t1_aaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/4 * einsum('RPa,xyza,Qzwu,yxwu->RPQ', Y_KC__aa, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += einsum('Ria,Qiab,Pxby,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,Qiab,Pxyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__aa, t1_vxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__aa, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_vxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__aa, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__aa, t1_xvae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__aa, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xvae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__aa, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__bb, t1_vxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__bb, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_vxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__bb, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)

TY[:, s_c:f_c, s_v:f_v]  = einsum('Ria,Piab,Qb->RPQ', Y_KC__aa, t1_xxee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Piba,Qb->RPQ', Y_KC__aa, t1_xxee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Pixa,Qx->RPQ', Y_KC__aa, t1_xxae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += einsum('Ria,iPxa,Qx->RPQ', Y_KC__aa, t1_xxae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Piba,Qb->RPQ', Y_KC__bb, t1_xxee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Pixa,Qx->RPQ', Y_KC__bb, t1_xxae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += einsum('Ria,Piab,Qxby,xy->RPQ', Y_KC__aa, t1_xxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,Piab,Qxyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Piba,Qxby,xy->RPQ', Y_KC__aa, t1_xxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Pixa,Qy,xy->RPQ', Y_KC__aa, t1_xxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Pixa,Qyxz,yz->RPQ', Y_KC__aa, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Pixa,Qyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Pixa,Qyzx,yz->RPQ', Y_KC__aa, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,iPxa,Qy,xy->RPQ', Y_KC__aa, t1_xxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += einsum('Ria,iPxa,Qyxz,yz->RPQ', Y_KC__aa, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,iPxa,Qyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,iPxa,Qyzx,yz->RPQ', Y_KC__aa, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Piba,Qxby,xy->RPQ', Y_KC__bb, t1_xxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Pixa,Qy,xy->RPQ', Y_KC__bb, t1_xxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Pixa,Qyxz,yz->RPQ', Y_KC__bb, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Pixa,Qyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Pixa,Qyzx,yz->RPQ', Y_KC__bb, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)

TY[:, s_c:f_c, s_v:f_v] =- einsum('RPa,Qa->RPQ', Y_KC__bb, t2_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qiba,Pb->RPQ', Y_KC__aa, t1_vxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qixa,Px->RPQ', Y_KC__aa, t1_vxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,Qiab,ib->RPQ', Y_KC__bb, t1_vxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__bb, t1_vxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__bb, t1_vxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,Qiab,ib->RPQ', Y_KC__bb, t1_vvee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__bb, t1_vvee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__bb, t1_vvae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,iQxa,ix->RPQ', Y_KC__bb, t1_xvae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,iQxa,ix->RPQ', Y_KC__bb, t1_vvae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,xa,Qx->RPQ', Y_KC__bb, t1_ae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += einsum('Ria,Qiab,Pb->RPQ', Y_KC__bb, t1_vxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qiba,Pb->RPQ', Y_KC__bb, t1_vxee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qixa,Px->RPQ', Y_KC__bb, t1_vxae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += einsum('Ria,iQxa,Px->RPQ', Y_KC__bb, t1_xvae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,Qxay,xy->RPQ', Y_KC__bb, t2_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qxya,xy->RPQ', Y_KC__bb, t2_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__aa, t1_vxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__aa, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_vxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__aa, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__bb, t1_vxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__bb, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__bb, t1_vxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__bb, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__bb, t1_vvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__bb, t1_vvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__bb, t1_vvee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__bb, t1_vvee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__bb, t1_vvae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__bb, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__bb, t1_vvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__bb, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('RPa,Qxab,yb,xy->RPQ', Y_KC__bb, t1_vaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('RPa,Qxab,yzwb,xwzy->RPQ', Y_KC__bb, t1_vaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/4 * einsum('RPa,Qxba,yb,xy->RPQ', Y_KC__bb, t1_vaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/4 * einsum('RPa,Qxba,yzwb,xwzy->RPQ', Y_KC__bb, t1_vaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__bb, t1_xvae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__bb, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__bb, t1_xvae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__bb, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__bb, t1_vvae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__bb, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__bb, t1_vvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__bb, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,xa,Qyxz,yz->RPQ', Y_KC__bb, t1_ae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,xa,Qyzx,yz->RPQ', Y_KC__bb, t1_ae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,xyza,Qwux,zuwy->RPQ', Y_KC__bb, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,xyza,Qwuy,zuxw->RPQ', Y_KC__bb, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,xyza,Qwxu,zuyw->RPQ', Y_KC__bb, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,xyza,Qwxy,zw->RPQ', Y_KC__bb, t1_aaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,xyza,Qwyu,zuxw->RPQ', Y_KC__bb, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,xyza,Qwyx,zw->RPQ', Y_KC__bb, t1_aaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/4 * einsum('RPa,xyza,Qx,zy->RPQ', Y_KC__bb, t1_aaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('RPa,xyza,Qy,zx->RPQ', Y_KC__bb, t1_aaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/4 * einsum('RPa,xyza,Qzwu,yxwu->RPQ', Y_KC__bb, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += einsum('Ria,Qiab,Pxby,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,Qiab,Pxyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__bb, t1_vxae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__bb, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_vxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__bb, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__bb, t1_xvae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__bb, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xvae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__bb, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)

TY[:, s_c:f_c, s_v:f_v] =- einsum('Ria,Piba,Qb->RPQ', Y_KC__aa, t1_xxee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Pixa,Qx->RPQ', Y_KC__aa, t1_xxae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += einsum('Ria,Piab,Qb->RPQ', Y_KC__bb, t1_xxee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Piba,Qb->RPQ', Y_KC__bb, t1_xxee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Pixa,Qx->RPQ', Y_KC__bb, t1_xxae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += einsum('Ria,iPxa,Qx->RPQ', Y_KC__bb, t1_xxae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Piba,Qxby,xy->RPQ', Y_KC__aa, t1_xxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Pixa,Qy,xy->RPQ', Y_KC__aa, t1_xxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Pixa,Qyxz,yz->RPQ', Y_KC__aa, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Pixa,Qyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Pixa,Qyzx,yz->RPQ', Y_KC__aa, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += einsum('Ria,Piab,Qxby,xy->RPQ', Y_KC__bb, t1_xxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,Piab,Qxyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Piba,Qxby,xy->RPQ', Y_KC__bb, t1_xxee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Pixa,Qy,xy->RPQ', Y_KC__bb, t1_xxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= einsum('Ria,Pixa,Qyxz,yz->RPQ', Y_KC__bb, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Pixa,Qyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += 1/2 * einsum('Ria,Pixa,Qyzx,yz->RPQ', Y_KC__bb, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,iPxa,Qy,xy->RPQ', Y_KC__bb, t1_xxae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] += einsum('Ria,iPxa,Qyxz,yz->RPQ', Y_KC__bb, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,iPxa,Qyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_v:f_v] -= 1/2 * einsum('Ria,iPxa,Qyzx,yz->RPQ', Y_KC__bb, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)

TY[:, s_c:f_c, s_a:f_a] =- einsum('RPa,Qa->RPQ', Y_KC__aa, t2_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQab,ib->RPQ', Y_KC__aa, t1_xaee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQax,ix->RPQ', Y_KC__aa, t1_xaea, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQba,ib->RPQ', Y_KC__aa, t1_xaee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQxa,ix->RPQ', Y_KC__aa, t1_xaae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__aa, t1_xe, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_xvee, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_xvee, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__aa, t1_xvae, t1_vxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQab,ib->RPQ', Y_KC__aa, t1_vaee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQax,ix->RPQ', Y_KC__aa, t1_vaea, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQba,ib->RPQ', Y_KC__aa, t1_vaee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQxa,ix->RPQ', Y_KC__aa, t1_vaae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__aa, t1_ve, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_vxee, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_vxee, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__aa, t1_vxae, t1_vxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_vvee, t1_vvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_vvee, t1_vvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__aa, t1_vvae, t1_vvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__aa, t1_vvae, t1_vvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQab,Pb->RPQ', Y_KC__aa, t1_xaee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Px->RPQ', Y_KC__aa, t1_xaea, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQba,Pb->RPQ', Y_KC__aa, t1_xaee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQxa,Px->RPQ', Y_KC__aa, t1_xaae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__aa, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__aa, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__aa, t1_xvee, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__aa, t1_xvee, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,Qxya,xy->RPQ', Y_KC__aa, t2_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,xQya,xy->RPQ', Y_KC__aa, t2_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQab,Pb->RPQ', Y_KC__bb, t1_xaee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Px->RPQ', Y_KC__bb, t1_xaea, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__bb, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__bb, t1_xvee, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,Qxab,yb,xy->RPQ', Y_KC__aa, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,Qxab,yzwb,xwzy->RPQ', Y_KC__aa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,Qxba,yb,xy->RPQ', Y_KC__aa, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,Qxba,yzwb,xwzy->RPQ', Y_KC__aa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQab,ixby,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQab,ixyb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQax,iy,xy->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQax,iyxz,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQax,iyzw,xyzw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQax,iyzx,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQba,ixby,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQba,ixyb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__aa, t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__aa, t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__aa, t1_xvae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQab,ixby,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQab,ixyb,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQax,iy,xy->RPQ', Y_KC__aa, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQax,iyxz,yz->RPQ', Y_KC__aa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQax,iyzw,xyzw->RPQ', Y_KC__aa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQax,iyzx,yz->RPQ', Y_KC__aa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQba,ixby,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQba,ixyb,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__aa, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__aa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__aa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__aa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__aa, t1_ve, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__aa, t1_ve, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__aa, t1_vxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__aa, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__aa, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__aa, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__aa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__aa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__aa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__aa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__aa, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__aa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__aa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__aa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__aa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,xyab,zwQb,xyzw->RPQ', Y_KC__aa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQab,Pxby,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,iQab,Pxyb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQax,Py,xy->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Pyxz,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQax,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,iQax,Pyzx,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQba,Pxby,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,iQba,Pxyb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__aa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pybz,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pxzw,Qyzw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Py,Qx->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzwy,Qzwx->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzyw,Qzxw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixba,Pb,Qx->RPQ', Y_KC__aa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixba,Pybz,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixba,Pyzb,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pxzw,Qywz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pxzw,Qyzw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,Py,Qx->RPQ', Y_KC__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pzwy,Qzwx->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pzwy,Qzxw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,Pzyw,Qzxw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQab,Pxby,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,iQab,Pxyb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQax,Py,xy->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Pyxz,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQax,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,iQax,Pyzx,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__bb, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pybz,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pxzw,Qyzw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Py,Qx->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzwy,Qzwx->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzyw,Qzxw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixba,Pyzb,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pxzw,Qywz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,ixya,Pxzw,Qyzw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,ixya,Pzwy,Qzwx->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pzwy,Qzxw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)

TY[:, s_c:f_c, s_a:f_a]  = einsum('Ria,PiQa->RPQ', Y_KC__aa, t2_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('Ria,iPQa->RPQ', Y_KC__aa, t2_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,PiQa->RPQ', Y_KC__bb, t2_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,xa->RPQ', Y_KC__aa, t1_xxaa, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,Piab,Qb->RPQ', Y_KC__aa, t1_xxee, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,Piba,Qb->RPQ', Y_KC__aa, t1_xxee, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__aa, t1_xxaa, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('Ria,iQ,Pa->RPQ', Y_KC__aa, t1_xa, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__aa, t1_xa, t1_xaae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__aa, t1_xa, t1_xaea, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__aa, t1_xaae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__aa, t1_xaea, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,Pixa,Qx->RPQ', Y_KC__aa, t2_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iPxa,Qx->RPQ', Y_KC__aa, t2_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,xa->RPQ', Y_KC__bb, t1_xxaa, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,Piba,Qb->RPQ', Y_KC__bb, t1_xxee, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__bb, t1_xa, t1_xaae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__bb, t1_xaea, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,Pixa,Qx->RPQ', Y_KC__bb, t2_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,PiQx,xyza,zy->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,yxza,zy->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Piab,Qxyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,Piab,xQyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Piab,xb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Piab,xyzb,Qzyx->RPQ', Y_KC__aa, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,Piba,xQyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xyzb,Qzyx->RPQ', Y_KC__aa, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,xa,Qy->RPQ', Y_KC__aa, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,xyza,Qz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,xzwa,Qzwy->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,Pixy,xzwa,Qzyw->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,ya,Qx->RPQ', Y_KC__aa, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,yxza,Qz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,Pixy,yzwa,Qzwx->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,yzwa,Qzxw->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,zxwa,Qzyw->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,zywa,Qzxw->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__aa, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__aa, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ix,Pxay,Qy->RPQ', Y_KC__aa, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ix,Pxya,Qy->RPQ', Y_KC__aa, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__aa, t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Px,Qy->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pyzw,Qxzw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzwx,Qzwy->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzxw,Qzyw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__aa, t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,Px,Qy->RPQ', Y_KC__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pyzw,Qxwz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pyzw,Qxzw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pzwx,Qzwy->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pzwx,Qzyw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,Pzxw,Qzyw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Pwax,Qwyz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Pwxa,Qwyz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Pwxa,Qwzy->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixyz,Pyaw,Qxwz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Pywa,Qxwz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixyz,Pzaw,Qxyw->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Pzwa,Qxwy->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Pzwa,Qxyw->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,PiQx,xyza,zy->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,yxza,zy->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,Piba,xQyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xyzb,Qzyx->RPQ', Y_KC__bb, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,xyza,Qz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,Pixy,xzwa,Qzwy->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,xzwa,Qzyw->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,ya,Qx->RPQ', Y_KC__bb, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,yzwa,Qzwx->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,Pixy,yzwa,Qzxw->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/3 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,zywa,Qzxw->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ix,Pxya,Qy->RPQ', Y_KC__bb, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Px,Qy->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pyzw,Qxzw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzwx,Qzwy->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzxw,Qzyw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/3 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pyzw,Qxwz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,ixya,Pyzw,Qxzw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,ixya,Pzwx,Qzwy->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pzwx,Qzyw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Pwxa,Qwyz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,ixyz,Pwxa,Qwzy->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Pywa,Qxwz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,ixyz,Pzwa,Qxwy->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Pzwa,Qxyw->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)

TY[:, s_c:f_c, s_a:f_a] =- einsum('RPa,Qa->RPQ', Y_KC__bb, t2_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQab,Pb->RPQ', Y_KC__aa, t1_xaee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Px->RPQ', Y_KC__aa, t1_xaea, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__aa, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__aa, t1_xvee, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQab,ib->RPQ', Y_KC__bb, t1_xaee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQax,ix->RPQ', Y_KC__bb, t1_xaea, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQba,ib->RPQ', Y_KC__bb, t1_xaee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQxa,ix->RPQ', Y_KC__bb, t1_xaae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__bb, t1_xe, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_xvee, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_xvee, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__bb, t1_xvae, t1_vxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQab,ib->RPQ', Y_KC__bb, t1_vaee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQax,ix->RPQ', Y_KC__bb, t1_vaea, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQba,ib->RPQ', Y_KC__bb, t1_vaee, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQxa,ix->RPQ', Y_KC__bb, t1_vaae, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__bb, t1_ve, t1_va, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_vxee, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_vxee, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__bb, t1_vxae, t1_vxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_vvee, t1_vvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_vvee, t1_vvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__bb, t1_vvae, t1_vvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__bb, t1_vvae, t1_vvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQab,Pb->RPQ', Y_KC__bb, t1_xaee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Px->RPQ', Y_KC__bb, t1_xaea, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQba,Pb->RPQ', Y_KC__bb, t1_xaee, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQxa,Px->RPQ', Y_KC__bb, t1_xaae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__bb, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__bb, t1_xxee, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__bb, t1_xvee, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__bb, t1_xvee, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,Qxya,xy->RPQ', Y_KC__bb, t2_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,xQya,xy->RPQ', Y_KC__bb, t2_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQab,Pxby,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,iQab,Pxyb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQax,Py,xy->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Pyxz,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQax,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,iQax,Pyzx,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__aa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pybz,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pxzw,Qyzw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Py,Qx->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzwy,Qzwx->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzyw,Qzxw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixba,Pyzb,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pxzw,Qywz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,ixya,Pxzw,Qyzw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,ixya,Pzwy,Qzwx->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pzwy,Qzxw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,Qxab,yb,xy->RPQ', Y_KC__bb, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,Qxab,yzwb,xwzy->RPQ', Y_KC__bb, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,Qxba,yb,xy->RPQ', Y_KC__bb, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,Qxba,yzwb,xwzy->RPQ', Y_KC__bb, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQab,ixby,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQab,ixyb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQax,iy,xy->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQax,iyxz,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQax,iyzw,xyzw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQax,iyzx,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQba,ixby,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQba,ixyb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__bb, t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__bb, t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__bb, t1_xvae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQab,ixby,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQab,ixyb,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQax,iy,xy->RPQ', Y_KC__bb, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQax,iyxz,yz->RPQ', Y_KC__bb, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQax,iyzw,xyzw->RPQ', Y_KC__bb, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,iQax,iyzx,yz->RPQ', Y_KC__bb, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQba,ixby,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQba,ixyb,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__bb, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__bb, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__bb, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__bb, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__bb, t1_ve, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__bb, t1_ve, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__bb, t1_vxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__bb, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__bb, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__bb, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__bb, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__bb, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__bb, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__bb, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__bb, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__bb, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__bb, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__bb, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__bb, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('RPa,xyab,zwQb,xyzw->RPQ', Y_KC__bb, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQab,Pxby,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,iQab,Pxyb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQax,Py,xy->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Pyxz,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQax,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,iQax,Pyzx,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQba,Pxby,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,iQba,Pxyb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__bb, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pybz,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pxzw,Qyzw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Py,Qx->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzwy,Qzwx->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzyw,Qzxw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixba,Pb,Qx->RPQ', Y_KC__bb, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixba,Pybz,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixba,Pyzb,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pxzw,Qywz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pxzw,Qyzw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,Py,Qx->RPQ', Y_KC__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pzwy,Qzwx->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pzwy,Qzxw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,Pzyw,Qzxw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)

TY[:, s_c:f_c, s_a:f_a]  = einsum('Ria,PiQa->RPQ', Y_KC__aa, t2_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += einsum('Ria,PiQa->RPQ', Y_KC__bb, t2_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('Ria,iPQa->RPQ', Y_KC__bb, t2_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,xa->RPQ', Y_KC__aa, t1_xxaa, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,Piba,Qb->RPQ', Y_KC__aa, t1_xxee, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__aa, t1_xa, t1_xaae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__aa, t1_xaea, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,Pixa,Qx->RPQ', Y_KC__aa, t2_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,xa->RPQ', Y_KC__bb, t1_xxaa, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,Piab,Qb->RPQ', Y_KC__bb, t1_xxee, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,Piba,Qb->RPQ', Y_KC__bb, t1_xxee, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__bb, t1_xxaa, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('Ria,iQ,Pa->RPQ', Y_KC__bb, t1_xa, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__bb, t1_xa, t1_xaae, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__bb, t1_xa, t1_xaea, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__bb, t1_xaae, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__bb, t1_xaea, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,Pixa,Qx->RPQ', Y_KC__bb, t2_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iPxa,Qx->RPQ', Y_KC__bb, t2_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,PiQx,xyza,zy->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,yxza,zy->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,Piba,xQyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xyzb,Qzyx->RPQ', Y_KC__aa, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,xyza,Qz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,Pixy,xzwa,Qzwy->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,xzwa,Qzyw->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,ya,Qx->RPQ', Y_KC__aa, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,yzwa,Qzwx->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,Pixy,yzwa,Qzxw->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/3 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,zywa,Qzxw->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ix,Pxya,Qy->RPQ', Y_KC__aa, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Px,Qy->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pyzw,Qxzw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzwx,Qzwy->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzxw,Qzyw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/3 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pyzw,Qxwz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,ixya,Pyzw,Qxzw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,ixya,Pzwx,Qzwy->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pzwx,Qzyw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Pwxa,Qwyz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,ixyz,Pwxa,Qwzy->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Pywa,Qxwz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,ixyz,Pzwa,Qxwy->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Pzwa,Qxyw->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,PiQx,xyza,zy->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,yxza,zy->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Piab,Qxyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,Piab,xQyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Piab,xb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Piab,xyzb,Qzyx->RPQ', Y_KC__bb, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,Piba,xQyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xyzb,Qzyx->RPQ', Y_KC__bb, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,xa,Qy->RPQ', Y_KC__bb, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,xyza,Qz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,xzwa,Qzwy->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,Pixy,xzwa,Qzyw->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,ya,Qx->RPQ', Y_KC__bb, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,yxza,Qz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,Pixy,yzwa,Qzwx->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,yzwa,Qzxw->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,zxwa,Qzyw->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,Pixy,zywa,Qzxw->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__bb, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__bb, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ix,Pxay,Qy->RPQ', Y_KC__bb, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ix,Pxya,Qy->RPQ', Y_KC__bb, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__bb, t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Px,Qy->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pyzw,Qxzw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzwx,Qzwy->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzxw,Qzyw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__bb, t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,Px,Qy->RPQ', Y_KC__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pyzw,Qxwz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pyzw,Qxzw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pzwx,Qzwy->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pzwx,Qzyw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixya,Pzxw,Qzyw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Pwax,Qwyz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Pwxa,Qwyz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Pwxa,Qwzy->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixyz,Pyaw,Qxwz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Pywa,Qxwz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/4 * einsum('Ria,ixyz,Pzaw,Qxyw->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Pzwa,Qxwy->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Pzwa,Qxyw->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)

TY[:, s_v:f_v, s_a:f_a] =- 1/2 * einsum('Ria,iQab,Pb->RPQ', Y_KC__aa, t1_xaee, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Px->RPQ', Y_KC__aa, t1_xaea, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQba,Pb->RPQ', Y_KC__aa, t1_xaee, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQxa,Px->RPQ', Y_KC__aa, t1_xaae, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__aa, t1_xxee, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__aa, t1_xxee, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__aa, t1_xvee, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__aa, t1_xvee, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQab,Pb->RPQ', Y_KC__bb, t1_xaee, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Px->RPQ', Y_KC__bb, t1_xaea, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__bb, t1_xxee, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__bb, t1_xvee, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQab,Pxby,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,iQab,Pxyb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQax,Py,xy->RPQ', Y_KC__aa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Pyxz,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQax,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,iQax,Pyzx,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQba,Pxby,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,iQba,Pxyb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__aa, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__aa, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pybz,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pxzw,Qyzw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Py,Qx->RPQ', Y_KC__aa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzwy,Qzwx->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzyw,Qzxw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixba,Pb,Qx->RPQ', Y_KC__aa, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixba,Pybz,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixba,Pyzb,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pxzw,Qywz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pxzw,Qyzw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,Py,Qx->RPQ', Y_KC__aa, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pzwy,Qzwx->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pzwy,Qzxw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,Pzyw,Qzxw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQab,Pxby,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,iQab,Pxyb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQax,Py,xy->RPQ', Y_KC__bb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Pyxz,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQax,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,iQax,Pyzx,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__bb, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pybz,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pxzw,Qyzw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Py,Qx->RPQ', Y_KC__bb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzwy,Qzwx->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzyw,Qzxw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixba,Pyzb,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pxzw,Qywz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,ixya,Pxzw,Qyzw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,ixya,Pzwy,Qzwx->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pzwy,Qzxw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, rdm_ccaa, optimize = einsum_type)

TY[:, s_v:f_v, s_a:f_a]  = einsum('Ria,PiQa->RPQ', Y_KC__aa, t2_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= einsum('Ria,iPQa->RPQ', Y_KC__aa, t2_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,PiQa->RPQ', Y_KC__bb, t2_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,xa->RPQ', Y_KC__aa, t1_vxaa, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,Piab,Qb->RPQ', Y_KC__aa, t1_vxee, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,Piba,Qb->RPQ', Y_KC__aa, t1_vxee, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__aa, t1_vxaa, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= einsum('Ria,iQ,Pa->RPQ', Y_KC__aa, t1_xa, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__aa, t1_xa, t1_vaae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__aa, t1_xa, t1_vaea, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__aa, t1_xaae, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__aa, t1_xaea, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,Pixa,Qx->RPQ', Y_KC__aa, t2_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iPxa,Qx->RPQ', Y_KC__aa, t2_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,xa->RPQ', Y_KC__bb, t1_vxaa, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,Piba,Qb->RPQ', Y_KC__bb, t1_vxee, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__bb, t1_xa, t1_vaae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__bb, t1_xaea, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,Pixa,Qx->RPQ', Y_KC__bb, t2_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,PiQx,xyza,zy->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,yxza,zy->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Piab,Qxyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,Piab,xQyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Piab,xb,Qx->RPQ', Y_KC__aa, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Piab,xyzb,Qzyx->RPQ', Y_KC__aa, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,Piba,xQyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xb,Qx->RPQ', Y_KC__aa, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xyzb,Qzyx->RPQ', Y_KC__aa, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,xa,Qy->RPQ', Y_KC__aa, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,xyza,Qz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,xzwa,Qzwy->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,Pixy,xzwa,Qzyw->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,ya,Qx->RPQ', Y_KC__aa, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,yxza,Qz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,Pixy,yzwa,Qzwx->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,yzwa,Qzxw->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,zxwa,Qzyw->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,zywa,Qzxw->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__aa, t1_xa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__aa, t1_xa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ix,Pxay,Qy->RPQ', Y_KC__aa, t1_xa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ix,Pxya,Qy->RPQ', Y_KC__aa, t1_xa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__aa, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__aa, t1_xaaa, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__aa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Px,Qy->RPQ', Y_KC__aa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pyzw,Qxzw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzwx,Qzwy->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzxw,Qzyw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__aa, t1_xaaa, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,Px,Qy->RPQ', Y_KC__aa, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pyzw,Qxwz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pyzw,Qxzw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pzwx,Qzwy->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pzwx,Qzyw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,Pzxw,Qzyw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Pwax,Qwyz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Pwxa,Qwyz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Pwxa,Qwzy->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixyz,Pyaw,Qxwz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Pywa,Qxwz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixyz,Pzaw,Qxyw->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Pzwa,Qxwy->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Pzwa,Qxyw->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,PiQx,xyza,zy->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,yxza,zy->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,Piba,xQyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xb,Qx->RPQ', Y_KC__bb, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xyzb,Qzyx->RPQ', Y_KC__bb, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,xyza,Qz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,Pixy,xzwa,Qzwy->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,xzwa,Qzyw->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,ya,Qx->RPQ', Y_KC__bb, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,yzwa,Qzwx->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,Pixy,yzwa,Qzxw->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/3 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,zywa,Qzxw->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ix,Pxya,Qy->RPQ', Y_KC__bb, t1_xa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__bb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Px,Qy->RPQ', Y_KC__bb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pyzw,Qxzw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzwx,Qzwy->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzxw,Qzyw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/3 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pyzw,Qxwz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,ixya,Pyzw,Qxzw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,ixya,Pzwx,Qzwy->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pzwx,Qzyw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Pwxa,Qwyz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,ixyz,Pwxa,Qwzy->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Pywa,Qxwz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,ixyz,Pzwa,Qxwy->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Pzwa,Qxyw->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)

TY[:, s_v:f_v, s_a:f_a] =- 1/2 * einsum('Ria,iQab,Pb->RPQ', Y_KC__aa, t1_xaee, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Px->RPQ', Y_KC__aa, t1_xaea, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__aa, t1_xxee, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__aa, t1_xvee, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQab,Pb->RPQ', Y_KC__bb, t1_xaee, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Px->RPQ', Y_KC__bb, t1_xaea, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQba,Pb->RPQ', Y_KC__bb, t1_xaee, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQxa,Px->RPQ', Y_KC__bb, t1_xaae, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__bb, t1_xxee, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__bb, t1_xxee, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,jPQb->RPQ', Y_KC__bb, t1_xvee, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__bb, t1_xvee, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijxa,PjQx->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,jixa,PjQx->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQab,Pxby,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,iQab,Pxyb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQax,Py,xy->RPQ', Y_KC__aa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Pyxz,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQax,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,iQax,Pyzx,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__aa, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pybz,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pxzw,Qyzw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Py,Qx->RPQ', Y_KC__aa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzwy,Qzwx->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzyw,Qzxw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixba,Pyzb,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pxzw,Qywz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,ixya,Pxzw,Qyzw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,ixya,Pzwy,Qzwx->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pzwy,Qzxw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQab,Pxby,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,iQab,Pxyb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQax,Py,xy->RPQ', Y_KC__bb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQax,Pyxz,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQax,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,iQax,Pyzx,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQba,Pxby,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,iQba,Pxyb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__bb, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ijxa,Pjyz,Qxzy->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__bb, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pybz,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pxzw,Qyzw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Py,Qx->RPQ', Y_KC__bb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzwy,Qzwx->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pzyw,Qzxw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixba,Pb,Qx->RPQ', Y_KC__bb, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixba,Pybz,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixba,Pyzb,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pxzw,Qywz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pxzw,Qyzw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,Py,Qx->RPQ', Y_KC__bb, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pzwy,Qzwx->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pzwy,Qzxw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,Pzyw,Qzxw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, rdm_ccaa, optimize = einsum_type)

TY[:, s_v:f_v, s_a:f_a]  = einsum('Ria,PiQa->RPQ', Y_KC__aa, t2_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += einsum('Ria,PiQa->RPQ', Y_KC__bb, t2_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= einsum('Ria,iPQa->RPQ', Y_KC__bb, t2_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,xa->RPQ', Y_KC__aa, t1_vxaa, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,Piba,Qb->RPQ', Y_KC__aa, t1_vxee, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__aa, t1_xa, t1_vaae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__aa, t1_xaea, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,Pixa,Qx->RPQ', Y_KC__aa, t2_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,xa->RPQ', Y_KC__bb, t1_vxaa, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,Piab,Qb->RPQ', Y_KC__bb, t1_vxee, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,Piba,Qb->RPQ', Y_KC__bb, t1_vxee, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__bb, t1_vxaa, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= einsum('Ria,iQ,Pa->RPQ', Y_KC__bb, t1_xa, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__bb, t1_xa, t1_vaae, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__bb, t1_xa, t1_vaea, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__bb, t1_xaae, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__bb, t1_xaea, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,Pixa,Qx->RPQ', Y_KC__bb, t2_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iPxa,Qx->RPQ', Y_KC__bb, t2_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,PiQx,xyza,zy->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,yxza,zy->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,Piba,xQyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xb,Qx->RPQ', Y_KC__aa, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xyzb,Qzyx->RPQ', Y_KC__aa, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,xyza,Qz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,Pixy,xzwa,Qzwy->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,xzwa,Qzyw->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,ya,Qx->RPQ', Y_KC__aa, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,yzwa,Qzwx->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,Pixy,yzwa,Qzxw->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/3 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,zywa,Qzxw->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ix,Pxya,Qy->RPQ', Y_KC__aa, t1_xa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__aa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Px,Qy->RPQ', Y_KC__aa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pyzw,Qxzw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzwx,Qzwy->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzxw,Qzyw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/3 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pyzw,Qxwz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,ixya,Pyzw,Qxzw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,ixya,Pzwx,Qzwy->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pzwx,Qzyw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Pwxa,Qwyz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,ixyz,Pwxa,Qwzy->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Pywa,Qxwz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,ixyz,Pzwa,Qxwy->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Pzwa,Qxyw->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,PiQx,xyza,zy->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,PiQx,yxza,zy->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Piab,Qxyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,Piab,xQyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Piab,xb,Qx->RPQ', Y_KC__bb, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Piab,xyzb,Qzyx->RPQ', Y_KC__bb, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,Piba,xQyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xb,Qx->RPQ', Y_KC__bb, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Piba,xyzb,Qzyx->RPQ', Y_KC__bb, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,xa,Qy->RPQ', Y_KC__bb, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,xyza,Qz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,xzwa,Qzwy->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,Pixy,xzwa,Qzyw->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,ya,Qx->RPQ', Y_KC__bb, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,yxza,Qz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,Pixy,yzwa,Qzwx->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,Pixy,yzwa,Qzxw->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,zxwa,Qzyw->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,Pixy,zywa,Qzxw->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__bb, t1_xa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__bb, t1_xa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ix,Pxay,Qy->RPQ', Y_KC__bb, t1_xa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ix,Pxya,Qy->RPQ', Y_KC__bb, t1_xa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__bb, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__bb, t1_xaaa, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__bb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Px,Qy->RPQ', Y_KC__bb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixay,Pyzw,Qxzw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzwx,Qzwy->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixay,Pzxw,Qzyw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__bb, t1_xaaa, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,Px,Qy->RPQ', Y_KC__bb, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pyzw,Qxwz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pyzw,Qxzw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixya,Pzwx,Qzwy->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixya,Pzwx,Qzyw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixya,Pzxw,Qzyw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Pwax,Qwyz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Pwxa,Qwyz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Pwxa,Qwzy->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixyz,Pyaw,Qxwz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,Pywa,Qxwz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/4 * einsum('Ria,ixyz,Pzaw,Qxyw->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] += 1/12 * einsum('Ria,ixyz,Pzwa,Qxwy->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_a:f_a] -= 1/12 * einsum('Ria,ixyz,Pzwa,Qxyw->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)

TY[:, s_c:f_c, s_e:f_e] =- 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__aa, t1_xe, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_xvee, t1_vxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__aa, t1_xvae, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__aa, t1_xvae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__aa, t1_ve, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_vxee, t1_vxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_vxee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__aa, t1_vxae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__aa, t1_vxae, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_vvee, t1_vvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_vvee, t1_vvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__aa, t1_vvae, t1_vvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__aa, t1_vvae, t1_vvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,xa,xQ->RPQ', Y_KC__aa, t1_ae, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KC__aa, t1_xe, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__aa, t1_xvae, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__aa, t1_xvae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ix,Px->RPQ', Y_KC__aa, t1_xa, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__aa, t1_vxae, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__aa, t1_vxae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xvae, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__aa, t1_xvae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_vxae, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__aa, t1_vxae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__bb, t1_xvae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_vxae, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__bb, t1_vxae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__aa, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__aa, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__aa, t1_ve, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__aa, t1_ve, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__aa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__aa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__aa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__aa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__aa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__aa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__aa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__aa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__aa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__aa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__aa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__aa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,xa,xyzQ,zy->RPQ', Y_KC__aa, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,xa,yxzQ,zy->RPQ', Y_KC__aa, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RPa,xyab,zwQb,xyzw->RPQ', Y_KC__aa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RPa,xyza,wuzQ,yxuw->RPQ', Y_KC__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,xyza,wxuQ,zwyu->RPQ', Y_KC__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,xyza,wyuQ,zwxu->RPQ', Y_KC__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,xyza,xQ,zy->RPQ', Y_KC__aa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,xyza,xwuQ,zwuy->RPQ', Y_KC__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,xyza,xywQ,zw->RPQ', Y_KC__aa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,xyza,yQ,zx->RPQ', Y_KC__aa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,xyza,ywuQ,zwxu->RPQ', Y_KC__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,xyza,yxwQ,zw->RPQ', Y_KC__aa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ia,Pxay,xy->RPQ', Y_KC__aa, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KC__aa, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ix,Pyxz,yz->RPQ', Y_KC__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ix,Pyzx,yz->RPQ', Y_KC__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KC__aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,Pzaw,xwyz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,Pzay,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KC__aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pzaw,xwyz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pzay,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwuy,xuzw->RPQ', Y_KC__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwuz,xuwy->RPQ', Y_KC__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixyz,Pwyu,xuzw->RPQ', Y_KC__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixyz,Pwyz,xw->RPQ', Y_KC__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwzu,xuyw->RPQ', Y_KC__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwzy,xw->RPQ', Y_KC__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ixyz,Pxwu,yzwu->RPQ', Y_KC__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixyz,Py,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pz,xy->RPQ', Y_KC__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)

TY[:, s_c:f_c, s_e:f_e]  = einsum('Ria,PiQa->RPQ', Y_KC__aa, t2_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('Ria,PiaQ->RPQ', Y_KC__aa, t2_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,PiQa->RPQ', Y_KC__bb, t2_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__aa, t1_xxae, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,Pixa,xQ->RPQ', Y_KC__aa, t1_xxae, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,xa->RPQ', Y_KC__aa, t1_xxae, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,iPxa,xQ->RPQ', Y_KC__aa, t1_xxae, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('Ria,iQ,Pa->RPQ', Y_KC__aa, t1_xe, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__aa, t1_xa, t1_xaee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__aa, t1_xa, t1_xaee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__aa, t1_xaee, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__aa, t1_xaee, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,Pixa,xQ->RPQ', Y_KC__bb, t1_xxae, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,xa->RPQ', Y_KC__bb, t1_xxae, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__bb, t1_xa, t1_xaee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__bb, t1_xaee, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,Pixa,xyzQ,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,Pixa,yxzQ,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/6 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,iPxQ,xyza,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,yxza,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,iPxa,xyzQ,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,iPxa,yQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,iPxa,yxzQ,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,iPxa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__aa, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__aa, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__aa, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__aa, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__aa, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__aa, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__aa, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__aa, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__aa, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__aa, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,Pixa,xyzQ,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,Pixa,yxzQ,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/3 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,iPxQ,xyza,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,yxza,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__bb, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__bb, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__bb, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/3 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__bb, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)

TY[:, s_c:f_c, s_e:f_e]  = einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__aa, t1_xvae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_vxae, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__aa, t1_vxae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__bb, t1_xe, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_xvee, t1_vxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__bb, t1_xvae, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__bb, t1_xvae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__bb, t1_ve, t1_ve, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_vxee, t1_vxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_vxee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__bb, t1_vxae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__bb, t1_vxae, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_vvee, t1_vvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_vvee, t1_vvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__bb, t1_vvae, t1_vvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__bb, t1_vvae, t1_vvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,xa,xQ->RPQ', Y_KC__bb, t1_ae, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KC__bb, t1_xe, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__bb, t1_xxaa, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__bb, t1_xxaa, t1_xxaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__bb, t1_xvae, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__bb, t1_xvae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__bb, t1_xvaa, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__bb, t1_xvaa, t1_xvaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ix,Px->RPQ', Y_KC__bb, t1_xa, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__bb, t1_vxae, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__bb, t1_vxae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xvae, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__bb, t1_xvae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_vxae, t1_xvae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__bb, t1_vxae, t1_vxae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__bb, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__bb, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__bb, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__bb, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__bb, t1_ve, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__bb, t1_ve, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__bb, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__bb, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__bb, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__bb, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__bb, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__bb, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__bb, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__bb, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__bb, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__bb, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__bb, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__bb, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,xa,xyzQ,zy->RPQ', Y_KC__bb, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,xa,yxzQ,zy->RPQ', Y_KC__bb, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RPa,xyab,zwQb,xyzw->RPQ', Y_KC__bb, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RPa,xyza,wuzQ,yxuw->RPQ', Y_KC__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,xyza,wxuQ,zwyu->RPQ', Y_KC__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,xyza,wyuQ,zwxu->RPQ', Y_KC__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,xyza,xQ,zy->RPQ', Y_KC__bb, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,xyza,xwuQ,zwuy->RPQ', Y_KC__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,xyza,xywQ,zw->RPQ', Y_KC__bb, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RPa,xyza,yQ,zx->RPQ', Y_KC__bb, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,xyza,ywuQ,zwxu->RPQ', Y_KC__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RPa,xyza,yxwQ,zw->RPQ', Y_KC__bb, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ia,Pxay,xy->RPQ', Y_KC__bb, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KC__bb, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__bb, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__bb, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__bb, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__bb, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ix,Pyxz,yz->RPQ', Y_KC__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ix,Pyzx,yz->RPQ', Y_KC__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KC__bb, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,Pzaw,xwyz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,Pzay,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KC__bb, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pzaw,xwyz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pzay,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwuy,xuzw->RPQ', Y_KC__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwuz,xuwy->RPQ', Y_KC__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixyz,Pwyu,xuzw->RPQ', Y_KC__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixyz,Pwyz,xw->RPQ', Y_KC__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwzu,xuyw->RPQ', Y_KC__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwzy,xw->RPQ', Y_KC__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,ixyz,Pxwu,yzwu->RPQ', Y_KC__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('RiQ,ixyz,Py,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pz,xy->RPQ', Y_KC__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__bb, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__bb, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)

TY[:, s_c:f_c, s_e:f_e]  = einsum('Ria,PiQa->RPQ', Y_KC__aa, t2_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += einsum('Ria,PiQa->RPQ', Y_KC__bb, t2_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('Ria,PiaQ->RPQ', Y_KC__bb, t2_xxee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,Pixa,xQ->RPQ', Y_KC__aa, t1_xxae, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,xa->RPQ', Y_KC__aa, t1_xxae, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__aa, t1_xa, t1_xaee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__aa, t1_xaee, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__bb, t1_xxae, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,Pixa,xQ->RPQ', Y_KC__bb, t1_xxae, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,xa->RPQ', Y_KC__bb, t1_xxae, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,iPxa,xQ->RPQ', Y_KC__bb, t1_xxae, t1_ae, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('Ria,iQ,Pa->RPQ', Y_KC__bb, t1_xe, t1_xe, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__bb, t1_xa, t1_xaee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__bb, t1_xa, t1_xaee, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__bb, t1_xaee, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__bb, t1_xaee, t1_xa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,Pixa,xyzQ,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,Pixa,yxzQ,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/3 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,iPxQ,xyza,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,yxza,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__aa, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__aa, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__aa, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/3 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__aa, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,Pixa,xyzQ,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,Pixa,yxzQ,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/6 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,iPxQ,xyza,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,yxza,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,iPxa,xyzQ,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,iPxa,yQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,iPxa,yxzQ,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,iPxa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__bb, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__bb, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__bb, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__bb, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__bb, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__bb, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__bb, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__bb, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__bb, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__bb, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__bb, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_c:f_c, s_e:f_e] += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__bb, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)

TY[:, s_v:f_v, s_e:f_e] =- 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KC__aa, t1_xe, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__aa, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__aa, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__aa, t1_xxae, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__aa, t1_xxae, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__aa, t1_xxaa, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__aa, t1_xxaa, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__aa, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__aa, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__aa, t1_xvae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__aa, t1_xvae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__aa, t1_xvaa, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__aa, t1_xvaa, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ix,Px->RPQ', Y_KC__aa, t1_xa, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__aa, t1_xxae, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__aa, t1_xxae, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__aa, t1_vxae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__aa, t1_vxae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__aa, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__aa, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__aa, t1_xxae, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__aa, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__aa, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xvae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__aa, t1_xvae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__aa, t1_xxae, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_vxae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__aa, t1_vxae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__bb, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__bb, t1_xxae, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__bb, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__bb, t1_xvae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__bb, t1_xxae, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_vxae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__bb, t1_vxae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ia,Pxay,xy->RPQ', Y_KC__aa, t1_xe, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KC__aa, t1_xe, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__aa, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__aa, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ix,Pyxz,yz->RPQ', Y_KC__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ix,Pyzx,yz->RPQ', Y_KC__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KC__aa, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,Pzaw,xwyz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,Pzay,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KC__aa, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pzaw,xwyz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pzay,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwuy,xuzw->RPQ', Y_KC__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwuz,xuwy->RPQ', Y_KC__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixyz,Pwyu,xuzw->RPQ', Y_KC__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixyz,Pwyz,xw->RPQ', Y_KC__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwzu,xuyw->RPQ', Y_KC__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwzy,xw->RPQ', Y_KC__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ixyz,Pxwu,yzwu->RPQ', Y_KC__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixyz,Py,xz->RPQ', Y_KC__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pz,xy->RPQ', Y_KC__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)

TY[:, s_v:f_v, s_e:f_e]  = einsum('Ria,PiQa->RPQ', Y_KC__aa, t2_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('Ria,PiaQ->RPQ', Y_KC__aa, t2_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,PiQa->RPQ', Y_KC__bb, t2_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__aa, t1_vxae, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,Pixa,xQ->RPQ', Y_KC__aa, t1_vxae, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,xa->RPQ', Y_KC__aa, t1_xvae, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,iPxa,xQ->RPQ', Y_KC__aa, t1_xvae, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('Ria,iQ,Pa->RPQ', Y_KC__aa, t1_xe, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__aa, t1_xa, t1_vaee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__aa, t1_xa, t1_vaee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__aa, t1_xaee, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__aa, t1_xaee, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,Pixa,xQ->RPQ', Y_KC__bb, t1_vxae, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,xa->RPQ', Y_KC__bb, t1_xvae, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__bb, t1_xa, t1_vaee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__bb, t1_xaee, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,Pixa,xyzQ,zy->RPQ', Y_KC__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,Pixa,yxzQ,zy->RPQ', Y_KC__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/6 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,iPxQ,xyza,zy->RPQ', Y_KC__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,yxza,zy->RPQ', Y_KC__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,iPxa,xyzQ,zy->RPQ', Y_KC__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,iPxa,yQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,iPxa,yxzQ,zy->RPQ', Y_KC__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,iPxa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__aa, t1_xe, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__aa, t1_xe, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__aa, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__aa, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__aa, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__aa, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__aa, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__aa, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__aa, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__aa, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__aa, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__aa, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,Pixa,xyzQ,zy->RPQ', Y_KC__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,Pixa,yxzQ,zy->RPQ', Y_KC__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/3 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,iPxQ,xyza,zy->RPQ', Y_KC__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,yxza,zy->RPQ', Y_KC__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__bb, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__bb, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__bb, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/3 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__bb, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)

TY[:, s_v:f_v, s_e:f_e]  = einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__aa, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__aa, t1_xxae, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__aa, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__aa, t1_xvae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__aa, t1_xxae, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_vxae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__aa, t1_vxae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KC__bb, t1_xe, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__bb, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__bb, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__bb, t1_xxae, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__bb, t1_xxae, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__bb, t1_xxaa, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__bb, t1_xxaa, t1_vxaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__bb, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__bb, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__bb, t1_xvae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__bb, t1_xvae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__bb, t1_xvaa, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__bb, t1_xvaa, t1_vvaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ix,Px->RPQ', Y_KC__bb, t1_xa, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__bb, t1_xxae, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__bb, t1_xxae, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__bb, t1_vxae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__bb, t1_vxae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__bb, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__bb, t1_xxee, t1_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__bb, t1_xxae, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijab,PjbQ->RPQ', Y_KC__bb, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__bb, t1_xvee, t1_vvee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xvae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__bb, t1_xvae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_vxae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__bb, t1_xxae, t1_xvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_vxae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,jixa,jPxQ->RPQ', Y_KC__bb, t1_vxae, t1_vvae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ia,Pxay,xy->RPQ', Y_KC__bb, t1_xe, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KC__bb, t1_xe, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__bb, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__bb, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ix,Pyxz,yz->RPQ', Y_KC__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ix,Pyzx,yz->RPQ', Y_KC__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KC__bb, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,Pzaw,xwyz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,Pzay,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KC__bb, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pzaw,xwyz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pzay,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwuy,xuzw->RPQ', Y_KC__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwuz,xuwy->RPQ', Y_KC__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixyz,Pwyu,xuzw->RPQ', Y_KC__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixyz,Pwyz,xw->RPQ', Y_KC__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwzu,xuyw->RPQ', Y_KC__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pwzy,xw->RPQ', Y_KC__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,ixyz,Pxwu,yzwu->RPQ', Y_KC__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('RiQ,ixyz,Py,xz->RPQ', Y_KC__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('RiQ,ixyz,Pz,xy->RPQ', Y_KC__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)

TY[:, s_v:f_v, s_e:f_e]  = einsum('Ria,PiQa->RPQ', Y_KC__aa, t2_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += einsum('Ria,PiQa->RPQ', Y_KC__bb, t2_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('Ria,PiaQ->RPQ', Y_KC__bb, t2_vxee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,Pixa,xQ->RPQ', Y_KC__aa, t1_vxae, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,xa->RPQ', Y_KC__aa, t1_xvae, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__aa, t1_xa, t1_vaee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__aa, t1_xaee, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__bb, t1_vxae, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,Pixa,xQ->RPQ', Y_KC__bb, t1_vxae, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,Pixy,xyQa->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,xa->RPQ', Y_KC__bb, t1_xvae, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,iPxa,xQ->RPQ', Y_KC__bb, t1_xvae, t1_ae, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('Ria,iQ,Pa->RPQ', Y_KC__bb, t1_xe, t1_ve, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ix,PxQa->RPQ', Y_KC__bb, t1_xa, t1_vaee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__bb, t1_xa, t1_vaee, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__bb, t1_xaee, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__bb, t1_xaee, t1_va, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,Pixa,xyzQ,zy->RPQ', Y_KC__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,Pixa,yxzQ,zy->RPQ', Y_KC__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/3 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,iPxQ,xyza,zy->RPQ', Y_KC__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,yxza,zy->RPQ', Y_KC__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__aa, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__aa, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__aa, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/3 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__aa, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,Pixa,xyzQ,zy->RPQ', Y_KC__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,Pixa,yxzQ,zy->RPQ', Y_KC__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,Pixa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/6 * einsum('Ria,Pixy,zwQa,xywz->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/6 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,iPxQ,xyza,zy->RPQ', Y_KC__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,iPxQ,yxza,zy->RPQ', Y_KC__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,iPxa,xyzQ,zy->RPQ', Y_KC__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,iPxa,yQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,iPxa,yxzQ,zy->RPQ', Y_KC__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,iPxa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__bb, t1_xe, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__bb, t1_xe, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__bb, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__bb, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__bb, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__bb, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__bb, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__bb, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__bb, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__bb, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/2 * einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] -= 1/4 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__bb, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_v:f_v, s_e:f_e] += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__bb, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)

TY[:, s_a:f_a, s_e:f_e]  = einsum('RiQ,iP->RPQ', Y_KC__aa, t2_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KC__aa, t1_xe, t1_ae, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPa,ja->RPQ', Y_KC__aa, t1_xxae, t1_xe, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPx,jx->RPQ', Y_KC__aa, t1_xxaa, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijab,jPab->RPQ', Y_KC__aa, t1_xxee, t1_xaee, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,ijab,jPba->RPQ', Y_KC__aa, t1_xxee, t1_xaee, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,ijxa,jPax->RPQ', Y_KC__aa, t1_xxae, t1_xaea, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__aa, t1_xxae, t1_xaae, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,jPxy->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,ijxy,jPyx->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPa,ja->RPQ', Y_KC__aa, t1_xvae, t1_ve, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPx,jx->RPQ', Y_KC__aa, t1_xvaa, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijab,jPab->RPQ', Y_KC__aa, t1_xvee, t1_vaee, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,ijab,jPba->RPQ', Y_KC__aa, t1_xvee, t1_vaee, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,ijxa,jPax->RPQ', Y_KC__aa, t1_xvae, t1_vaea, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__aa, t1_xvae, t1_vaae, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,jPxy->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,ijxy,jPyx->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__aa, t1_xxae, t1_xe, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPx,jx->RPQ', Y_KC__aa, t1_xxaa, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPax->RPQ', Y_KC__aa, t1_xxae, t1_xaea, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__aa, t1_xxae, t1_xaae, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__aa, t1_vxae, t1_ve, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPx,jx->RPQ', Y_KC__aa, t1_vxaa, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPax->RPQ', Y_KC__aa, t1_vxae, t1_vaea, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__aa, t1_vxae, t1_vaae, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__aa, t1_xxae, t1_xe, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__aa, t1_xvae, t1_ve, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_xxae, t1_xe, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_vxae, t1_ve, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ixPy,yx->RPQ', Y_KC__aa, t2_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ixyP,yx->RPQ', Y_KC__aa, t2_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_xxae, t1_xe, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_vxae, t1_ve, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KC__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ia,xPya,xy->RPQ', Y_KC__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPx,jy,xy->RPQ', Y_KC__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPx,jyxz,zy->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPx,jyzw,xyzw->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPx,jyzx,zy->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPay,xy->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,jPxz,yz->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,jPyz,xz->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,jPzw,xywz->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,jPzx,yz->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,jPzy,xz->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPx,jy,xy->RPQ', Y_KC__aa, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPx,jyxz,zy->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPx,jyzw,xyzw->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPx,jyzx,zy->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPay,xy->RPQ', Y_KC__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,jPxz,yz->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,jPyz,xz->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,jPzw,xywz->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,jPzx,yz->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,jPzy,xz->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ixPa,ya,xy->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ixPa,yzwa,xwzy->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ixaP,ya,xy->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ixaP,yzwa,xwzy->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KC__aa, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KC__aa, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,zPwa,xwyz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,zPya,xz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ixya,zPwa,xwyz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ixya,zPya,xz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPx,jy,xy->RPQ', Y_KC__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPx,jyxz,zy->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPx,jyzw,xyzw->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPx,jyzx,zy->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,jixa,jPay,xy->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPx,jy,xy->RPQ', Y_KC__aa, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPx,jyxz,zy->RPQ', Y_KC__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPx,jyzw,xyzw->RPQ', Y_KC__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPx,jyzx,zy->RPQ', Y_KC__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,jixa,jPay,xy->RPQ', Y_KC__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__aa, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__aa, t1_xvae, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__aa, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,ixPa,yQ,xy->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,ixPa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yQ,xy->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixab,yzQb,Pxyz->RPQ', Y_KC__aa, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,xQ,Py->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,xzwQ,Pwzy->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,zwyQ,Pxwz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,zxwQ,Pwyz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixba,yzQb,Pxyz->RPQ', Y_KC__aa, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixba,yzQb,Pxzy->RPQ', Y_KC__aa, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixya,xQ,Py->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixya,xzwQ,Pwyz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixya,xzwQ,Pwzy->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixya,zwyQ,Pxwz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixya,zwyQ,Pxzw->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixya,zxwQ,Pwyz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__aa, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__aa, t1_vxae, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__bb, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yQ,xy->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixab,yzQb,Pxyz->RPQ', Y_KC__bb, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,xQ,Py->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,xzwQ,Pwzy->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,zwyQ,Pxwz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,zxwQ,Pwyz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,ixba,yzQb,Pxyz->RPQ', Y_KC__bb, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixba,yzQb,Pxzy->RPQ', Y_KC__bb, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixya,xzwQ,Pwyz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,ixya,xzwQ,Pwzy->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,ixya,zwyQ,Pxwz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixya,zwyQ,Pxzw->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__bb, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__bb, t1_vxae, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)

TY[:, s_a:f_a, s_e:f_e] =- einsum('Ria,iQ,Pa->RPQ', Y_KC__aa, t1_xe, t1_ae, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijQa,jP->RPQ', Y_KC__aa, t1_xxee, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijQa,jP->RPQ', Y_KC__aa, t1_xvee, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiQa,jP->RPQ', Y_KC__aa, t1_xxee, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiQa,jP->RPQ', Y_KC__aa, t1_vxee, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__aa, t2_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__aa, t2_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiQa,jP->RPQ', Y_KC__bb, t1_xxee, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiQa,jP->RPQ', Y_KC__bb, t1_vxee, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__bb, t2_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,iPax,yQ,xy->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,iPax,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,iPxa,yQ,xy->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,iPxa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,iPxy,zwQa,yxwz->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,iPxy,zwQa,yxzw->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,iQ,xPya,xy->RPQ', Y_KC__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijQa,jx,Px->RPQ', Y_KC__aa, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijQa,jxPy,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijQa,jxyP,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijQa,jxyz,Pxyz->RPQ', Y_KC__aa, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijQa,jx,Px->RPQ', Y_KC__aa, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijQa,jxPy,yx->RPQ', Y_KC__aa, t1_xvee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijQa,jxyP,yx->RPQ', Y_KC__aa, t1_xvee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijQa,jxyz,Pxyz->RPQ', Y_KC__aa, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ix,xyQa,Py->RPQ', Y_KC__aa, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ix,yxQa,Py->RPQ', Y_KC__aa, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ixQy,yPza,xz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixQy,ya,Px->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixQy,yzwa,Pwzx->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ixQy,zPwa,ywxz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixQy,zwxa,Pywz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixQy,zywa,Pwxz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,yQ,Px->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,yzwQ,Pwzx->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,zwxQ,Pywz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,zywQ,Pwxz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixyQ,yPza,xz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,ya,Px->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixyQ,yzwa,Pwxz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixyQ,yzwa,Pwzx->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixyQ,zPwa,ywxz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixyQ,zwxa,Pywz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixyQ,zwxa,Pyzw->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,zywa,Pwxz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixya,yQ,Px->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixya,yzwQ,Pwxz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixya,yzwQ,Pwzx->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixya,zwxQ,Pywz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixya,zwxQ,Pyzw->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixya,zywQ,Pwxz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixyz,wyQa,Pzwx->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixyz,wzQa,Pywx->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixyz,wzQa,Pyxw->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixyz,ywQa,Pzwx->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixyz,yzQa,Px->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixyz,zwQa,Pywx->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixyz,zwQa,Pyxw->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixyz,zyQa,Px->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jx,Px->RPQ', Y_KC__aa, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiQa,jxPy,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiQa,jxyP,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jxyz,Pxyz->RPQ', Y_KC__aa, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jx,Px->RPQ', Y_KC__aa, t1_vxee, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiQa,jxPy,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiQa,jxyP,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jxyz,Pxyz->RPQ', Y_KC__aa, t1_vxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,iPax,yQ,xy->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,iPax,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,iPxy,zwQa,yxwz->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/3 * einsum('Ria,iPxy,zwQa,yxzw->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ix,yxQa,Py->RPQ', Y_KC__bb, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,yQ,Px->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,yzwQ,Pwzx->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,zwxQ,Pywz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,zywQ,Pwxz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/3 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,ya,Px->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,ixyQ,yzwa,Pwxz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixyQ,yzwa,Pwzx->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixyQ,zwxa,Pywz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,ixyQ,zwxa,Pyzw->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,zywa,Pwxz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixya,yzwQ,Pwxz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,ixya,yzwQ,Pwzx->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,ixya,zwxQ,Pywz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixya,zwxQ,Pyzw->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixyz,wyQa,Pzwx->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,ixyz,wzQa,Pywx->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixyz,wzQa,Pyxw->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixyz,zwQa,Pywx->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,ixyz,zwQa,Pyxw->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixyz,zyQa,Px->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jx,Px->RPQ', Y_KC__bb, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiQa,jxPy,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiQa,jxyP,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jxyz,Pxyz->RPQ', Y_KC__bb, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jx,Px->RPQ', Y_KC__bb, t1_vxee, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiQa,jxPy,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiQa,jxyP,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jxyz,Pxyz->RPQ', Y_KC__bb, t1_vxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)

TY[:, s_a:f_a, s_e:f_e]  = einsum('RiQ,iP->RPQ', Y_KC__bb, t2_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_xxae, t1_xe, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_vxae, t1_ve, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KC__bb, t1_xe, t1_ae, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPa,ja->RPQ', Y_KC__bb, t1_xxae, t1_xe, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPx,jx->RPQ', Y_KC__bb, t1_xxaa, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijab,jPab->RPQ', Y_KC__bb, t1_xxee, t1_xaee, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,ijab,jPba->RPQ', Y_KC__bb, t1_xxee, t1_xaee, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,ijxa,jPax->RPQ', Y_KC__bb, t1_xxae, t1_xaea, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__bb, t1_xxae, t1_xaae, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,jPxy->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,ijxy,jPyx->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPa,ja->RPQ', Y_KC__bb, t1_xvae, t1_ve, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPx,jx->RPQ', Y_KC__bb, t1_xvaa, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijab,jPab->RPQ', Y_KC__bb, t1_xvee, t1_vaee, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,ijab,jPba->RPQ', Y_KC__bb, t1_xvee, t1_vaee, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,ijxa,jPax->RPQ', Y_KC__bb, t1_xvae, t1_vaea, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__bb, t1_xvae, t1_vaae, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,jPxy->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,ijxy,jPyx->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__bb, t1_xxae, t1_xe, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPx,jx->RPQ', Y_KC__bb, t1_xxaa, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPax->RPQ', Y_KC__bb, t1_xxae, t1_xaea, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__bb, t1_xxae, t1_xaae, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__bb, t1_vxae, t1_ve, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPx,jx->RPQ', Y_KC__bb, t1_vxaa, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPax->RPQ', Y_KC__bb, t1_vxae, t1_vaea, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__bb, t1_vxae, t1_vaae, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__bb, t1_xxae, t1_xe, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__bb, t1_xvae, t1_ve, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_xxae, t1_xe, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_vxae, t1_ve, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ixPy,yx->RPQ', Y_KC__bb, t2_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ixyP,yx->RPQ', Y_KC__bb, t2_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__aa, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yQ,xy->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixab,yzQb,Pxyz->RPQ', Y_KC__aa, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,xQ,Py->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,xzwQ,Pwzy->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,zwyQ,Pxwz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,zxwQ,Pwyz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,ixba,yzQb,Pxyz->RPQ', Y_KC__aa, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixba,yzQb,Pxzy->RPQ', Y_KC__aa, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixya,xzwQ,Pwyz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,ixya,xzwQ,Pwzy->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,ixya,zwyQ,Pxwz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixya,zwyQ,Pxzw->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__aa, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__aa, t1_vxae, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KC__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ia,xPya,xy->RPQ', Y_KC__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPx,jy,xy->RPQ', Y_KC__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPx,jyxz,zy->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPx,jyzw,xyzw->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPx,jyzx,zy->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPay,xy->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,jPxz,yz->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,jPyz,xz->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,jPzw,xywz->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,jPzx,yz->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,jPzy,xz->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPx,jy,xy->RPQ', Y_KC__bb, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('RiQ,ijPx,jyxz,zy->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPx,jyzw,xyzw->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ijPx,jyzx,zy->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxa,jPay,xy->RPQ', Y_KC__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,jPxz,yz->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,jPyz,xz->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,jPzw,xywz->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ijxy,jPzx,yz->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ijxy,jPzy,xz->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ixPa,ya,xy->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,ixPa,yzwa,xwzy->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ixaP,ya,xy->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,ixaP,yzwa,xwzy->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KC__bb, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KC__bb, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,zPwa,xwyz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ixay,zPya,xz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ixya,zPwa,xwyz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,ixya,zPya,xz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPx,jy,xy->RPQ', Y_KC__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPx,jyxz,zy->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPx,jyzw,xyzw->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPx,jyzx,zy->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,jixa,jPay,xy->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPx,jy,xy->RPQ', Y_KC__bb, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('RiQ,jiPx,jyxz,zy->RPQ', Y_KC__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPx,jyzw,xyzw->RPQ', Y_KC__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('RiQ,jiPx,jyzx,zy->RPQ', Y_KC__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('RiQ,jixa,jPay,xy->RPQ', Y_KC__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__bb, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__bb, t1_xvae, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ijxa,jyzQ,Pzxy->RPQ', Y_KC__bb, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,ixPa,yQ,xy->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,ixPa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yQ,xy->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixaP,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixab,yzQb,Pxyz->RPQ', Y_KC__bb, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,xQ,Py->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,xzwQ,Pwzy->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,zwyQ,Pxwz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,zxwQ,Pwyz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixba,yzQb,Pxyz->RPQ', Y_KC__bb, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixba,yzQb,Pxzy->RPQ', Y_KC__bb, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixya,xQ,Py->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixya,xzwQ,Pwyz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixya,xzwQ,Pwzy->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixya,zwyQ,Pxwz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixya,zwyQ,Pxzw->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixya,zxwQ,Pwyz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__bb, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__bb, t1_vxae, t1_ve, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)

TY[:, s_a:f_a, s_e:f_e]  = einsum('Ria,jiQa,jP->RPQ', Y_KC__aa, t1_xxee, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiQa,jP->RPQ', Y_KC__aa, t1_vxee, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__aa, t2_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,iQ,Pa->RPQ', Y_KC__bb, t1_xe, t1_ae, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijQa,jP->RPQ', Y_KC__bb, t1_xxee, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijQa,jP->RPQ', Y_KC__bb, t1_xvee, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiQa,jP->RPQ', Y_KC__bb, t1_xxee, t1_xa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiQa,jP->RPQ', Y_KC__bb, t1_vxee, t1_va, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__bb, t2_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixaQ,Px->RPQ', Y_KC__bb, t2_xaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,iPax,yQ,xy->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,iPax,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,iPxy,zwQa,yxwz->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/3 * einsum('Ria,iPxy,zwQa,yxzw->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ix,yxQa,Py->RPQ', Y_KC__aa, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,yQ,Px->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,yzwQ,Pwzx->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,zwxQ,Pywz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,zywQ,Pwxz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/3 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,ya,Px->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,ixyQ,yzwa,Pwxz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixyQ,yzwa,Pwzx->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixyQ,zwxa,Pywz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,ixyQ,zwxa,Pyzw->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,zywa,Pwxz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixya,yzwQ,Pwxz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,ixya,yzwQ,Pwzx->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,ixya,zwxQ,Pywz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixya,zwxQ,Pyzw->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixyz,wyQa,Pzwx->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,ixyz,wzQa,Pywx->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixyz,wzQa,Pyxw->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixyz,zwQa,Pywx->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,ixyz,zwQa,Pyxw->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixyz,zyQa,Px->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jx,Px->RPQ', Y_KC__aa, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiQa,jxPy,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiQa,jxyP,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jxyz,Pxyz->RPQ', Y_KC__aa, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jx,Px->RPQ', Y_KC__aa, t1_vxee, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiQa,jxPy,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiQa,jxyP,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jxyz,Pxyz->RPQ', Y_KC__aa, t1_vxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,iPax,yQ,xy->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,iPax,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,iPxa,yQ,xy->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,iPxa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,iPxy,zwQa,yxwz->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,iPxy,zwQa,yxzw->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,iQ,xPya,xy->RPQ', Y_KC__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijQa,jx,Px->RPQ', Y_KC__bb, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijQa,jxPy,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijQa,jxyP,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijQa,jxyz,Pxyz->RPQ', Y_KC__bb, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijQa,jx,Px->RPQ', Y_KC__bb, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ijQa,jxPy,yx->RPQ', Y_KC__bb, t1_xvee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ijQa,jxyP,yx->RPQ', Y_KC__bb, t1_xvee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ijQa,jxyz,Pxyz->RPQ', Y_KC__bb, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ix,xyQa,Py->RPQ', Y_KC__bb, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ix,yxQa,Py->RPQ', Y_KC__bb, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ixQy,yPza,xz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixQy,ya,Px->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixQy,yzwa,Pwzx->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= einsum('Ria,ixQy,zPwa,ywxz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixQy,zwxa,Pywz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixQy,zywa,Pwxz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,yQ,Px->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,yzwQ,Pwzx->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixay,zwxQ,Pywz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixay,zywQ,Pwxz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/6 * einsum('Ria,ixyQ,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/6 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixyQ,yPza,xz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,ya,Px->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixyQ,yzwa,Pwxz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixyQ,yzwa,Pwzx->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/2 * einsum('Ria,ixyQ,zPwa,ywxz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixyQ,zwxa,Pywz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixyQ,zwxa,Pyzw->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixyQ,zywa,Pwxz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixya,yQ,Px->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixya,yzwQ,Pwxz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixya,yzwQ,Pwzx->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixya,zwxQ,Pywz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixya,zwxQ,Pyzw->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixya,zywQ,Pwxz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixyz,wyQa,Pzwx->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixyz,wzQa,Pywx->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixyz,wzQa,Pyxw->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixyz,ywQa,Pzwx->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,ixyz,yzQa,Px->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/12 * einsum('Ria,ixyz,zwQa,Pywx->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/12 * einsum('Ria,ixyz,zwQa,Pyxw->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += 1/4 * einsum('Ria,ixyz,zyQa,Px->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jx,Px->RPQ', Y_KC__bb, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiQa,jxPy,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiQa,jxyP,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jxyz,Pxyz->RPQ', Y_KC__bb, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jx,Px->RPQ', Y_KC__bb, t1_vxee, t1_va, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] += einsum('Ria,jiQa,jxPy,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/2 * einsum('Ria,jiQa,jxyP,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaaa, rdm_ca, optimize = einsum_type)
TY[:, s_a:f_a, s_e:f_e] -= 1/4 * einsum('Ria,jiQa,jxyz,Pxyz->RPQ', Y_KC__bb, t1_vxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
