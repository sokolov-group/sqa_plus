
----------------------------------------------------------------------------------------------------
sqa_plus: Code generator for quasi-particle systems.
Copyright 2009-2022 SecondQuantizationAlgebra Developers. All Rights Reserved.
Available at https://github.com/sokolov-group/sqa_plus

Licensed under the GNU General Public License v3.0;

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
----------------------------------------------------------------------------------------------------


---------------------------- Spin-Adapted CVS-EE: Sigma H1 CAAA_CA (aa) ----------------------------


## Generating operators ...


## Left operator terms:
 (   0.50000) X_aaaa(i,x,y,z) cre(i) cre(x) des(y) des(z) 
 (   1.00000) X_abab(i,x,y,z) cre(i) cre(x) des(y) des(z) 
 (   1.00000) X_abab(i,x,y,z) cre(i) cre(x) des(y) des(z) 
 (   0.50000) X_bbbb(i,x,y,z) cre(i) cre(x) des(y) des(z) 
 (   1.00000) X_baba(i,x,y,z) cre(i) cre(x) des(y) des(z) 
 (   1.00000) X_abba(i,x,y,z) cre(i) cre(x) des(y) des(z) 

## Right operator terms:
 (   1.00000) cre(W) des(K) 

----------------------------------------- Hamiltonian (1) ------------------------------------------

Commutation: Done ...
Done ...
----------------------------------------------------------------------------------------------------
## Calculating the commutator [H(1), h(0)^\dag] ...

## Calculating [h(1), [H(1), h(0)^\dag]] ...

------------------------------------------ SQA Automation ------------------------------------------

Computing expectation value with respect to virtual ...
Done!
----------------------------------------------------------------------------------------------------
Normal ordering with respect to core ...
Done!
----------------------------------------------------------------------------------------------------
Computing expectation value with respect to core ...
Done!
----------------------------------------------------------------------------------------------------
Contract delta function for non-dummy indices ...
Done!
----------------------------------------------------------------------------------------------------
Reordering indices according to core < active < virtual...
Done!
----------------------------------------------------------------------------------------------------
Dummy indices relabelling...
Done!
----------------------------------------------------------------------------------------------------

------------------------------------------ Final results -------------------------------------------

 (   1.00000) X_aaaa(k,x,W,w) v(k,u,K,w) cre(x) des(u) 
 (   1.00000) X_aaaa(k,x,w,y) v(k,W,K,w) cre(x) des(y) 
 (  -1.00000) X_abab(k,x,y,z) v(k,W,K,w) cre(x) des(y) 
 (  -1.00000) X_abab(k,x,y,z) v(k,w,K,u) cre(x) des(w) 
 (   1.00000) X_abab(k,x,y,z) v(k,W,K,w) cre(x) des(z) 
 (  -1.00000) X_abab(k,x,y,z) v(k,w,K,u) cre(x) des(w) 
 (   1.00000) X_abba(k,x,y,z) v(k,W,K,w) cre(x) des(z) 
 (   1.00000) X_abba(k,x,y,z) v(k,w,K,u) cre(x) des(w) 
 (  -1.00000) X_baba(k,x,y,z) v(k,W,K,w) cre(x) des(y) 
 (   1.00000) X_baba(k,x,y,z) v(k,w,K,u) cre(x) des(w) 
 (   1.00000) X_bbbb(k,x,w,y) v(k,W,K,w) cre(x) des(y) 
 (  -1.00000) X_aaaa(k,x,W,y) v(k,w,K,u) rdm(w,u) cre(x) des(y) 
 (  -1.00000) X_aaaa(k,x,W,y) v(k,w,K,u) rdm(w,u) cre(x) des(y) 
 (   1.00000) X_abab(k,x,y,z) v(k,w,K,u) rdm(w,u) cre(x) des(y) 
 (   1.00000) X_abab(k,x,y,z) v(k,w,K,u) rdm(w,u) cre(x) des(y) 
 (  -1.00000) X_abba(k,x,y,z) v(k,w,K,u) rdm(w,u) cre(x) des(z) 
 (  -1.00000) X_abba(k,x,y,z) v(k,w,K,u) rdm(w,u) cre(x) des(z) 
 (  -1.00000) X_aaaa(k,x,W,y) v(k,w,K,u) cre(x) cre(u) des(y) des(w) 
 (  -1.00000) X_aaaa(k,x,W,y) v(k,w,K,u) cre(x) cre(u) des(y) des(w) 
 (  -1.00000) X_aaaa(k,x,w,y) v(k,u,K,w) cre(W) cre(x) des(y) des(u) 
 (  -0.50000) X_aaaa(i,x,y,z) v(i,W,K,w) cre(x) cre(w) des(y) des(z) 
 (  -1.00000) X_abab(k,x,y,z) v(k,w,K,u) cre(W) cre(x) des(w) des(y) 
 (  -1.00000) X_abab(k,x,y,z) v(k,w,K,u) cre(x) cre(u) des(w) des(y) 
 (   1.00000) X_abab(k,x,y,z) v(k,w,K,u) cre(W) cre(x) des(w) des(z) 
 (  -1.00000) X_abab(k,x,y,z) v(k,w,K,u) cre(x) cre(u) des(w) des(y) 
 (   1.00000) X_abab(k,x,y,z) v(k,w,K,u) cre(W) cre(x) des(w) des(z) 
 (  -1.00000) X_abab(k,x,y,z) v(k,w,K,u) cre(x) cre(u) des(w) des(y) 
 (  -1.00000) X_abab(i,x,y,z) v(i,W,K,w) cre(x) cre(w) des(y) des(z) 
 (  -1.00000) X_abab(i,x,y,z) v(i,W,K,w) cre(x) cre(w) des(y) des(z) 
 (   1.00000) X_abba(k,x,y,z) v(k,w,K,u) cre(W) cre(x) des(w) des(z) 
 (   1.00000) X_abba(k,x,y,z) v(k,w,K,u) cre(x) cre(u) des(w) des(z) 
 (  -1.00000) X_abba(k,x,y,z) v(k,w,K,u) cre(W) cre(x) des(w) des(y) 
 (   1.00000) X_abba(k,x,y,z) v(k,w,K,u) cre(x) cre(u) des(w) des(z) 
 (  -1.00000) X_abba(i,x,y,z) v(i,W,K,w) cre(x) cre(w) des(y) des(z) 
 (  -1.00000) X_baba(k,x,y,z) v(k,w,K,u) cre(W) cre(x) des(w) des(y) 
 (   1.00000) X_baba(k,x,y,z) v(k,w,K,u) cre(x) cre(u) des(w) des(z) 
 (  -1.00000) X_baba(i,x,y,z) v(i,W,K,w) cre(x) cre(w) des(y) des(z) 
 (  -1.00000) X_bbbb(k,x,w,y) v(k,u,K,w) cre(W) cre(x) des(y) des(u) 
 (  -0.50000) X_bbbb(i,x,y,z) v(i,W,K,w) cre(x) cre(w) des(y) des(z) 
 (  -0.50000) X_aaaa(i,x,y,z) v(i,w,K,u) rdm(w,u) cre(W) cre(x) des(y) des(z) 
 (  -0.50000) X_aaaa(i,x,y,z) v(i,w,K,u) rdm(w,u) cre(W) cre(x) des(y) des(z) 
 (  -1.00000) X_abab(i,x,y,z) v(i,w,K,u) rdm(w,u) cre(W) cre(x) des(y) des(z) 
 (  -1.00000) X_abab(i,x,y,z) v(i,w,K,u) rdm(w,u) cre(W) cre(x) des(y) des(z) 
 (  -1.00000) X_abba(i,x,y,z) v(i,w,K,u) rdm(w,u) cre(W) cre(x) des(y) des(z) 
 (  -1.00000) X_abba(i,x,y,z) v(i,w,K,u) rdm(w,u) cre(W) cre(x) des(y) des(z) 
 (   0.50000) X_aaaa(i,x,y,z) v(i,w,K,u) cre(W) cre(x) cre(u) des(y) des(z) des(w) 
 (   0.50000) X_aaaa(i,x,y,z) v(i,w,K,u) cre(W) cre(x) cre(u) des(y) des(z) des(w) 
 (   1.00000) X_abab(i,x,y,z) v(i,w,K,u) cre(W) cre(x) cre(u) des(w) des(y) des(z) 
 (   1.00000) X_abab(i,x,y,z) v(i,w,K,u) cre(W) cre(x) cre(u) des(w) des(y) des(z) 
 (   1.00000) X_abab(i,x,y,z) v(i,w,K,u) cre(W) cre(x) cre(u) des(w) des(y) des(z) 
 (   1.00000) X_abba(i,x,y,z) v(i,w,K,u) cre(W) cre(x) cre(u) des(w) des(y) des(z) 
 (   1.00000) X_abba(i,x,y,z) v(i,w,K,u) cre(W) cre(x) cre(u) des(w) des(y) des(z) 
 (   1.00000) X_baba(i,x,y,z) v(i,w,K,u) cre(W) cre(x) cre(u) des(w) des(y) des(z) 
 (   0.50000) X_bbbb(i,x,y,z) v(i,w,K,u) cre(W) cre(x) cre(u) des(y) des(z) des(w) 

Total terms : 54
SQA automation time :  80.150 seconds
Converting Sigma vector to spin-adapted formulation ...
----------------------------------------------------------------------------------------------------
Converting custom vector to spin-adapted formulation...

------------------------ Converting Spin-Integrated Tensors to Spin-Adapted ------------------------

----------------------------------------------------------------------------------------------------
Convert Cre/Des objects to RDM objects...
Done!
----------------------------------------------------------------------------------------------------
Dummy indices relabelling...
Done!
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
Converting 1e- integrals to spin-adapted formulation...
Done!
----------------------------------------------------------------------------------------------------
Converting 2e- integrals to spin-adapted formulation...
Done!
----------------------------------------------------------------------------------------------------
Converting T amplitudes to spin-adapted formulation...
Done!
----------------------------------------------------------------------------------------------------
Converting RDMs to spin-adapted formulation...

Converting 1-RDMs to spin-adapted formulation...
Converting 2-RDMs to spin-adapted formulation...
Converting 3-RDMs to spin-adapted formulation...
Converting 4-RDMs to spin-adapted formulation...
Done!
----------------------------------------------------------------------------------------------------

Combining 150 spin-adapted terms...

Reorder 2e- integrals in Chemists' notation...
Done!
----------------------------------------------------------------------------------------------------
Reorder RDM tensor indices in Chemists' notation...
Done!
----------------------------------------------------------------------------------------------------
Reordering indices according to core < active < virtual...
Done!
----------------------------------------------------------------------------------------------------
Dummy indices relabelling...
Done!
----------------------------------------------------------------------------------------------------

41 spin-adapted terms combined.
----------------------------------------------------------------------------------------------------

-------------------------------------- Spin-adapted equations --------------------------------------

 (  -0.08333) X_aaaa(i,x,y,z) v(K,W,w,i) rdm(x,w,y,z) 
 (   0.08333) X_aaaa(i,x,y,z) v(K,W,w,i) rdm(x,w,z,y) 
 (   0.08333) X_aaaa(i,x,y,z) v(K,i,w,W) rdm(x,w,y,z) 
 (  -0.08333) X_aaaa(i,x,y,z) v(K,i,w,W) rdm(x,w,z,y) 
 (  -0.08333) X_aaaa(i,x,y,z) v(K,i,w,u) rdm(W,x,w,y,z,u) 
 (   0.08333) X_aaaa(i,x,y,z) v(K,i,w,u) rdm(W,x,w,z,y,u) 
 (  -0.04167) X_aaaa(i,x,y,z) v(K,w,u,i) rdm(W,x,u,w,z,y) 
 (  -0.04167) X_aaaa(i,x,y,z) v(K,w,u,i) rdm(W,x,u,y,w,z) 
 (  -0.04167) X_aaaa(i,x,y,z) v(K,w,u,i) rdm(W,x,u,z,y,w) 
 (   0.50000) X_aaaa(k,x,W,w) v(K,k,w,u) rdm(x,u) 
 (  -0.50000) X_aaaa(k,x,W,w) v(K,u,w,k) rdm(x,u) 
 (   0.50000) X_aaaa(k,x,W,y) v(K,k,w,u) rdm(x,w,y,u) 
 (   0.16667) X_aaaa(k,x,W,y) v(K,w,u,k) rdm(x,u,w,y) 
 (  -0.16667) X_aaaa(k,x,W,y) v(K,w,u,k) rdm(x,u,y,w) 
 (  -0.50000) X_aaaa(k,x,w,y) v(K,W,w,k) rdm(x,y) 
 (   0.50000) X_aaaa(k,x,w,y) v(K,k,w,W) rdm(x,y) 
 (  -0.16667) X_aaaa(k,x,w,y) v(K,k,w,u) rdm(W,x,u,y) 
 (   0.16667) X_aaaa(k,x,w,y) v(K,k,w,u) rdm(W,x,y,u) 
 (   0.16667) X_aaaa(k,x,w,y) v(K,u,w,k) rdm(W,x,u,y) 
 (  -0.16667) X_aaaa(k,x,w,y) v(K,u,w,k) rdm(W,x,y,u) 
 (  -0.16667) X_abab(i,x,y,z) v(K,W,w,i) rdm(x,w,y,z) 
 (   0.16667) X_abab(i,x,y,z) v(K,W,w,i) rdm(x,w,z,y) 
 (   0.33333) X_abab(i,x,y,z) v(K,i,w,W) rdm(x,w,y,z) 
 (   0.16667) X_abab(i,x,y,z) v(K,i,w,W) rdm(x,w,z,y) 
 (  -0.16667) X_abab(i,x,y,z) v(K,i,w,u) rdm(W,x,w,u,y,z) 
 (  -0.16667) X_abab(i,x,y,z) v(K,i,w,u) rdm(W,x,w,u,z,y) 
 (  -0.16667) X_abab(i,x,y,z) v(K,i,w,u) rdm(W,x,w,y,u,z) 
 (  -0.16667) X_abab(i,x,y,z) v(K,i,w,u) rdm(W,x,w,z,u,y) 
 (   0.16667) X_abab(i,x,y,z) v(K,i,w,u) rdm(W,x,w,z,y,u) 
 (   0.16667) X_abab(i,x,y,z) v(K,w,u,i) rdm(W,x,u,w,y,z) 
 (   0.16667) X_abab(i,x,y,z) v(K,w,u,i) rdm(W,x,u,y,w,z) 
 (   0.16667) X_abab(i,x,y,z) v(K,w,u,i) rdm(W,x,u,z,w,y) 
 (   0.50000) X_abab(k,x,y,z) v(K,W,w,k) rdm(x,y) 
 (  -0.50000) X_abab(k,x,y,z) v(K,W,w,k) rdm(x,z) 
 (  -0.50000) X_abab(k,x,y,z) v(K,k,w,W) rdm(x,y) 
 (   0.33333) X_abab(k,x,y,z) v(K,k,w,u) rdm(W,x,u,y) 
 (   0.16667) X_abab(k,x,y,z) v(K,k,w,u) rdm(W,x,u,z) 
 (   0.16667) X_abab(k,x,y,z) v(K,k,w,u) rdm(W,x,y,u) 
 (   0.33333) X_abab(k,x,y,z) v(K,k,w,u) rdm(W,x,z,u) 
 (  -0.50000) X_abab(k,x,y,z) v(K,k,w,u) rdm(x,u) 
 (  -0.50000) X_abab(k,x,y,z) v(K,k,w,u) rdm(x,w,y,u) 
 (  -0.33333) X_abab(k,x,y,z) v(K,w,u,k) rdm(W,x,w,y) 
 (   0.16667) X_abab(k,x,y,z) v(K,w,u,k) rdm(W,x,w,z) 
 (  -0.16667) X_abab(k,x,y,z) v(K,w,u,k) rdm(W,x,y,w) 
 (  -0.16667) X_abab(k,x,y,z) v(K,w,u,k) rdm(W,x,z,w) 
 (  -0.16667) X_abab(k,x,y,z) v(K,w,u,k) rdm(x,u,w,y) 
 (   0.16667) X_abab(k,x,y,z) v(K,w,u,k) rdm(x,u,y,w) 
 (   0.50000) X_abab(k,x,y,z) v(K,w,u,k) rdm(x,w) 
 (   0.16667) X_abba(i,x,y,z) v(K,W,w,i) rdm(x,w,y,z) 
 (   0.33333) X_abba(i,x,y,z) v(K,W,w,i) rdm(x,w,z,y) 
 (  -0.16667) X_abba(i,x,y,z) v(K,i,w,W) rdm(x,w,y,z) 
 (  -0.33333) X_abba(i,x,y,z) v(K,i,w,W) rdm(x,w,z,y) 
 (  -0.33333) X_abba(i,x,y,z) v(K,i,w,u) rdm(W,x,w,y,z,u) 
 (  -0.16667) X_abba(i,x,y,z) v(K,i,w,u) rdm(W,x,w,z,y,u) 
 (  -0.08333) X_abba(i,x,y,z) v(K,w,u,i) rdm(W,x,u,w,z,y) 
 (   0.08333) X_abba(i,x,y,z) v(K,w,u,i) rdm(W,x,u,y,w,z) 
 (   0.16667) X_abba(i,x,y,z) v(K,w,u,i) rdm(W,x,u,y,z,w) 
 (   0.08333) X_abba(i,x,y,z) v(K,w,u,i) rdm(W,x,u,z,y,w) 
 (  -0.50000) X_abba(k,x,y,z) v(K,W,w,k) rdm(x,z) 
 (   0.50000) X_abba(k,x,y,z) v(K,k,w,W) rdm(x,z) 
 (  -0.16667) X_abba(k,x,y,z) v(K,k,w,u) rdm(W,x,u,y) 
 (  -0.33333) X_abba(k,x,y,z) v(K,k,w,u) rdm(W,x,u,z) 
 (  -0.33333) X_abba(k,x,y,z) v(K,k,w,u) rdm(W,x,y,u) 
 (  -0.16667) X_abba(k,x,y,z) v(K,k,w,u) rdm(W,x,z,u) 
 (   0.50000) X_abba(k,x,y,z) v(K,k,w,u) rdm(x,u) 
 (   0.50000) X_abba(k,x,y,z) v(K,k,w,u) rdm(x,w,z,u) 
 (   0.33333) X_abba(k,x,y,z) v(K,w,u,k) rdm(W,x,w,z) 
 (   0.16667) X_abba(k,x,y,z) v(K,w,u,k) rdm(W,x,z,w) 
 (  -0.16667) X_abba(k,x,y,z) v(K,w,u,k) rdm(x,u,w,z) 
 (  -0.33333) X_abba(k,x,y,z) v(K,w,u,k) rdm(x,u,z,w) 
 (  -0.33333) X_baba(i,x,y,z) v(K,W,w,i) rdm(x,w,y,z) 
 (  -0.16667) X_baba(i,x,y,z) v(K,W,w,i) rdm(x,w,z,y) 
 (   0.16667) X_baba(i,x,y,z) v(K,w,u,i) rdm(W,x,u,w,y,z) 
 (   0.08333) X_baba(i,x,y,z) v(K,w,u,i) rdm(W,x,u,w,z,y) 
 (  -0.08333) X_baba(i,x,y,z) v(K,w,u,i) rdm(W,x,u,y,w,z) 
 (   0.08333) X_baba(i,x,y,z) v(K,w,u,i) rdm(W,x,u,z,y,w) 
 (   0.50000) X_baba(k,x,y,z) v(K,W,w,k) rdm(x,y) 
 (  -0.16667) X_baba(k,x,y,z) v(K,w,u,k) rdm(W,x,w,y) 
 (   0.16667) X_baba(k,x,y,z) v(K,w,u,k) rdm(W,x,y,w) 
 (   0.33333) X_baba(k,x,y,z) v(K,w,u,k) rdm(x,u,w,z) 
 (   0.16667) X_baba(k,x,y,z) v(K,w,u,k) rdm(x,u,z,w) 
 (  -0.50000) X_baba(k,x,y,z) v(K,w,u,k) rdm(x,w) 
 (  -0.08333) X_bbbb(i,x,y,z) v(K,W,w,i) rdm(x,w,y,z) 
 (   0.08333) X_bbbb(i,x,y,z) v(K,W,w,i) rdm(x,w,z,y) 
 (   0.08333) X_bbbb(i,x,y,z) v(K,w,u,i) rdm(W,x,u,w,y,z) 
 (  -0.04167) X_bbbb(i,x,y,z) v(K,w,u,i) rdm(W,x,u,w,z,y) 
 (   0.04167) X_bbbb(i,x,y,z) v(K,w,u,i) rdm(W,x,u,y,w,z) 
 (   0.04167) X_bbbb(i,x,y,z) v(K,w,u,i) rdm(W,x,u,z,y,w) 
 (  -0.50000) X_bbbb(k,x,w,y) v(K,W,w,k) rdm(x,y) 
 (   0.33333) X_bbbb(k,x,w,y) v(K,u,w,k) rdm(W,x,u,y) 
 (   0.16667) X_bbbb(k,x,w,y) v(K,u,w,k) rdm(W,x,y,u) 
 (   0.08333) X_aaaa(i,x,y,z) v(K,i,w,u) rdm(w,u) rdm(W,x,y,z) 
 (  -0.08333) X_aaaa(i,x,y,z) v(K,i,w,u) rdm(w,u) rdm(W,x,z,y) 
 (  -0.04167) X_aaaa(i,x,y,z) v(K,w,u,i) rdm(u,w) rdm(W,x,y,z) 
 (   0.04167) X_aaaa(i,x,y,z) v(K,w,u,i) rdm(u,w) rdm(W,x,z,y) 
 (  -0.50000) X_aaaa(k,x,W,y) v(K,k,w,u) rdm(w,u) rdm(x,y) 
 (   0.25000) X_aaaa(k,x,W,y) v(K,w,u,k) rdm(u,w) rdm(x,y) 
 (  -0.16667) X_abab(i,x,y,z) v(K,i,w,u) rdm(w,u) rdm(W,x,y,z) 
 (  -0.33333) X_abab(i,x,y,z) v(K,i,w,u) rdm(w,u) rdm(W,x,z,y) 
 (   0.08333) X_abab(i,x,y,z) v(K,w,u,i) rdm(u,w) rdm(W,x,y,z) 
 (   0.16667) X_abab(i,x,y,z) v(K,w,u,i) rdm(u,w) rdm(W,x,z,y) 
 (   0.50000) X_abab(k,x,y,z) v(K,k,w,u) rdm(w,u) rdm(x,y) 
 (  -0.25000) X_abab(k,x,y,z) v(K,w,u,k) rdm(u,w) rdm(x,y) 
 (   0.33333) X_abba(i,x,y,z) v(K,i,w,u) rdm(w,u) rdm(W,x,y,z) 
 (   0.16667) X_abba(i,x,y,z) v(K,i,w,u) rdm(w,u) rdm(W,x,z,y) 
 (  -0.16667) X_abba(i,x,y,z) v(K,w,u,i) rdm(u,w) rdm(W,x,y,z) 
 (  -0.08333) X_abba(i,x,y,z) v(K,w,u,i) rdm(u,w) rdm(W,x,z,y) 
 (  -0.50000) X_abba(k,x,y,z) v(K,k,w,u) rdm(w,u) rdm(x,z) 
 (   0.25000) X_abba(k,x,y,z) v(K,w,u,k) rdm(u,w) rdm(x,z) 

Total spin-integrated terms: 54
Total spin-adapted terms: 109
Spin-adaptation automation time :  6.431 seconds
----------------------------------------------------------------------------------------------------
Dummy indices relabelling...
Done!
----------------------------------------------------------------------------------------------------

--------------------------------------------- WARNING ----------------------------------------------

Terms with a contraction over repeating dummy core indices of 2e- integrals
will be removed. Set "remove_core_integrals" flag to FALSE to preserve terms

0 terms removed:
----------------------------------------------------------------------------------------------------
Remaining terms: 109


--------------------------------------- genEinsum equations ----------------------------------------

sigma_KW_aa =- 1/12 * einsum('ixyz,KWwi,xwyz->KW', X_aaaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/12 * einsum('ixyz,KWwi,xwzy->KW', X_aaaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/12 * einsum('ixyz,KiwW,xwyz->KW', X_aaaa, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/12 * einsum('ixyz,KiwW,xwzy->KW', X_aaaa, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/12 * einsum('ixyz,Kiwu,Wxwyzu->KW', X_aaaa, v_xxaa, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa += 1/12 * einsum('ixyz,Kiwu,Wxwzyu->KW', X_aaaa, v_xxaa, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa -= 1/24 * einsum('ixyz,Kwui,Wxuwzy->KW', X_aaaa, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa -= 1/24 * einsum('ixyz,Kwui,Wxuywz->KW', X_aaaa, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa -= 1/24 * einsum('ixyz,Kwui,Wxuzyw->KW', X_aaaa, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa += 1/2 * einsum('ixWy,Kiyz,xz->KW', X_aaaa, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_KW_aa -= 1/2 * einsum('ixWy,Kzyi,xz->KW', X_aaaa, v_xaax, rdm_ca, optimize = einsum_type)
sigma_KW_aa += 1/2 * einsum('ixWy,Kizw,xzyw->KW', X_aaaa, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixWy,Kzwi,xwzy->KW', X_aaaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixWy,Kzwi,xwyz->KW', X_aaaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/2 * einsum('ixyz,KWyi,xz->KW', X_aaaa, v_xaax, rdm_ca, optimize = einsum_type)
sigma_KW_aa += 1/2 * einsum('ixyz,KiyW,xz->KW', X_aaaa, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kiyw,Wxwz->KW', X_aaaa, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kiyw,Wxzw->KW', X_aaaa, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kwyi,Wxwz->KW', X_aaaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kwyi,Wxzw->KW', X_aaaa, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,KWwi,xwyz->KW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,KWwi,xwzy->KW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/3 * einsum('ixyz,KiwW,xwyz->KW', X_abab, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,KiwW,xwzy->KW', X_abab, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kiwu,Wxwuyz->KW', X_abab, v_xxaa, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kiwu,Wxwuzy->KW', X_abab, v_xxaa, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kiwu,Wxwyuz->KW', X_abab, v_xxaa, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kiwu,Wxwzuy->KW', X_abab, v_xxaa, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kiwu,Wxwzyu->KW', X_abab, v_xxaa, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kwui,Wxuwyz->KW', X_abab, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kwui,Wxuywz->KW', X_abab, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kwui,Wxuzwy->KW', X_abab, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa += 1/2 * einsum('ixyz,KWwi,xy->KW', X_abab, v_xaax, rdm_ca, optimize = einsum_type)
sigma_KW_aa -= 1/2 * einsum('ixyz,KWwi,xz->KW', X_abab, v_xaax, rdm_ca, optimize = einsum_type)
sigma_KW_aa -= 1/2 * einsum('ixyz,KiwW,xy->KW', X_abab, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_KW_aa += 1/3 * einsum('ixyz,Kiwu,Wxuy->KW', X_abab, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kiwu,Wxuz->KW', X_abab, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kiwu,Wxyu->KW', X_abab, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/3 * einsum('ixyz,Kiwu,Wxzu->KW', X_abab, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/2 * einsum('ixyz,Kiwu,xu->KW', X_abab, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_KW_aa -= 1/2 * einsum('ixyz,Kiwu,xwyu->KW', X_abab, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/3 * einsum('ixyz,Kwui,Wxwy->KW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kwui,Wxwz->KW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kwui,Wxyw->KW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kwui,Wxzw->KW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kwui,xuwy->KW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kwui,xuyw->KW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/2 * einsum('ixyz,Kwui,xw->KW', X_abab, v_xaax, rdm_ca, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,KWwi,xwyz->KW', X_abba, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/3 * einsum('ixyz,KWwi,xwzy->KW', X_abba, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,KiwW,xwyz->KW', X_abba, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/3 * einsum('ixyz,KiwW,xwzy->KW', X_abba, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/3 * einsum('ixyz,Kiwu,Wxwyzu->KW', X_abba, v_xxaa, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kiwu,Wxwzyu->KW', X_abba, v_xxaa, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa -= 1/12 * einsum('ixyz,Kwui,Wxuwzy->KW', X_abba, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa += 1/12 * einsum('ixyz,Kwui,Wxuywz->KW', X_abba, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kwui,Wxuyzw->KW', X_abba, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa += 1/12 * einsum('ixyz,Kwui,Wxuzyw->KW', X_abba, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa -= 1/2 * einsum('ixyz,KWwi,xz->KW', X_abba, v_xaax, rdm_ca, optimize = einsum_type)
sigma_KW_aa += 1/2 * einsum('ixyz,KiwW,xz->KW', X_abba, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kiwu,Wxuy->KW', X_abba, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/3 * einsum('ixyz,Kiwu,Wxuz->KW', X_abba, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/3 * einsum('ixyz,Kiwu,Wxyu->KW', X_abba, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kiwu,Wxzu->KW', X_abba, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/2 * einsum('ixyz,Kiwu,xu->KW', X_abba, v_xxaa, rdm_ca, optimize = einsum_type)
sigma_KW_aa += 1/2 * einsum('ixyz,Kiwu,xwzu->KW', X_abba, v_xxaa, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/3 * einsum('ixyz,Kwui,Wxwz->KW', X_abba, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kwui,Wxzw->KW', X_abba, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kwui,xuwz->KW', X_abba, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/3 * einsum('ixyz,Kwui,xuzw->KW', X_abba, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/3 * einsum('ixyz,KWwi,xwyz->KW', X_baba, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,KWwi,xwzy->KW', X_baba, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kwui,Wxuwyz->KW', X_baba, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa += 1/12 * einsum('ixyz,Kwui,Wxuwzy->KW', X_baba, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa -= 1/12 * einsum('ixyz,Kwui,Wxuywz->KW', X_baba, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa += 1/12 * einsum('ixyz,Kwui,Wxuzyw->KW', X_baba, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa += 1/2 * einsum('ixyz,KWwi,xy->KW', X_baba, v_xaax, rdm_ca, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kwui,Wxwy->KW', X_baba, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kwui,Wxyw->KW', X_baba, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/3 * einsum('ixyz,Kwui,xuwz->KW', X_baba, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kwui,xuzw->KW', X_baba, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/2 * einsum('ixyz,Kwui,xw->KW', X_baba, v_xaax, rdm_ca, optimize = einsum_type)
sigma_KW_aa -= 1/12 * einsum('ixyz,KWwi,xwyz->KW', X_bbbb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/12 * einsum('ixyz,KWwi,xwzy->KW', X_bbbb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/12 * einsum('ixyz,Kwui,Wxuwyz->KW', X_bbbb, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa -= 1/24 * einsum('ixyz,Kwui,Wxuwzy->KW', X_bbbb, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa += 1/24 * einsum('ixyz,Kwui,Wxuywz->KW', X_bbbb, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa += 1/24 * einsum('ixyz,Kwui,Wxuzyw->KW', X_bbbb, v_xaax, rdm_cccaaa, optimize = einsum_type)
sigma_KW_aa -= 1/2 * einsum('ixyz,KWyi,xz->KW', X_bbbb, v_xaax, rdm_ca, optimize = einsum_type)
sigma_KW_aa += 1/3 * einsum('ixyz,Kwyi,Wxwz->KW', X_bbbb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kwyi,Wxzw->KW', X_bbbb, v_xaax, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/12 * einsum('ixyz,Kiwu,wu,Wxyz->KW', X_aaaa, v_xxaa, rdm_ca, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/12 * einsum('ixyz,Kiwu,wu,Wxzy->KW', X_aaaa, v_xxaa, rdm_ca, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/24 * einsum('ixyz,Kwui,uw,Wxyz->KW', X_aaaa, v_xaax, rdm_ca, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/24 * einsum('ixyz,Kwui,uw,Wxzy->KW', X_aaaa, v_xaax, rdm_ca, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/2 * einsum('ixWy,Kizw,zw,xy->KW', X_aaaa, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
sigma_KW_aa += 1/4 * einsum('ixWy,Kzwi,wz,xy->KW', X_aaaa, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kiwu,wu,Wxyz->KW', X_abab, v_xxaa, rdm_ca, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/3 * einsum('ixyz,Kiwu,wu,Wxzy->KW', X_abab, v_xxaa, rdm_ca, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/12 * einsum('ixyz,Kwui,uw,Wxyz->KW', X_abab, v_xaax, rdm_ca, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kwui,uw,Wxzy->KW', X_abab, v_xaax, rdm_ca, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/2 * einsum('ixyz,Kiwu,wu,xy->KW', X_abab, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
sigma_KW_aa -= 1/4 * einsum('ixyz,Kwui,uw,xy->KW', X_abab, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
sigma_KW_aa += 1/3 * einsum('ixyz,Kiwu,wu,Wxyz->KW', X_abba, v_xxaa, rdm_ca, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa += 1/6 * einsum('ixyz,Kiwu,wu,Wxzy->KW', X_abba, v_xxaa, rdm_ca, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/6 * einsum('ixyz,Kwui,uw,Wxyz->KW', X_abba, v_xaax, rdm_ca, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/12 * einsum('ixyz,Kwui,uw,Wxzy->KW', X_abba, v_xaax, rdm_ca, rdm_ccaa, optimize = einsum_type)
sigma_KW_aa -= 1/2 * einsum('ixyz,Kiwu,wu,xz->KW', X_abba, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
sigma_KW_aa += 1/4 * einsum('ixyz,Kwui,uw,xz->KW', X_abba, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
----------------------------------------------------------------------------------------------------
> Total elapsed time: 936.63 seconds.
