        temp -= einsum('Xa,IYJa->IXJY', t1_ae, v_cace_so[:ncvs_so,:,:ncvs_so,:], optimize = einsum_type)
        temp -= einsum('Ya,JXIa->IXJY', t1_ae, v_cace_so[:ncvs_so,:,:ncvs_so,:], optimize = einsum_type)
        temp += einsum('Xa,IJ,Ya->IXJY', h_ae_so, np.identity(ncvs_so), t1_ae, optimize = einsum_type)
        temp += einsum('Ya,IJ,Xa->IXJY', h_ae_so, np.identity(ncvs_so), t1_ae, optimize = einsum_type)
        temp += einsum('a,IJ,Xa,Ya->IXJY', e_extern_so, np.identity(ncvs_so), t1_ae, t1_ae, optimize = einsum_type)
        temp -= 0.5 * einsum('Xx,IJ,xa,Ya->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_ae, optimize = einsum_type)
        temp -= 0.5 * einsum('Yx,IJ,xa,Xa->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_ae, optimize = einsum_type)
        temp += einsum('XxaY,IyJa,xy->IXJY', t1_aaea, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ca_so, optimize = einsum_type)
        temp -= einsum('Xxay,IYJa,xy->IXJY', t1_aaea, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ca_so, optimize = einsum_type)
        temp += einsum('Xa,IxJa,Yx->IXJY', t1_ae, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ca_so, optimize = einsum_type)
        temp += einsum('YxaX,JyIa,yx->IXJY', t1_aaea, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ca_so, optimize = einsum_type)
        temp -= einsum('Yxay,JXIa,yx->IXJY', t1_aaea, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ca_so, optimize = einsum_type)
        temp += einsum('Ya,JxIa,xX->IXJY', t1_ae, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ca_so, optimize = einsum_type)
        temp += einsum('xa,IYJa,xX->IXJY', t1_ae, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ca_so, optimize = einsum_type)
        temp += einsum('xa,JXIa,Yx->IXJY', t1_ae, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ca_so, optimize = einsum_type)
        temp += einsum('Xa,IJ,Yxay,yx->IXJY', h_ae_so, np.identity(ncvs_so), t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp += einsum('Ya,IJ,Xxay,xy->IXJY', h_ae_so, np.identity(ncvs_so), t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp -= einsum('Ya,IJ,xa,xX->IXJY', h_ae_so, np.identity(ncvs_so), t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= einsum('xa,IJ,XyaY,yx->IXJY', h_ae_so, np.identity(ncvs_so), t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp -= einsum('xa,IJ,Ya,xX->IXJY', h_ae_so, np.identity(ncvs_so), t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= einsum('xa,IJ,YyaX,xy->IXJY', h_ae_so, np.identity(ncvs_so), t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp -= einsum('IJ,Xxay,Yzya,xz->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_ca_so, optimize = einsum_type)
        temp -= einsum('IJ,Xa,Yxya,yx->IXJY', np.identity(ncvs_so), t1_ae, v_aaae_so, rdm_ca_so, optimize = einsum_type)
        temp -= einsum('IJ,Yxay,Xzya,zx->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_ca_so, optimize = einsum_type)
        temp -= einsum('IJ,Ya,Xyxa,yx->IXJY', np.identity(ncvs_so), t1_ae, v_aaae_so, rdm_ca_so, optimize = einsum_type)
        temp += einsum('IJ,xa,XyYa,yx->IXJY', np.identity(ncvs_so), t1_ae, v_aaae_so, rdm_ca_so, optimize = einsum_type)
        temp += einsum('IJ,xa,YyXa,xy->IXJY', np.identity(ncvs_so), t1_ae, v_aaae_so, rdm_ca_so, optimize = einsum_type)
        temp -= einsum('XY,xa,JyIa,yx->IXJY', np.identity(ncas_so), t1_ae, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ca_so, optimize = einsum_type)
        temp -= einsum('XY,xa,IyJa,xy->IXJY', np.identity(ncas_so), t1_ae, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ca_so, optimize = einsum_type)
        temp += einsum('a,IJ,Xa,Yxay,yx->IXJY', e_extern_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp -= einsum('a,IJ,XxaY,ya,xy->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp += einsum('a,IJ,Xxay,Ya,xy->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp += einsum('a,IJ,Xxay,Yzay,xz->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp -= einsum('a,IJ,xa,Ya,xX->IXJY', e_extern_so, np.identity(ncvs_so), t1_ae, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= einsum('a,IJ,xa,YyaX,xy->IXJY', e_extern_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('Xx,IJ,Yyax,za,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp += 0.5 * einsum('Xx,IJ,xyaY,za,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('Xx,IJ,xyaz,Ya,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('Xx,IJ,xyaz,Ywaz,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('Xx,IJ,xa,Yyaz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('Yx,IJ,Xyax,za,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp += 0.5 * einsum('Yx,IJ,xyaX,za,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('Yx,IJ,xyaz,Xa,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('Yx,IJ,xyaz,Xwaz,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('Yx,IJ,xa,Xyaz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp += 0.5 * einsum('Yx,IJ,xa,ya,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp += 0.5 * einsum('xy,IJ,XxaY,za,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('xy,IJ,Xxaz,Ya,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('xy,IJ,Xxaz,Ywaz,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp += 0.5 * einsum('xy,IJ,Xzax,Ya,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp += einsum('xy,IJ,Xzax,Yway,zw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp += 0.5 * einsum('xy,IJ,YxaX,za,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('xy,IJ,Yxaz,Xa,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('xy,IJ,Yxaz,Xwaz,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp += 0.5 * einsum('xy,IJ,Yzax,Xa,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp += 0.5 * einsum('xy,IJ,xa,XzaY,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp += 0.5 * einsum('xy,IJ,xa,Ya,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp += 0.5 * einsum('xy,IJ,xa,YzaX,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,XxYy,xa,za,zy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,XxYy,ya,za,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,Xxyz,Yway,za,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,Xxyz,yzaY,wa,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,Xxyz,yzaw,Ya,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,Xxyz,yzaw,Yuaw,xu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,Xxyz,ya,Ya,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,Yxyz,Xway,za,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,Yxyz,yzaX,wa,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,Yxyz,yzaw,Xa,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,Yxyz,yzaw,Xuaw,ux->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,Yxyz,ya,Xa,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_ae, rdm_ca_so, optimize = einsum_type)
        temp += einsum('Xxay,IzJa,Yxyz->IXJY', t1_aaea, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ccaa_so, optimize = einsum_type)
        temp += einsum('Yxay,JzIa,yzXx->IXJY', t1_aaea, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('xyaX,JzIa,Yzxy->IXJY', t1_aaea, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('xyaY,IzJa,xyXz->IXJY', t1_aaea, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('xyaz,IYJa,xyXz->IXJY', t1_aaea, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('xyaz,JXIa,Yzxy->IXJY', t1_aaea, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ccaa_so, optimize = einsum_type)
        temp -= einsum('xa,JyIa,YyXx->IXJY', t1_ae, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ccaa_so, optimize = einsum_type)
        temp -= einsum('xa,IyJa,YxXy->IXJY', t1_ae, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('Ya,IJ,xyaz,xyXz->IXJY', h_ae_so, np.identity(ncvs_so), t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += einsum('xa,IJ,Yyaz,xzXy->IXJY', h_ae_so, np.identity(ncvs_so), t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('xa,IJ,yzaY,yzXx->IXJY', h_ae_so, np.identity(ncvs_so), t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,XxaY,yzwa,xwyz->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_ccaa_so, optimize = einsum_type)
        temp += einsum('IJ,Xxay,Yzwa,xwyz->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,YxaX,zwya,zwxy->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,Yxay,zwya,zwXx->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_ccaa_so, optimize = einsum_type)
        temp += einsum('IJ,Yxay,Xwza,ywxz->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,Ya,yzxa,yzXx->IXJY', np.identity(ncvs_so), t1_ae, v_aaae_so, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xyaX,zwYa,zwxy->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xyaY,zwXa,xyzw->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,xyaz,XwYa,zwxy->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,xyaz,YwXa,xyzw->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,xyaz,Ywza,xyXw->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,xa,yzYa,yzXx->IXJY', np.identity(ncvs_so), t1_ae, v_aaae_so, rdm_ccaa_so, optimize = einsum_type)
        temp -= einsum('IJ,xa,Yyza,xzXy->IXJY', np.identity(ncvs_so), t1_ae, v_aaae_so, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('XY,xyaz,JwIa,zwxy->IXJY', np.identity(ncas_so), t1_aaea, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('XY,xyaz,IwJa,xyzw->IXJY', np.identity(ncas_so), t1_aaea, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('a,IJ,XxaY,yzaw,xwyz->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= einsum('a,IJ,Xxay,Yzaw,xwyz->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += einsum('a,IJ,xa,Yyaz,xzXy->IXJY', e_extern_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('a,IJ,xyaY,za,xyXz->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('a,IJ,xyaY,zwaX,xyzw->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('a,IJ,xyaz,Ya,xyXz->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('a,IJ,xyaz,YwaX,xyzw->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('a,IJ,xyaz,Ywaz,xyXw->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('Xx,IJ,Yyax,zwau,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('Xx,IJ,xyaY,zwau,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('Xx,IJ,xyaz,Ywau,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('Xx,IJ,yzax,wuaY,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('Yx,IJ,Xyax,zwau,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('Yx,IJ,xyaX,zwau,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('Yx,IJ,xyaz,Xwau,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('Yx,IJ,xyaz,wa,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('Yx,IJ,xyaz,wuaz,wuXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('Yx,IJ,xa,yzaw,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('Yx,IJ,yzax,wa,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('Yx,IJ,yzax,wuaX,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('xy,IJ,XxaY,zwau,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('xy,IJ,Xxaz,Ywau,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('xy,IJ,Xzax,Ywau,zuyw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('xy,IJ,YxaX,zwau,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('xy,IJ,Yxaz,Xwau,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('xy,IJ,Yxaz,wa,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('xy,IJ,Yxaz,wuaz,wuXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('xy,IJ,Yzax,Xwau,ywzu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('xy,IJ,Yzax,wa,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('xy,IJ,Yzax,wuay,wuXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('xy,IJ,xzaX,wuaY,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('xy,IJ,xzaY,wa,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('xy,IJ,xzaY,wuaX,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('xy,IJ,xzaw,XuaY,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('xy,IJ,xzaw,Ya,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('xy,IJ,xzaw,YuaX,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('xy,IJ,xzaw,Yuaw,yzXu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('xy,IJ,xa,Yzaw,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('xy,IJ,xa,zwaY,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('xy,IJ,zwax,XuaY,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('xy,IJ,zwax,Ya,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('xy,IJ,zwax,YuaX,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,XxYy,xzaw,ua,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,XxYy,xzaw,uvaw,uvyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,XxYy,xa,zwau,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,XxYy,yzaw,ua,xzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,XxYy,yzaw,uvaw,xzuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,XxYy,ya,zwau,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,XxYy,zwax,ua,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,XxYy,zwax,uvay,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,XxYy,zway,ua,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,Xxyz,Yxaw,ua,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,Xxyz,Yxaw,uvaw,uvyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,Xxyz,Yway,zuav,xuwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,Xxyz,Yway,ua,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,Xxyz,xa,wuaY,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,Xxyz,yzaY,wuav,xvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,Xxyz,yzaw,Yuav,xvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,Xxyz,ywaY,ua,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,Xxyz,ywaY,uvaz,xwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,Xxyz,ywau,Ya,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,Xxyz,ywau,Yvau,xwzv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,Xxyz,ya,Ywau,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,Xxyz,wuax,Ya,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,Xxyz,wuax,Yvay,wuzv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,Yxyz,Xxaw,ua,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,Yxyz,Xxaw,uvaw,yzuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,Yxyz,Xway,zuav,wvxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,Yxyz,Xway,ua,zwxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,Yxyz,xa,wa,yzXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,Yxyz,xa,wuaX,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,Yxyz,yzaX,wuav,wuxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,Yxyz,yzaw,Xuav,wuxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,Yxyz,yzaw,ua,wuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,Yxyz,yzaw,uvaw,uvXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,Yxyz,ywaX,ua,zuxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,Yxyz,ywaX,uvaz,uvxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,Yxyz,ywau,Xa,zuxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,Yxyz,ywau,Xvau,zvxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,Yxyz,ya,Xwau,zwxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,Yxyz,ya,wa,zwXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,Yxyz,ya,wuaz,wuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,Yxyz,wuax,Xa,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,Yxyz,wuax,Xvay,zvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyzw,XxaY,ua,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,xyzw,XxaY,uvay,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xyzw,Xxau,Ya,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyzw,Xxau,Yvay,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xyzw,Xxau,Yvau,zwyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyzw,Xuax,Yyav,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyzw,Xuax,Ya,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,Xuax,Yvaz,yuwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyzw,YxaX,ua,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,xyzw,YxaX,uvay,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xyzw,Yxau,Xa,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xyzw,Yxau,Xvau,yvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyzw,Yuax,Xa,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyzw,Yuax,ya,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.0625 * einsum('IJ,xyzw,xyaX,uvaY,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,xyzw,xyaY,ua,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.0625 * einsum('IJ,xyzw,xyaY,uvaX,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,xyzw,xyau,XvaY,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,xyzw,xyau,Ya,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,xyzw,xyau,YvaX,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,xyzw,xyau,Yvau,zwXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyzw,xa,XuaY,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xyzw,xa,Ya,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_ae, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyzw,xa,YuaX,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('xyaz,JwIa,YzwXxy->IXJY', t1_aaea, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('xyaz,IwJa,YxyXzw->IXJY', t1_aaea, v_cace_so[:ncvs_so,:,:ncvs_so,:], rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,Yxay,wuza,ywuXxz->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyaY,zwua,xyuXzw->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyaz,wuYa,zwuXxy->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,xyaz,Ywua,xyuXzw->IXJY', np.identity(ncvs_so), t1_aaea, v_aaae_so, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('a,IJ,xyaY,zwau,xyuXzw->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('a,IJ,xyaz,Ywau,xyuXzw->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('Yx,IJ,xyaz,wuav,zwuXyv->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('Yx,IJ,yzax,wuav,yzvXwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('xy,IJ,Yxaz,wuav,zwuXyv->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('xy,IJ,Yzax,wuav,ywuXzv->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('xy,IJ,xzaY,wuav,yzvXwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('xy,IJ,xzaw,Yuav,yzvXwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('xy,IJ,xzaw,uvaY,wuvXyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('xy,IJ,zwax,Yuav,zwvXyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('xy,IJ,zwax,uvaY,yuvXzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,XxYy,xzaw,uvas,wuvyzs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,XxYy,yzaw,uvas,xzswuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,XxYy,zwax,uvas,zwsyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,XxYy,zway,uvas,xuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,Xxyz,Yxaw,uvas,wuvyzs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,Xxyz,Yway,uvas,xuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,Xxyz,xwau,vsaY,uvsyzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,Xxyz,ywaY,uvas,xwszuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,Xxyz,ywau,Yvas,xwszuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,Xxyz,wuax,Yvas,wusyzv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,Xxyz,wuay,vsaY,xvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,Yxyz,Xxaw,uvas,yzswuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,Yxyz,Xway,uvas,zwsxuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,Yxyz,xwau,va,yzwXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,Yxyz,xwau,vsaX,yzwuvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,Yxyz,xwau,vsau,yzwXvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,Yxyz,xa,wuav,yzvXwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,Yxyz,yzaw,uvas,wuvXxs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,Yxyz,ywaX,uvas,zuvxws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.5 * einsum('IJ,Yxyz,ywau,Xvas,zuvxws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,Yxyz,ywau,va,zuvXxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,Yxyz,ywau,vsaz,uvsXxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,Yxyz,ywau,vsau,zvsXxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,Yxyz,ya,wuav,zwuXxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,Yxyz,wuax,Xvas,yzvwus->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,Yxyz,wuax,va,yzvXwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,Yxyz,wuax,vsay,zvsXwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,Yxyz,wuay,va,zwuXxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,Yxyz,wuay,vsaX,zwuxvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,xyzw,XxaY,uvas,zwsyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xyzw,Xxau,Yvas,zwsyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyzw,Xuax,Yvas,yuszwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,xyzw,YxaX,uvas,yuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xyzw,Yxau,Xvas,yuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyzw,Yxau,va,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,xyzw,Yxau,vsay,uvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,xyzw,Yxau,vsau,yvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyzw,Yuax,Xvas,zwvyus->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyzw,Yuax,yvas,zwvXus->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xyzw,Yuax,va,zwvXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.5 * einsum('IJ,xyzw,Yuax,vsaz,wvsXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.0625 * einsum('IJ,xyzw,xyaY,uvas,zwsXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,xyzw,xyau,Yvas,zwsXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.0625 * einsum('IJ,xyzw,xyau,vsaY,uvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,xyzw,xuaX,vsaY,yvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.25 * einsum('IJ,xyzw,xuaY,va,zwuXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,xyzw,xuaY,vsaX,zwuyvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,xyzw,xuaY,vsay,zwuXvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xyzw,xuav,XsaY,yvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xyzw,xuav,Ya,zwuXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xyzw,xuav,YsaX,zwuyvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xyzw,xuav,Ysav,zwuXys->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xyzw,xa,Yuav,zwvXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,xyzw,xa,uvaY,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,xyzw,uvax,XsaY,zwsyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,xyzw,uvax,Ya,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,xyzw,uvax,YsaX,yuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,Yxau,vsat,uvsXtx->IXJY', np.identity(ncvs_so), t1_aaea, t1_aaea, m_00_int3, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,Yuax,vsat,tuXsvx->IXJY', np.identity(ncvs_so), t1_aaea, t1_aaea, m_00_int3, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,xuaY,vsat,svXtux->IXJY', np.identity(ncvs_so), t1_aaea, t1_aaea, m_00_int3, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,xuav,Ysat,svXtux->IXJY', np.identity(ncvs_so), t1_aaea, t1_aaea, m_00_int3, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,xuav,staY,vstXux->IXJY', np.identity(ncvs_so), t1_aaea, t1_aaea, m_00_int3, optimize = einsum_type)
        temp -= 0.125 * einsum('IJ,uvax,Ysat,uvtXsx->IXJY', np.identity(ncvs_so), t1_aaea, t1_aaea, m_00_int3, optimize = einsum_type)
        temp -= 0.0625 * einsum('IJ,uvax,staY,vuXtsx->IXJY', np.identity(ncvs_so), t1_aaea, t1_aaea, m_00_int3, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,Yxyz,xwau,yzwXua->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, m_00_int5, optimize = einsum_type)
        temp -= 0.25 * einsum('IJ,Yxyz,ywau,wxXuza->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, m_00_int5, optimize = einsum_type)
        temp -= 0.0625 * einsum('IJ,Yxyz,wuax,uwXzya->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, m_00_int5, optimize = einsum_type)
        temp += 0.125 * einsum('IJ,Yxyz,wuay,zwuXxa->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, m_00_int5, optimize = einsum_type)
