temp  = einsum('Xx,IJ,Yx->IXJY', h_aa_so, np.identity(ncvs_so), t2_aa, optimize = einsum_type)
temp -= einsum('Yx,IJ,xX->IXJY', h_aa_so, np.identity(ncvs_so), t2_aa, optimize = einsum_type)
temp += einsum('Yx,IJ,xy,yX->IXJY', h_aa_so, np.identity(ncvs_so), t2_aa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IJ,Yx,yX->IXJY', h_aa_so, np.identity(ncvs_so), t2_aa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Yx,Xyxz,yz->IXJY', np.identity(ncvs_so), t2_aa, v_aaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,xX,Yyxz,zy->IXJY', np.identity(ncvs_so), t2_aa, v_aaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,xy,XxYz,yz->IXJY', np.identity(ncvs_so), t2_aa, v_aaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,xy,XzYy,zx->IXJY', np.identity(ncvs_so), t2_aa, v_aaaa_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yx,xyzw,zwXy->IXJY', np.identity(ncvs_so), t2_aa, v_aaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,xy,Yyzw,zwXx->IXJY', np.identity(ncvs_so), t2_aa, v_aaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,xy,Yzxw,ywXz->IXJY', np.identity(ncvs_so), t2_aa, v_aaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp =- 1/2 * einsum('XY,Iiab,Jiab->IXJY', np.identity(ncas_so), t1_xxee, v_xxee_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,Iiab,Jiab->IXJY', np.identity(ncas_so), t1_xvee, v_xvee_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,Jiab,Iiab->IXJY', np.identity(ncas_so), t1_xxee, v_xxee_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,Jiab,Iiab->IXJY', np.identity(ncas_so), t1_xvee, v_xvee_so, optimize = einsum_type)
temp += 1/4 * einsum('I,XY,Iiab,Jiab->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxee, t1_xxee, optimize = einsum_type)
temp += 1/4 * einsum('I,XY,Iiab,Jiab->IXJY', e_cvs_so, np.identity(ncas_so), t1_xvee, t1_xvee, optimize = einsum_type)
temp += 1/4 * einsum('J,XY,Iiab,Jiab->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxee, t1_xxee, optimize = einsum_type)
temp += 1/4 * einsum('J,XY,Iiab,Jiab->IXJY', e_cvs_so, np.identity(ncas_so), t1_xvee, t1_xvee, optimize = einsum_type)
temp += 1/4 * einsum('i,XY,Iiab,Jiab->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxee, t1_xxee, optimize = einsum_type)
temp += 1/4 * einsum('i,XY,Jiab,Iiab->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxee, t1_xxee, optimize = einsum_type)
temp += 1/4 * einsum('i,XY,Iiab,Jiab->IXJY', e_val_so, np.identity(ncas_so), t1_xvee, t1_xvee, optimize = einsum_type)
temp += 1/4 * einsum('i,XY,Jiab,Iiab->IXJY', e_val_so, np.identity(ncas_so), t1_xvee, t1_xvee, optimize = einsum_type)
temp -= einsum('a,XY,Jiab,Iiab->IXJY', e_extern_so, np.identity(ncas_so), t1_xxee, t1_xxee, optimize = einsum_type)
temp -= einsum('a,XY,Jiab,Iiab->IXJY', e_extern_so, np.identity(ncas_so), t1_xvee, t1_xvee, optimize = einsum_type)
temp += 1/2 * einsum('Iiab,Jiab,YX->IXJY', t1_xxee, v_xxee_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Iiab,Jiab,YX->IXJY', t1_xvee, v_xvee_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Jiab,Iiab,YX->IXJY', t1_xxee, v_xxee_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Jiab,Iiab,YX->IXJY', t1_xvee, v_xvee_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('I,Iiab,Jiab,YX->IXJY', e_cvs_so, t1_xxee, t1_xxee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('I,Iiab,Jiab,YX->IXJY', e_cvs_so, t1_xvee, t1_xvee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('J,Iiab,Jiab,YX->IXJY', e_cvs_so, t1_xxee, t1_xxee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('J,Iiab,Jiab,YX->IXJY', e_cvs_so, t1_xvee, t1_xvee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,Iiab,Jiab,YX->IXJY', e_cvs_so, t1_xxee, t1_xxee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,Jiab,Iiab,YX->IXJY', e_cvs_so, t1_xxee, t1_xxee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,Iiab,Jiab,YX->IXJY', e_val_so, t1_xvee, t1_xvee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,Jiab,Iiab,YX->IXJY', e_val_so, t1_xvee, t1_xvee, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,Jiab,Iiab,YX->IXJY', e_extern_so, t1_xxee, t1_xxee, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,Jiab,Iiab,YX->IXJY', e_extern_so, t1_xvee, t1_xvee, rdm_ca_so, optimize = einsum_type)
temp =- einsum('Ia,JXaY->IXJY', h_xe_so, t1_xaea, optimize = einsum_type)
temp -= einsum('Ja,IYaX->IXJY', h_xe_so, t1_xaea, optimize = einsum_type)
temp += einsum('IYax,JXxa->IXJY', t1_xaea, v_xaae_so, optimize = einsum_type)
temp += einsum('Ia,JXYa->IXJY', t1_xe, v_xaae_so, optimize = einsum_type)
temp += einsum('JXax,IYxa->IXJY', t1_xaea, v_xaae_so, optimize = einsum_type)
temp += einsum('Ja,IYXa->IXJY', t1_xe, v_xaae_so, optimize = einsum_type)
temp -= einsum('iXaY,IiJa->IXJY', t1_xaea, v_xxxe_so, optimize = einsum_type)
temp -= einsum('iYaX,JiIa->IXJY', t1_xaea, v_xxxe_so, optimize = einsum_type)
temp -= einsum('iXaY,IiJa->IXJY', t1_vaea, v_xvxe_so, optimize = einsum_type)
temp -= einsum('iYaX,JiIa->IXJY', t1_vaea, v_xvxe_so, optimize = einsum_type)
temp += 1/2 * einsum('I,IYaX,Ja->IXJY', e_cvs_so, t1_xaea, t1_xe, optimize = einsum_type)
temp += 1/2 * einsum('I,IYax,JXax->IXJY', e_cvs_so, t1_xaea, t1_xaea, optimize = einsum_type)
temp += 1/2 * einsum('I,Ia,JXaY->IXJY', e_cvs_so, t1_xe, t1_xaea, optimize = einsum_type)
temp += 1/2 * einsum('J,IYaX,Ja->IXJY', e_cvs_so, t1_xaea, t1_xe, optimize = einsum_type)
temp += 1/2 * einsum('J,IYax,JXax->IXJY', e_cvs_so, t1_xaea, t1_xaea, optimize = einsum_type)
temp += 1/2 * einsum('J,Ia,JXaY->IXJY', e_cvs_so, t1_xe, t1_xaea, optimize = einsum_type)
temp -= einsum('a,JXaY,Ia->IXJY', e_extern_so, t1_xaea, t1_xe, optimize = einsum_type)
temp -= einsum('a,JXax,IYax->IXJY', e_extern_so, t1_xaea, t1_xaea, optimize = einsum_type)
temp -= einsum('a,Ja,IYaX->IXJY', e_extern_so, t1_xe, t1_xaea, optimize = einsum_type)
temp -= einsum('Ia,XY,Ja->IXJY', h_xe_so, np.identity(ncas_so), t1_xe, optimize = einsum_type)
temp -= einsum('Ja,XY,Ia->IXJY', h_xe_so, np.identity(ncas_so), t1_xe, optimize = einsum_type)
temp += einsum('ia,IJ,iXaY->IXJY', h_xe_so, np.identity(ncvs_so), t1_xaea, optimize = einsum_type)
temp += einsum('ia,IJ,iYaX->IXJY', h_xe_so, np.identity(ncvs_so), t1_xaea, optimize = einsum_type)
temp += einsum('ia,IJ,iXaY->IXJY', h_ve_so, np.identity(ncvs_so), t1_vaea, optimize = einsum_type)
temp += einsum('ia,IJ,iYaX->IXJY', h_ve_so, np.identity(ncvs_so), t1_vaea, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IYax,Ja->IXJY', h_aa_so, t1_xaea, t1_xe, optimize = einsum_type)
temp += 1/2 * einsum('Xx,JxaY,Ia->IXJY', h_aa_so, t1_xaea, t1_xe, optimize = einsum_type)
temp += 1/2 * einsum('Xx,Jxay,IYay->IXJY', h_aa_so, t1_xaea, t1_xaea, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IxaX,Ja->IXJY', h_aa_so, t1_xaea, t1_xe, optimize = einsum_type)
temp += 1/2 * einsum('Yx,Ixay,JXay->IXJY', h_aa_so, t1_xaea, t1_xaea, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,JXax,Ia->IXJY', h_aa_so, t1_xaea, t1_xe, optimize = einsum_type)
temp -= einsum('xy,IYax,JXay->IXJY', h_aa_so, t1_xaea, t1_xaea, optimize = einsum_type)
temp -= einsum('IJ,iXax,iYxa->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, optimize = einsum_type)
temp -= einsum('IJ,iYax,iXxa->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, optimize = einsum_type)
temp -= einsum('IJ,ia,iYXa->IXJY', np.identity(ncvs_so), t1_xe, v_xaae_so, optimize = einsum_type)
temp -= einsum('IJ,ia,iXYa->IXJY', np.identity(ncvs_so), t1_xe, v_xaae_so, optimize = einsum_type)
temp -= einsum('IJ,iXax,iYxa->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, optimize = einsum_type)
temp -= einsum('IJ,iYax,iXxa->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, optimize = einsum_type)
temp -= einsum('IJ,ia,iYXa->IXJY', np.identity(ncvs_so), t1_ve, v_vaae_so, optimize = einsum_type)
temp -= einsum('IJ,ia,iXYa->IXJY', np.identity(ncvs_so), t1_ve, v_vaae_so, optimize = einsum_type)
temp -= einsum('XY,ia,IiJa->IXJY', np.identity(ncas_so), t1_xe, v_xxxe_so, optimize = einsum_type)
temp -= einsum('XY,ia,JiIa->IXJY', np.identity(ncas_so), t1_xe, v_xxxe_so, optimize = einsum_type)
temp -= einsum('XY,ia,IiJa->IXJY', np.identity(ncas_so), t1_ve, v_xvxe_so, optimize = einsum_type)
temp -= einsum('XY,ia,JiIa->IXJY', np.identity(ncas_so), t1_ve, v_xvxe_so, optimize = einsum_type)
temp += 1/2 * einsum('I,XY,Ia,Ja->IXJY', e_cvs_so, np.identity(ncas_so), t1_xe, t1_xe, optimize = einsum_type)
temp += 1/2 * einsum('J,XY,Ia,Ja->IXJY', e_cvs_so, np.identity(ncas_so), t1_xe, t1_xe, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iXaY,ia->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xe, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iXax,iYax->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iYaX,ia->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xe, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iYax,iXax->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ia,iXaY->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xe, t1_xaea, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ia,iYaX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xe, t1_xaea, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iXaY,ia->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_ve, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iXax,iYax->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iYaX,ia->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_ve, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iYax,iXax->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ia,iXaY->IXJY', e_val_so, np.identity(ncvs_so), t1_ve, t1_vaea, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ia,iYaX->IXJY', e_val_so, np.identity(ncvs_so), t1_ve, t1_vaea, optimize = einsum_type)
temp += einsum('a,IJ,iXaY,ia->IXJY', e_extern_so, np.identity(ncvs_so), t1_xaea, t1_xe, optimize = einsum_type)
temp += einsum('a,IJ,iXax,iYax->IXJY', e_extern_so, np.identity(ncvs_so), t1_xaea, t1_xaea, optimize = einsum_type)
temp += einsum('a,IJ,ia,iYaX->IXJY', e_extern_so, np.identity(ncvs_so), t1_xe, t1_xaea, optimize = einsum_type)
temp += einsum('a,IJ,iXaY,ia->IXJY', e_extern_so, np.identity(ncvs_so), t1_vaea, t1_ve, optimize = einsum_type)
temp += einsum('a,IJ,iXax,iYax->IXJY', e_extern_so, np.identity(ncvs_so), t1_vaea, t1_vaea, optimize = einsum_type)
temp += einsum('a,IJ,ia,iYaX->IXJY', e_extern_so, np.identity(ncvs_so), t1_ve, t1_vaea, optimize = einsum_type)
temp -= einsum('a,XY,Ja,Ia->IXJY', e_extern_so, np.identity(ncas_so), t1_xe, t1_xe, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,iYax,ia->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xe, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,ixaY,ia->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xe, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,ixay,iYay->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,iYax,ia->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_ve, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,ixaY,ia->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_ve, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,ixay,iYay->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iXax,ia->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xe, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ixaX,ia->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xe, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ixay,iXay->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iXax,ia->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_ve, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ixaX,ia->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_ve, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ixay,iXay->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, optimize = einsum_type)
temp += einsum('xy,IJ,iXax,iYay->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, optimize = einsum_type)
temp += einsum('xy,IJ,iXax,iYay->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, optimize = einsum_type)
temp += einsum('Ia,JXax,Yx->IXJY', h_xe_so, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('Ia,Ja,YX->IXJY', h_xe_so, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += einsum('Ia,JxaY,xX->IXJY', h_xe_so, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('Ja,IYax,xX->IXJY', h_xe_so, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('Ja,Ia,YX->IXJY', h_xe_so, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += einsum('Ja,IxaX,Yx->IXJY', h_xe_so, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('IYaX,Jxya,xy->IXJY', t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IYax,Jyxa,yX->IXJY', t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IYax,JXya,xy->IXJY', t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IxaX,JyYa,yx->IXJY', t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Ixay,JXYa,yx->IXJY', t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Ixay,JXya,Yx->IXJY', t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Ia,JxYa,xX->IXJY', t1_xe, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Ia,JXxa,Yx->IXJY', t1_xe, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('JXaY,Ixya,yx->IXJY', t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('JXax,IYya,yx->IXJY', t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('JXax,Iyxa,Yy->IXJY', t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('JxaY,IyXa,xy->IXJY', t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Jxay,IYXa,xy->IXJY', t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Jxay,IYya,xX->IXJY', t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Ja,IYxa,xX->IXJY', t1_xe, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Ja,IxXa,Yx->IXJY', t1_xe, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('iXax,IiJa,Yx->IXJY', t1_xaea, v_xxxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('iYax,JiIa,xX->IXJY', t1_xaea, v_xxxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ixaX,JiIa,Yx->IXJY', t1_xaea, v_xxxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ixaY,IiJa,xX->IXJY', t1_xaea, v_xxxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ia,IiJa,YX->IXJY', t1_xe, v_xxxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ia,JiIa,YX->IXJY', t1_xe, v_xxxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('iXax,IiJa,Yx->IXJY', t1_vaea, v_xvxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('iYax,JiIa,xX->IXJY', t1_vaea, v_xvxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ixaX,JiIa,Yx->IXJY', t1_vaea, v_xvxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ixaY,IiJa,xX->IXJY', t1_vaea, v_xvxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ia,IiJa,YX->IXJY', t1_ve, v_xvxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ia,JiIa,YX->IXJY', t1_ve, v_xvxe_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,IYaX,Jxay,xy->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,IYax,JXay,xy->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,IYax,Ja,xX->IXJY', e_cvs_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,IYax,Jyax,yX->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,IxaX,Ja,Yx->IXJY', e_cvs_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,IxaX,JyaY,yx->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,Ixay,JXaY,yx->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Ixay,JXay,Yx->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Ia,JXax,Yx->IXJY', e_cvs_so, t1_xe, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Ia,Ja,YX->IXJY', e_cvs_so, t1_xe, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Ia,JxaY,xX->IXJY', e_cvs_so, t1_xe, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,IYaX,Jxay,xy->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,IYax,JXay,xy->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,IYax,Ja,xX->IXJY', e_cvs_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,IYax,Jyax,yX->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,IxaX,Ja,Yx->IXJY', e_cvs_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,IxaX,JyaY,yx->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,Ixay,JXaY,yx->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Ixay,JXay,Yx->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Ia,JXax,Yx->IXJY', e_cvs_so, t1_xe, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Ia,Ja,YX->IXJY', e_cvs_so, t1_xe, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Ia,JxaY,xX->IXJY', e_cvs_so, t1_xe, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,JXaY,Ixay,yx->IXJY', e_extern_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,JXax,IYay,yx->IXJY', e_extern_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,JXax,Ia,Yx->IXJY', e_extern_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,JXax,Iyax,Yy->IXJY', e_extern_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,Ja,IYax,xX->IXJY', e_extern_so, t1_xe, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,Ja,Ia,YX->IXJY', e_extern_so, t1_xe, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,Ja,IxaX,Yx->IXJY', e_extern_so, t1_xe, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,JxaY,Ia,xX->IXJY', e_extern_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,JxaY,IyaX,xy->IXJY', e_extern_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,Jxay,IYaX,xy->IXJY', e_extern_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,Jxay,IYay,xX->IXJY', e_extern_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Ia,XY,Jxay,xy->IXJY', h_xe_so, np.identity(ncas_so), t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Ja,XY,Ixay,yx->IXJY', h_xe_so, np.identity(ncas_so), t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('ia,IJ,iYax,xX->IXJY', h_xe_so, np.identity(ncvs_so), t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('ia,IJ,ixaY,xX->IXJY', h_xe_so, np.identity(ncvs_so), t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('ia,IJ,iYax,xX->IXJY', h_ve_so, np.identity(ncvs_so), t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('ia,IJ,ixaY,xX->IXJY', h_ve_so, np.identity(ncvs_so), t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IYax,Jyaz,yz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,Iyax,Ja,Yy->IXJY', h_aa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,Iyax,JzaY,zy->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,JxaY,Iyaz,zy->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,Jxay,IYaz,zy->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,Jxay,Ia,Yy->IXJY', h_aa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,Jxay,Izay,Yz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IxaX,Jyaz,yz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,Ixay,JXaz,yz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,Ixay,Ja,yX->IXJY', h_aa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,Ixay,Jzay,zX->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,JXax,Iyaz,zy->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,Jyax,Ia,yX->IXJY', h_aa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,Jyax,IzaX,yz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IYax,JXaz,yz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IYax,Ja,yX->IXJY', h_aa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,IYax,Jzay,zX->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IxaX,Ja,Yy->IXJY', h_aa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IxaX,JzaY,zy->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Ixaz,JXaY,zy->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Ixaz,JXaz,Yy->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Izax,JXaY,yz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,Izax,JXay,Yz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,JXax,IYaz,zy->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,JXax,Ia,Yy->IXJY', h_aa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,JxaY,Ia,yX->IXJY', h_aa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,JxaY,IzaX,yz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Jxaz,IYaX,yz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jxaz,IYaz,yX->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jzax,IYaX,zy->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iXaY,ixya,yx->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,iXax,iYya,yx->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iYaX,ixya,xy->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,iYax,iyxa,yX->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,iYax,iXya,xy->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ixaX,iyYa,yx->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ixaY,iyXa,xy->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ixay,iYXa,xy->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ixay,iYya,xX->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ixay,iXYa,yx->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ia,iYxa,xX->IXJY', np.identity(ncvs_so), t1_xe, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ia,ixYa,xX->IXJY', np.identity(ncvs_so), t1_xe, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iXaY,ixya,yx->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,iXax,iYya,yx->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iYaX,ixya,xy->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,iYax,iyxa,yX->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,iYax,iXya,xy->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ixaX,iyYa,yx->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ixaY,iyXa,xy->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ixay,iYXa,xy->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ixay,iYya,xX->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ixay,iXYa,yx->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ia,iYxa,xX->IXJY', np.identity(ncvs_so), t1_ve, v_vaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ia,ixYa,xX->IXJY', np.identity(ncvs_so), t1_ve, v_vaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,Ixay,Jzya,zx->IXJY', np.identity(ncas_so), t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,Ia,Jxya,xy->IXJY', np.identity(ncas_so), t1_xe, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,Jxay,Izya,xz->IXJY', np.identity(ncas_so), t1_xaea, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,Ja,Ixya,yx->IXJY', np.identity(ncas_so), t1_xe, v_xaae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,ixay,IiJa,xy->IXJY', np.identity(ncas_so), t1_xaea, v_xxxe_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,ixay,JiIa,yx->IXJY', np.identity(ncas_so), t1_xaea, v_xxxe_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,ixay,IiJa,xy->IXJY', np.identity(ncas_so), t1_vaea, v_xvxe_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,ixay,JiIa,yx->IXJY', np.identity(ncas_so), t1_vaea, v_xvxe_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XxYy,Ixaz,Ja,zy->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XxYy,Ixaz,Jwaz,wy->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('XxYy,Izay,Ja,xz->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XxYy,Jyaz,Ia,xz->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XxYy,Jyaz,Iwaz,xw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('XxYy,Jzax,Ia,zy->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XxYy,Jzax,Iway,zw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,IYay,Jzaw,xw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,IYay,Ja,xz->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Iway,JzaY,xw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,JyaY,Ia,xz->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Jyaw,IYaw,xz->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Xxyz,Jwax,IYay,wz->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,IyaX,Ja,zx->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,IyaX,Jwaz,wx->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Iyaw,JXaz,wx->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Iyaw,JXaw,zx->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Yxyz,Iwax,JXay,zw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,JXay,Ia,zx->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xyzw,IYax,JXaz,wy->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,XY,Ixay,Ja,yx->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,XY,Ixay,Jzay,zx->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,XY,Ia,Jxay,xy->IXJY', e_cvs_so, np.identity(ncas_so), t1_xe, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,XY,Ixay,Ja,yx->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,XY,Ixay,Jzay,zx->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,XY,Ia,Jxay,xy->IXJY', e_cvs_so, np.identity(ncas_so), t1_xe, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iXaY,ixay,yx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iXax,iYay,yx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iYaX,ixay,xy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYax,iXay,xy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYax,ia,xX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYax,iyax,yX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixaX,iyaY,yx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixaY,ia,xX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixaY,iyaX,xy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ixay,iXaY,yx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ixay,iYaX,xy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixay,iYay,xX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ia,iYax,xX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xe, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ia,ixaY,xX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xe, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iXaY,ixay,yx->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iXax,iYay,yx->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iYaX,ixay,xy->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYax,iXay,xy->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYax,ia,xX->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_ve, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYax,iyax,yX->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixaX,iyaY,yx->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixaY,ia,xX->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_ve, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixaY,iyaX,xy->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ixay,iXaY,yx->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ixay,iYaX,xy->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixay,iYay,xX->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ia,iYax,xX->IXJY', e_val_so, np.identity(ncvs_so), t1_ve, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ia,ixaY,xX->IXJY', e_val_so, np.identity(ncvs_so), t1_ve, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,IJ,iXaY,ixay,yx->IXJY', e_extern_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,IJ,iXax,iYay,yx->IXJY', e_extern_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,IJ,ia,iYax,xX->IXJY', e_extern_so, np.identity(ncvs_so), t1_xe, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,IJ,ixaY,ia,xX->IXJY', e_extern_so, np.identity(ncvs_so), t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,IJ,ixaY,iyaX,xy->IXJY', e_extern_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,IJ,ixay,iYaX,xy->IXJY', e_extern_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,IJ,ixay,iYay,xX->IXJY', e_extern_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,IJ,iXaY,ixay,yx->IXJY', e_extern_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,IJ,iXax,iYay,yx->IXJY', e_extern_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,IJ,ia,iYax,xX->IXJY', e_extern_so, np.identity(ncvs_so), t1_ve, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,IJ,ixaY,ia,xX->IXJY', e_extern_so, np.identity(ncvs_so), t1_vaea, t1_ve, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,IJ,ixaY,iyaX,xy->IXJY', e_extern_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,IJ,ixay,iYaX,xy->IXJY', e_extern_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,IJ,ixay,iYay,xX->IXJY', e_extern_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,XY,Ja,Ixay,yx->IXJY', e_extern_so, np.identity(ncas_so), t1_xe, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,XY,Jxay,Ia,xy->IXJY', e_extern_so, np.identity(ncas_so), t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,XY,Jxay,Izay,xz->IXJY', e_extern_so, np.identity(ncas_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,iYax,iyaz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,ixaY,iyaz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,ixay,iYaz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,iyax,izaY,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,iYax,iyaz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,ixaY,iyaz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,ixay,iYaz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,iyax,izaY,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iXax,iyaz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ixaX,iyaz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ixay,iXaz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ixay,ia,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ixay,izay,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iyax,ia,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iyax,izaX,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iXax,iyaz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ixaX,iyaz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ixay,iXaz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ixay,ia,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_ve, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ixay,izay,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iyax,ia,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_ve, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iyax,izaX,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,iXax,iYaz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,iYax,iXaz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,iYax,ia,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IJ,iYax,izay,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixaX,izaY,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixaY,ia,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixaY,izaX,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixaz,iXaY,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixaz,iYaX,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixaz,iYaz,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izax,iXaY,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izax,iYaX,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,iXax,iYaz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,iYax,iXaz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,iYax,ia,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_ve, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IJ,iYax,izay,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixaX,izaY,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixaY,ia,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_ve, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixaY,izaX,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixaz,iXaY,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixaz,iYaX,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixaz,iYaz,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izax,iXaY,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izax,iYaX,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,XY,Ixaz,Ja,zy->IXJY', h_aa_so, np.identity(ncas_so), t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,XY,Ixaz,Jwaz,wy->IXJY', h_aa_so, np.identity(ncas_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,XY,Izax,Ja,yz->IXJY', h_aa_so, np.identity(ncas_so), t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,XY,Izax,Jway,wz->IXJY', h_aa_so, np.identity(ncas_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,XY,Jxaz,Ia,yz->IXJY', h_aa_so, np.identity(ncas_so), t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,XY,Jxaz,Iwaz,yw->IXJY', h_aa_so, np.identity(ncas_so), t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,XY,Jzax,Ia,zy->IXJY', h_aa_so, np.identity(ncas_so), t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,ixaz,ia,zy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,ixaz,iwaz,wy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,iyaz,ia,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,iyaz,iwaz,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,izax,ia,zy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,XxYy,izax,iway,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,izay,ia,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,ixaz,ia,zy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_ve, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,ixaz,iwaz,wy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,iyaz,ia,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_ve, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,iyaz,iwaz,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,izax,ia,zy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_ve, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,XxYy,izax,iway,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,izay,ia,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_ve, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iYay,izaw,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iYay,ia,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iyaY,ia,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iyaY,iwaz,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iyaw,iYaw,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Xxyz,iwax,iYay,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iYay,izaw,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iYay,ia,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_ve, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iyaY,ia,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_ve, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iyaY,iwaz,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iyaw,iYaw,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Xxyz,iwax,iYay,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iXay,izaw,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iXay,ia,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyaX,ia,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyaX,iwaz,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyaw,iXaw,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Yxyz,iwax,iXay,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iXay,izaw,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iXay,ia,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_ve, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyaX,ia,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_ve, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyaX,iwaz,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyaw,iXaw,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Yxyz,iwax,iXay,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,iXax,iYaz,yw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,iXax,iYaz,yw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Ia,Jxay,YxXy->IXJY', h_xe_so, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Ja,Ixay,YyXx->IXJY', h_xe_so, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IYax,Jyza,xyXz->IXJY', t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IxaX,Jyza,Yyxz->IXJY', t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Ixay,JzYa,yzXx->IXJY', t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Ixay,Jzya,YzXx->IXJY', t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Ixay,JXza,Yyxz->IXJY', t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Ia,Jxya,YxXy->IXJY', t1_xe, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('JXax,Iyza,Yzxy->IXJY', t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('JxaY,Iyza,xzXy->IXJY', t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Jxay,IYza,xzXy->IXJY', t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Jxay,IzXa,Yxyz->IXJY', t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Jxay,Izya,YxXz->IXJY', t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Ja,Ixya,YyXx->IXJY', t1_xe, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('ixay,IiJa,YxXy->IXJY', t1_xaea, v_xxxe_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('ixay,JiIa,YyXx->IXJY', t1_xaea, v_xxxe_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('ixay,IiJa,YxXy->IXJY', t1_vaea, v_xvxe_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('ixay,JiIa,YyXx->IXJY', t1_vaea, v_xvxe_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('I,IYax,Jyaz,xyXz->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('I,IxaX,Jyaz,Yyxz->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Ixay,JXaz,Yyxz->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('I,Ixay,Ja,YyXx->IXJY', e_cvs_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Ixay,JzaY,yzXx->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('I,Ixay,Jzay,YzXx->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('I,Ia,Jxay,YxXy->IXJY', e_cvs_so, t1_xe, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('J,IYax,Jyaz,xyXz->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('J,IxaX,Jyaz,Yyxz->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Ixay,JXaz,Yyxz->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('J,Ixay,Ja,YyXx->IXJY', e_cvs_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Ixay,JzaY,yzXx->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('J,Ixay,Jzay,YzXx->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('J,Ia,Jxay,YxXy->IXJY', e_cvs_so, t1_xe, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('a,JXax,Iyaz,Yzxy->IXJY', e_extern_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('a,Ja,Ixay,YyXx->IXJY', e_extern_so, t1_xe, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('a,JxaY,Iyaz,xzXy->IXJY', e_extern_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('a,Jxay,IYaz,xzXy->IXJY', e_extern_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('a,Jxay,Ia,YxXy->IXJY', e_extern_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('a,Jxay,IzaX,Yxyz->IXJY', e_extern_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('a,Jxay,Izay,YxXz->IXJY', e_extern_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,Iyax,Jzaw,Yzyw->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,Jxay,Izaw,Ywyz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,Ixay,Jzaw,yzXw->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,Jyax,Izaw,ywXz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IYax,Jzaw,yzXw->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IxaX,Jzaw,Yzyw->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Ixaz,JXaw,Yzyw->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Ixaz,Ja,YzXy->IXJY', h_aa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Ixaz,JwaY,zwXy->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Ixaz,Jwaz,YwXy->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Izax,JXaw,Yyzw->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Izax,Ja,YyXz->IXJY', h_aa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Izax,JwaY,ywXz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xy,Izax,Jway,YwXz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,JXax,Izaw,Ywyz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,JxaY,Izaw,ywXz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jxaz,IYaw,ywXz->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Jxaz,Ia,YyXz->IXJY', h_aa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jxaz,IwaX,Yyzw->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Jxaz,Iwaz,YyXw->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Jzax,IYaw,zwXy->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jzax,Ia,YzXy->IXJY', h_aa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Jzax,IwaX,Yzyw->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,iYax,iyza,xyXz->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,ixaY,iyza,xzXy->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,ixay,iYza,xzXy->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,ixay,izYa,yzXx->IXJY', np.identity(ncvs_so), t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,iYax,iyza,xyXz->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,ixaY,iyza,xzXy->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,ixay,iYza,xzXy->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,ixay,izYa,yzXx->IXJY', np.identity(ncvs_so), t1_vaea, v_vaae_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('XY,Ixay,Jzwa,yzxw->IXJY', np.identity(ncas_so), t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('XY,Jxay,Izwa,xwyz->IXJY', np.identity(ncas_so), t1_xaea, v_xaae_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('XxYy,Ixaz,Jwau,zwyu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('XxYy,Izay,Jwau,xwzu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('XxYy,Jyaz,Iwau,xuzw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('XxYy,Jzax,Iwau,zuyw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,IYay,Jwau,xwzu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Ixaw,Ja,Ywyz->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xxyz,Ixaw,JuaY,wuyz->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Ixaw,Juaw,Yuyz->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Iway,Jzau,Yxwu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Iway,Ja,Yxzw->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Iway,JuaY,xuzw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,JyaY,Iwau,xuzw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Jyaw,IYau,xuzw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Jyaw,Ia,Yxzw->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Jyaw,Iuaw,Yxzu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Jwax,IYau,wuyz->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xxyz,Jwax,Ia,Ywyz->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Xxyz,Jwax,Iuay,Ywzu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,IyaX,Jwau,zwxu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Iyaw,JXau,zwxu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Iyaw,Ja,zwXx->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Iyaw,Juaz,wuXx->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Iyaw,Juaw,zuXx->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Iwax,JXau,yzwu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yxyz,Iwax,Ja,yzXw->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Yxyz,Iwax,Juay,zuXw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,JXay,Iwau,zuxw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Jxaw,Ia,yzXw->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yxyz,Jxaw,IuaX,yzwu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Jxaw,Iuaw,yzXu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Jway,Ia,zwXx->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Jway,IuaX,zwxu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,IYax,JXau,zwyu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,IYax,Jyau,zwXu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,IYax,Ja,zwXy->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xyzw,IYax,Juaz,wuXy->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,IxaX,Ja,Yyzw->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,IxaX,JuaY,yuzw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,IxaX,Juay,Yuzw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Ixau,JXaY,yuzw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Ixau,JXay,Yuzw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Ixau,JXau,Yyzw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Iuax,JXaY,zwyu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xyzw,Iuax,JXaz,Ywyu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Iuax,JyaY,zwXu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,JXax,IYau,yuzw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,JXax,Ia,Yyzw->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,JxaY,Ia,zwXy->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,JxaY,IuaX,zwyu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Jxau,IYaX,zwyu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Jxau,IYau,zwXy->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Juax,IYaX,yuzw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,XY,Ixay,Jzaw,yzxw->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,XY,Ixay,Jzaw,yzxw->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iYax,iyaz,xyXz->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ixaY,iyaz,xzXy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixay,iYaz,xzXy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixay,izaY,yzXx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iYax,iyaz,xyXz->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ixaY,iyaz,xzXy->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixay,iYaz,xzXy->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixay,izaY,yzXx->IXJY', e_val_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('a,IJ,ixaY,iyaz,xzXy->IXJY', e_extern_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('a,IJ,ixay,iYaz,xzXy->IXJY', e_extern_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('a,IJ,ixaY,iyaz,xzXy->IXJY', e_extern_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('a,IJ,ixay,iYaz,xzXy->IXJY', e_extern_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('a,XY,Jxay,Izaw,xwyz->IXJY', e_extern_so, np.identity(ncas_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ixay,izaw,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iyax,izaw,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ixay,izaw,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iyax,izaw,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,iYax,izaw,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixaY,izaw,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixaz,iYaw,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixaz,iwaY,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izax,iYaw,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izax,iwaY,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,iYax,izaw,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixaY,izaw,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixaz,iYaw,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixaz,iwaY,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izax,iYaw,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izax,iwaY,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,XY,Ixaz,Jwau,zwyu->IXJY', h_aa_so, np.identity(ncas_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,XY,Izax,Jwau,ywzu->IXJY', h_aa_so, np.identity(ncas_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,XY,Jxaz,Iwau,yuzw->IXJY', h_aa_so, np.identity(ncas_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,XY,Jzax,Iwau,zuyw->IXJY', h_aa_so, np.identity(ncas_so), t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,ixaz,iwau,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,iyaz,iwau,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,izax,iwau,zuyw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,izay,iwau,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,ixaz,iwau,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,iyaz,iwau,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,izax,iwau,zuyw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,izay,iwau,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iYay,iwau,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,ixaw,iuaY,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iyaY,iwau,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iyaw,iYau,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,iwax,iYau,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iway,iuaY,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iYay,iwau,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,ixaw,iuaY,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iyaY,iwau,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iyaw,iYau,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,iwax,iYau,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iway,iuaY,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iXay,iwau,zuxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ixaw,ia,yzXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,ixaw,iuaX,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ixaw,iuaw,yzXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iyaX,iwau,zwxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyaw,iXau,zwxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iyaw,ia,zwXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyaw,iuaz,wuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iyaw,iuaw,zuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iwax,iXau,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwax,ia,yzXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,Yxyz,iwax,iuay,zuXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iway,ia,zwXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iway,iuaX,zwxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iXay,iwau,zuxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ixaw,ia,yzXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_ve, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,ixaw,iuaX,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ixaw,iuaw,yzXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iyaX,iwau,zwxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyaw,iXau,zwxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iyaw,ia,zwXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_ve, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyaw,iuaz,wuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iyaw,iuaw,zuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iwax,iXau,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwax,ia,yzXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_ve, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,Yxyz,iwax,iuay,zuXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iway,ia,zwXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_ve, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iway,iuaX,zwxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iXax,iYau,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iYax,iXau,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iYax,iyau,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iYax,ia,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,xyzw,iYax,iuaz,wuXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixaX,iuaY,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixaY,ia,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixaY,iuaX,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixaY,iuay,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixau,iXaY,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixau,iYaX,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixau,iYau,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuax,iXaY,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuax,iYaX,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iXax,iYau,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iYax,iXau,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iYax,iyau,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iYax,ia,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_ve, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,xyzw,iYax,iuaz,wuXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixaX,iuaY,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixaY,ia,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_ve, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixaY,iuaX,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixaY,iuay,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixau,iXaY,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixau,iYaX,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixau,iYau,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuax,iXaY,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuax,iYaX,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Ixau,Ja,yuzw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Ixau,Jvay,uvzw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Ixau,Jvau,yvzw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Iuax,Jyav,zwuv->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Iuax,Ja,zwyu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('XY,xyzw,Iuax,Jvaz,wvyu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Jxau,Ia,zwyu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Jxau,Ivau,zwyv->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Juax,Ia,yuzw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaea, t1_xe, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Ixay,Jzwa,YyzXxw->IXJY', t1_xaea, v_xaae_so, rdm_cccaaa_so, optimize = einsum_type)
temp += einsum('Jxay,Izwa,YxwXyz->IXJY', t1_xaea, v_xaae_so, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('I,Ixay,Jzaw,YyzXxw->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('J,Ixay,Jzaw,YyzXxw->IXJY', e_cvs_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= einsum('a,Jxay,Izaw,YxwXyz->IXJY', e_extern_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Ixaz,Jwau,YzwXyu->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Izax,Jwau,YywXzu->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Jxaz,Iwau,YyuXzw->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jzax,Iwau,YzuXyw->IXJY', h_aa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Ixaw,Juav,Ywuyzv->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Iway,Juav,Yxuzwv->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Jyaw,Iuav,Yxvzwu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xxyz,Jwax,Iuav,Ywvyzu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Iyaw,Juav,zwuXxv->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yxyz,Iwax,Juav,yzuXwv->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Jxaw,Iuav,yzvXwu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Jway,Iuav,zwvXxu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,IYax,Juav,zwuXyv->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,IxaX,Juav,Yyuzwv->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Ixau,JXav,Yyuzwv->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Ixau,Ja,YyuXzw->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Ixau,JvaY,yuvXzw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Ixau,Jvay,YuvXzw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Ixau,Jvau,YyvXzw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iuax,JXav,Yzwyuv->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iuax,Jyav,YzwXuv->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iuax,Ja,YzwXyu->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iuax,JvaY,zwvXyu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= einsum('xyzw,Iuax,Jvaz,YwvXyu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,JXax,Iuav,Yyvzwu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,JxaY,Iuav,zwvXyu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Jxau,IYav,zwvXyu->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Jxau,Ia,YzwXyu->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Jxau,IvaX,Yzwyuv->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Jxau,Ivau,YzwXyv->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Juax,IYav,yuvXzw->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Juax,Ia,YyuXzw->IXJY', v_aaaa_so, t1_xaea, t1_xe, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Juax,IvaX,Yyuzwv->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ixaw,iuav,yzvXwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iyaw,iuav,zwuXxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwax,iuav,yzuXwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iway,iuav,zwvXxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ixaw,iuav,yzvXwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iyaw,iuav,zwuXxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwax,iuav,yzuXwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iway,iuav,zwvXxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iYax,iuav,zwuXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixaY,iuav,zwvXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixau,iYav,zwvXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixau,ivaY,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuax,iYav,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuax,ivaY,zwvXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iYax,iuav,zwuXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixaY,iuav,zwvXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixau,iYav,zwvXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixau,ivaY,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuax,iYav,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuax,ivaY,zwvXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaea, t1_vaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Ixau,Jvas,yuvzws->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Iuax,Jvas,zwvyus->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Jxau,Ivas,zwsyuv->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Juax,Ivas,yuszwv->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaea, t1_xaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Ixau,Jvas,YyuvXzws->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Iuax,Jvas,YzwvXyus->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Jxau,Ivas,YzwsXyuv->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Juax,Ivas,YyusXzwv->IXJY', v_aaaa_so, t1_xaea, t1_xaea, rdm_ccccaaaa_so, optimize = einsum_type)
temp =- 1/2 * einsum('IYab,JXab->IXJY', t1_xaee, v_xaee_so, optimize = einsum_type)
temp -= 1/2 * einsum('JXab,IYab->IXJY', t1_xaee, v_xaee_so, optimize = einsum_type)
temp += 1/4 * einsum('I,IYab,JXab->IXJY', e_cvs_so, t1_xaee, t1_xaee, optimize = einsum_type)
temp += 1/4 * einsum('J,IYab,JXab->IXJY', e_cvs_so, t1_xaee, t1_xaee, optimize = einsum_type)
temp -= einsum('a,JXab,IYab->IXJY', e_extern_so, t1_xaee, t1_xaee, optimize = einsum_type)
temp += 1/4 * einsum('Xx,Jxab,IYab->IXJY', h_aa_so, t1_xaee, t1_xaee, optimize = einsum_type)
temp += 1/4 * einsum('Yx,Ixab,JXab->IXJY', h_aa_so, t1_xaee, t1_xaee, optimize = einsum_type)
temp += 1/2 * einsum('IJ,iXab,iYab->IXJY', np.identity(ncvs_so), t1_xaee, v_xaee_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,iXab,iYab->IXJY', np.identity(ncvs_so), t1_vaee, v_vaee_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,iYab,iXab->IXJY', np.identity(ncvs_so), t1_xaee, v_xaee_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,iYab,iXab->IXJY', np.identity(ncvs_so), t1_vaee, v_vaee_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,iXab,iYab->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaee, t1_xaee, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,iYab,iXab->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaee, t1_xaee, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,iXab,iYab->IXJY', e_val_so, np.identity(ncvs_so), t1_vaee, t1_vaee, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,iYab,iXab->IXJY', e_val_so, np.identity(ncvs_so), t1_vaee, t1_vaee, optimize = einsum_type)
temp += einsum('a,IJ,iXab,iYab->IXJY', e_extern_so, np.identity(ncvs_so), t1_xaee, t1_xaee, optimize = einsum_type)
temp += einsum('a,IJ,iXab,iYab->IXJY', e_extern_so, np.identity(ncvs_so), t1_vaee, t1_vaee, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,IJ,ixab,iYab->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaee, t1_xaee, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,IJ,ixab,iYab->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaee, t1_vaee, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,ixab,iXab->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaee, t1_xaee, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,ixab,iXab->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaee, t1_vaee, optimize = einsum_type)
temp += 1/2 * einsum('IYab,Jxab,xX->IXJY', t1_xaee, v_xaee_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Ixab,JXab,Yx->IXJY', t1_xaee, v_xaee_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('JXab,Ixab,Yx->IXJY', t1_xaee, v_xaee_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Jxab,IYab,xX->IXJY', t1_xaee, v_xaee_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('I,IYab,Jxab,xX->IXJY', e_cvs_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('I,Ixab,JXab,Yx->IXJY', e_cvs_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('J,IYab,Jxab,xX->IXJY', e_cvs_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('J,Ixab,JXab,Yx->IXJY', e_cvs_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,JXab,Ixab,Yx->IXJY', e_extern_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,Jxab,IYab,xX->IXJY', e_extern_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,Jxab,Iyab,Yy->IXJY', h_aa_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,Ixab,Jyab,yX->IXJY', h_aa_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,Ixab,JXab,Yy->IXJY', h_aa_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,Jxab,IYab,yX->IXJY', h_aa_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,iYab,ixab,xX->IXJY', np.identity(ncvs_so), t1_xaee, v_xaee_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,iYab,ixab,xX->IXJY', np.identity(ncvs_so), t1_vaee, v_vaee_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ixab,iYab,xX->IXJY', np.identity(ncvs_so), t1_xaee, v_xaee_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ixab,iYab,xX->IXJY', np.identity(ncvs_so), t1_vaee, v_vaee_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,Ixab,Jyab,yx->IXJY', np.identity(ncas_so), t1_xaee, v_xaee_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,Jxab,Iyab,xy->IXJY', np.identity(ncas_so), t1_xaee, v_xaee_so, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('XxYy,Ixab,Jzab,zy->IXJY', v_aaaa_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('XxYy,Jyab,Izab,xz->IXJY', v_aaaa_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Jyab,IYab,xz->IXJY', v_aaaa_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Iyab,JXab,zx->IXJY', v_aaaa_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('I,XY,Ixab,Jyab,yx->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('J,XY,Ixab,Jyab,yx->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('i,IJ,iYab,ixab,xX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('i,IJ,ixab,iYab,xX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('i,IJ,iYab,ixab,xX->IXJY', e_val_so, np.identity(ncvs_so), t1_vaee, t1_vaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('i,IJ,ixab,iYab,xX->IXJY', e_val_so, np.identity(ncvs_so), t1_vaee, t1_vaee, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,IJ,ixab,iYab,xX->IXJY', e_extern_so, np.identity(ncvs_so), t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,IJ,ixab,iYab,xX->IXJY', e_extern_so, np.identity(ncvs_so), t1_vaee, t1_vaee, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,XY,Jxab,Iyab,xy->IXJY', e_extern_so, np.identity(ncas_so), t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,ixab,iyab,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,ixab,iyab,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaee, t1_vaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ixab,iYab,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ixab,iYab,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaee, t1_vaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,XY,Ixab,Jzab,zy->IXJY', h_aa_so, np.identity(ncas_so), t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,XY,Jxab,Izab,yz->IXJY', h_aa_so, np.identity(ncas_so), t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,ixab,izab,zy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,ixab,izab,zy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaee, t1_vaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,iyab,izab,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,iyab,izab,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaee, t1_vaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,iyab,iYab,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,iyab,iYab,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaee, t1_vaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iyab,iXab,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaee, t1_xaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iyab,iXab,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaee, t1_vaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Ixab,Jyab,YyXx->IXJY', t1_xaee, v_xaee_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Jxab,Iyab,YxXy->IXJY', t1_xaee, v_xaee_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('I,Ixab,Jyab,YyXx->IXJY', e_cvs_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('J,Ixab,Jyab,YyXx->IXJY', e_cvs_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('a,Jxab,Iyab,YxXy->IXJY', e_extern_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,Ixab,Jzab,YzXy->IXJY', h_aa_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,Jxab,Izab,YyXz->IXJY', h_aa_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('Xxyz,Ixab,Jwab,Ywyz->IXJY', v_aaaa_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xxyz,Jyab,Iwab,Yxzw->IXJY', v_aaaa_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yxyz,Iyab,Jwab,zwXx->IXJY', v_aaaa_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('Yxyz,Jxab,Iwab,yzXw->IXJY', v_aaaa_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('xyzw,Ixab,JXab,Yyzw->IXJY', v_aaaa_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('xyzw,Jxab,IYab,zwXy->IXJY', v_aaaa_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,ixab,iwab,yzXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,ixab,iwab,yzXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaee, t1_vaee, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iyab,iwab,zwXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iyab,iwab,zwXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaee, t1_vaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,ixab,iYab,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,ixab,iYab,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaee, t1_vaee, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('XY,xyzw,Ixab,Juab,yuzw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('XY,xyzw,Jxab,Iuab,zwyu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaee, t1_xaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Ixab,Juab,YyuXzw->IXJY', v_aaaa_so, t1_xaee, t1_xaee, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Jxab,Iuab,YzwXyu->IXJY', v_aaaa_so, t1_xaee, t1_xaee, rdm_cccaaa_so, optimize = einsum_type)
temp =- einsum('Xa,IYJa->IXJY', t1_ae, v_xaxe_so, optimize = einsum_type)
temp -= einsum('Ya,JXIa->IXJY', t1_ae, v_xaxe_so, optimize = einsum_type)
temp += einsum('Xa,IJ,Ya->IXJY', h_ae_so, np.identity(ncvs_so), t1_ae, optimize = einsum_type)
temp += einsum('Ya,IJ,Xa->IXJY', h_ae_so, np.identity(ncvs_so), t1_ae, optimize = einsum_type)
temp += einsum('a,IJ,Xa,Ya->IXJY', e_extern_so, np.identity(ncvs_so), t1_ae, t1_ae, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,xa,Ya->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_ae, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,xa,Xa->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_ae, optimize = einsum_type)
temp += einsum('XxaY,IyJa,xy->IXJY', t1_aaea, v_xaxe_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Xxay,IYJa,xy->IXJY', t1_aaea, v_xaxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Xa,IxJa,Yx->IXJY', t1_ae, v_xaxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('YxaX,JyIa,yx->IXJY', t1_aaea, v_xaxe_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Yxay,JXIa,yx->IXJY', t1_aaea, v_xaxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Ya,JxIa,xX->IXJY', t1_ae, v_xaxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('xa,IYJa,xX->IXJY', t1_ae, v_xaxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('xa,JXIa,Yx->IXJY', t1_ae, v_xaxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Xa,IJ,Yxay,yx->IXJY', h_ae_so, np.identity(ncvs_so), t1_aaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('Ya,IJ,Xxay,xy->IXJY', h_ae_so, np.identity(ncvs_so), t1_aaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Ya,IJ,xa,xX->IXJY', h_ae_so, np.identity(ncvs_so), t1_ae, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xa,IJ,XyaY,yx->IXJY', h_ae_so, np.identity(ncvs_so), t1_aaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xa,IJ,Ya,xX->IXJY', h_ae_so, np.identity(ncvs_so), t1_ae, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xa,IJ,YyaX,xy->IXJY', h_ae_so, np.identity(ncvs_so), t1_aaea, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Xxay,Yzay,xz->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Xa,Yxay,yx->IXJY', np.identity(ncvs_so), t1_ae, v_aaea_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Yxay,Xzay,zx->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Ya,Xxay,xy->IXJY', np.identity(ncvs_so), t1_ae, v_aaea_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,xa,XyaY,yx->IXJY', np.identity(ncvs_so), t1_ae, v_aaea_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,xa,YyaX,xy->IXJY', np.identity(ncvs_so), t1_ae, v_aaea_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,xa,JyIa,yx->IXJY', np.identity(ncas_so), t1_ae, v_xaxe_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,xa,IyJa,xy->IXJY', np.identity(ncas_so), t1_ae, v_xaxe_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,IJ,Xa,Yxay,yx->IXJY', e_extern_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,IJ,XxaY,ya,xy->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,IJ,Xxay,Ya,xy->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,IJ,Xxay,Yzay,xz->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,IJ,xa,Ya,xX->IXJY', e_extern_so, np.identity(ncvs_so), t1_ae, t1_ae, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,IJ,xa,YyaX,xy->IXJY', e_extern_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,Yyax,za,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,xyaY,za,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,xyaz,Ywaz,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,xyaz,Ya,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,xa,Yyaz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,Xyax,za,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,xyaX,za,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,xyaz,Xwaz,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,xyaz,Xa,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,xa,Xyaz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,xa,ya,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_ae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,XxaY,za,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,Xxaz,Ywaz,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,Xxaz,Ya,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,Xzax,Ya,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,IJ,Xzax,Yway,zw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,YxaX,za,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,Yxaz,Xwaz,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,Yxaz,Xa,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,Yzax,Xa,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,xa,XzaY,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,xa,Ya,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_ae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,xa,YzaX,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,xa,za,zy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_ae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,ya,za,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_ae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,Yway,za,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,yzaY,wa,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,yzaw,Yuaw,xu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,yzaw,Ya,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,ya,Ya,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_ae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,Xway,za,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,yzaX,wa,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,yzaw,Xuaw,ux->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,yzaw,Xa,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,ya,Xa,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_ae, rdm_ca_so, optimize = einsum_type)
temp += einsum('Xxay,IzJa,Yxyz->IXJY', t1_aaea, v_xaxe_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Yxay,JzIa,yzXx->IXJY', t1_aaea, v_xaxe_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xyaX,JzIa,Yzxy->IXJY', t1_aaea, v_xaxe_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xyaY,IzJa,xyXz->IXJY', t1_aaea, v_xaxe_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xyaz,IYJa,xyXz->IXJY', t1_aaea, v_xaxe_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xyaz,JXIa,Yzxy->IXJY', t1_aaea, v_xaxe_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xa,JyIa,YyXx->IXJY', t1_ae, v_xaxe_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xa,IyJa,YxXy->IXJY', t1_ae, v_xaxe_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Ya,IJ,xyaz,xyXz->IXJY', h_ae_so, np.identity(ncvs_so), t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xa,IJ,Yyaz,xzXy->IXJY', h_ae_so, np.identity(ncvs_so), t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xa,IJ,yzaY,yzXx->IXJY', h_ae_so, np.identity(ncvs_so), t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxaY,yzaw,xwyz->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,Xxay,Yzaw,xwyz->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,YxaX,yzaw,yzxw->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxay,zway,zwXx->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,Yxay,Xzaw,yzxw->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Ya,xyaz,xyXz->IXJY', np.identity(ncvs_so), t1_ae, v_aaea_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyaX,zwaY,zwxy->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyaY,zwaX,xyzw->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyaz,XwaY,zwxy->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyaz,YwaX,xyzw->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,xyaz,Ywaz,xyXw->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xa,yzaY,yzXx->IXJY', np.identity(ncvs_so), t1_ae, v_aaea_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,xa,Yyaz,xzXy->IXJY', np.identity(ncvs_so), t1_ae, v_aaea_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,xyaz,JwIa,zwxy->IXJY', np.identity(ncas_so), t1_aaea, v_xaxe_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,xyaz,IwJa,xyzw->IXJY', np.identity(ncas_so), t1_aaea, v_xaxe_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('a,IJ,XxaY,yzaw,xwyz->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('a,IJ,Xxay,Yzaw,xwyz->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('a,IJ,xa,Yyaz,xzXy->IXJY', e_extern_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('a,IJ,xyaY,za,xyXz->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('a,IJ,xyaY,zwaX,xyzw->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('a,IJ,xyaz,Ya,xyXz->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('a,IJ,xyaz,YwaX,xyzw->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('a,IJ,xyaz,Ywaz,xyXw->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xx,IJ,Yyax,zwau,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,IJ,xyaY,zwau,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,xyaz,Ywau,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('Xx,IJ,yzax,wuaY,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,Xyax,zwau,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,xyaX,zwau,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,xyaz,wuaz,wuXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,xyaz,Xwau,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,xyaz,wa,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,xa,yzaw,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,yzax,wa,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('Yx,IJ,yzax,wuaX,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,XxaY,zwau,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,Xxaz,Ywau,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,Xzax,Ywau,zuyw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,YxaX,zwau,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,Yxaz,wuaz,wuXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,Yxaz,Xwau,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,Yxaz,wa,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,Yzax,Xwau,ywzu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,Yzax,wa,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,Yzax,wuay,wuXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,xzaX,wuaY,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,xzaY,wa,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,xzaY,wuaX,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,xzaw,Yuaw,yzXu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,xzaw,XuaY,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,xzaw,Ya,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,xzaw,YuaX,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,xa,Yzaw,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,xa,zwaY,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,zwax,XuaY,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,zwax,Ya,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,zwax,YuaX,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,xzaw,uvaw,uvyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,xzaw,ua,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,xa,zwau,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,yzaw,uvaw,xzuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,yzaw,ua,xzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,ya,zwau,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,zwax,ua,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,zwax,uvay,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,zway,ua,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Xxyz,Yxaw,uvaw,uvyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,Yxaw,ua,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,Yway,zuav,xuwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,Yway,ua,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,xa,wuaY,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Xxyz,yzaY,wuav,xvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,yzaw,Yuav,xvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,ywaY,ua,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,ywaY,uvaz,xwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,ywau,Yvau,xwzv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,ywau,Ya,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,ya,Ywau,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,wuax,Ya,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,wuax,Yvay,wuzv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,Xxaw,uvaw,yzuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,Xxaw,ua,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,Xway,zuav,wvxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,Xway,ua,zwxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,xa,wa,yzXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,xa,wuaX,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,yzaX,wuav,wuxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,yzaw,uvaw,uvXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,yzaw,Xuav,wuxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,yzaw,ua,wuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,ywaX,ua,zuxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,ywaX,uvaz,uvxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ywau,Xvau,zvxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ywau,Xa,zuxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ya,Xwau,zwxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ya,wa,zwXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ya,wuaz,wuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,wuax,Xa,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,wuax,Xvay,zvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,XxaY,ua,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,XxaY,uvay,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,Xxau,Yvau,zwyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,Xxau,Ya,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,Xxau,Yvay,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,Xuax,Yyav,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,Xuax,Ya,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,xyzw,Xuax,Yvaz,yuwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,YxaX,ua,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,YxaX,uvay,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,Yxau,Xvau,yvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,Yxau,Xa,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,Yuax,Xa,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,Yuax,ya,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('IJ,xyzw,xyaX,uvaY,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,xyaY,ua,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('IJ,xyzw,xyaY,uvaX,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,xyau,Yvau,zwXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,xyau,XvaY,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,xyau,Ya,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,xyau,YvaX,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,xa,XuaY,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,xa,Ya,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_ae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,xa,YuaX,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xyaz,JwIa,YzwXxy->IXJY', t1_aaea, v_xaxe_so, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xyaz,IwJa,YxyXzw->IXJY', t1_aaea, v_xaxe_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxay,zwau,yzwXxu->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyaY,zwau,xyuXzw->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyaz,wuaY,zwuXxy->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,xyaz,Ywau,xyuXzw->IXJY', np.identity(ncvs_so), t1_aaea, v_aaea_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('a,IJ,xyaY,zwau,xyuXzw->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('a,IJ,xyaz,Ywau,xyuXzw->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,xyaz,wuav,zwuXyv->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Yx,IJ,yzax,wuav,yzvXwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,Yxaz,wuav,zwuXyv->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,Yzax,wuav,ywuXzv->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,xzaY,wuav,yzvXwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,xzaw,Yuav,yzvXwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,xzaw,uvaY,wuvXyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,zwax,Yuav,zwvXyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xy,IJ,zwax,uvaY,yuvXzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,xzaw,uvas,wuvyzs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,yzaw,uvas,xzswuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,XxYy,zwax,uvas,zwsyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,XxYy,zway,uvas,xuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,Yxaw,uvas,wuvyzs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,Yway,uvas,xuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,xwau,vsaY,uvsyzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,ywaY,uvas,xwszuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,ywau,Yvas,xwszuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,wuax,Yvas,wusyzv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,wuay,vsaY,xvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,Xxaw,uvas,yzswuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,Xway,uvas,zwsxuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,xwau,vsau,yzwXvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,xwau,va,yzwXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,xwau,vsaX,yzwuvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,xa,wuav,yzvXwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,yzaw,uvas,wuvXxs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ywaX,uvas,zuvxws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,ywau,vsau,zvsXxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ywau,Xvas,zuvxws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,ywau,va,zuvXxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ywau,vsaz,uvsXxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,ya,wuav,zwuXxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,wuax,Xvas,yzvwus->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,wuax,va,yzvXwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,wuax,vsay,zvsXwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,wuay,va,zwuXxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,wuay,vsaX,zwuxvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,XxaY,uvas,zwsyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,Xxau,Yvas,zwsyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,Xuax,Yvas,yuszwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,YxaX,uvas,yuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,Yxau,vsau,yvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,Yxau,Xvas,yuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,Yxau,va,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,Yxau,vsay,uvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,Yuax,Xvas,zwvyus->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,Yuax,yvas,zwvXus->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,Yuax,va,zwvXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,Yuax,vsaz,wvsXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,xyzw,xyaY,uvas,zwsXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,xyau,Yvas,zwsXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,xyzw,xyau,vsaY,uvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,xuaX,vsaY,yvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,xuaY,va,zwuXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,xuaY,vsaX,zwuyvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,xuaY,vsay,zwuXvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,xuav,Ysav,zwuXys->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,xuav,XsaY,yvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,xuav,Ya,zwuXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,xuav,YsaX,zwuyvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,xa,Yuav,zwvXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,xa,uvaY,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_ae, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,uvax,XsaY,zwsyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,uvax,Ya,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_ae, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,uvax,YsaX,yuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,xwau,vsat,yzwtXuvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,ywau,vsat,zuvsXxwt->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,Yxyz,wuax,vsat,yzvsXwut->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,wuay,vsat,zwutXxvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,Yxau,vsat,yuvsXzwt->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,Yuax,vsat,zwvsXyut->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,xuaY,vsat,zwutXyvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,xuav,Ysat,zwutXyvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,xuav,staY,yvstXzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,uvax,Ysat,yuvtXzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,xyzw,uvax,staY,zwstXyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaea, t1_aaea, rdm_ccccaaaa_so, optimize = einsum_type)
temp  = 1/2 * einsum('IJ,Xxab,Yyab,xy->IXJY', np.identity(ncvs_so), t1_aaee, v_aaee_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxab,Xyab,yx->IXJY', np.identity(ncvs_so), t1_aaee, v_aaee_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,IJ,Xxab,Yyab,xy->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaee, t1_aaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,IJ,xyab,Yzab,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaee, t1_aaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,xyab,Xzab,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaee, t1_aaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,Xxab,Yzab,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaee, t1_aaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,Yxab,Xzab,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaee, t1_aaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Xxyz,yzab,Ywab,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_ca_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,yzab,Xwab,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxab,yzab,yzXx->IXJY', np.identity(ncvs_so), t1_aaee, v_aaee_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyab,Yzab,xyXz->IXJY', np.identity(ncvs_so), t1_aaee, v_aaee_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('a,IJ,xyab,Yzab,xyXz->IXJY', e_extern_so, np.identity(ncvs_so), t1_aaee, t1_aaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Yx,IJ,xyab,zwab,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaee, t1_aaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xy,IJ,Yxab,zwab,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaee, t1_aaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,xzab,Ywab,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_aaee, t1_aaee, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,XxYy,xzab,wuab,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,XxYy,yzab,wuab,xzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('IJ,Xxyz,Yxab,wuab,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,ywab,Yuab,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('IJ,Yxyz,Xxab,wuab,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('IJ,Yxyz,yzab,wuab,wuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,ywab,Xuab,zuxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,Xxab,Yuab,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,Yxab,Xuab,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('IJ,xyzw,xyab,Yuab,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('IJ,Yxyz,xwab,uvab,yzwXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,ywab,uvab,zuvXxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('IJ,xyzw,Yxab,uvab,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,xuab,Yvab,zwuXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_aaee, t1_aaee, rdm_cccaaa_so, optimize = einsum_type)
temp  = einsum('IiXa,JiYa->IXJY', t1_xxae, v_xxae_so, optimize = einsum_type)
temp += einsum('IiXa,JiYa->IXJY', t1_xvae, v_xvae_so, optimize = einsum_type)
temp += einsum('JiYa,IiXa->IXJY', t1_xxae, v_xxae_so, optimize = einsum_type)
temp += einsum('JiYa,IiXa->IXJY', t1_xvae, v_xvae_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,IiXa,JiYa->IXJY', e_cvs_so, t1_xxae, t1_xxae, optimize = einsum_type)
temp -= 1/2 * einsum('I,IiXa,JiYa->IXJY', e_cvs_so, t1_xvae, t1_xvae, optimize = einsum_type)
temp -= 1/2 * einsum('J,IiXa,JiYa->IXJY', e_cvs_so, t1_xxae, t1_xxae, optimize = einsum_type)
temp -= 1/2 * einsum('J,IiXa,JiYa->IXJY', e_cvs_so, t1_xvae, t1_xvae, optimize = einsum_type)
temp -= 1/2 * einsum('i,IiXa,JiYa->IXJY', e_cvs_so, t1_xxae, t1_xxae, optimize = einsum_type)
temp -= 1/2 * einsum('i,JiYa,IiXa->IXJY', e_cvs_so, t1_xxae, t1_xxae, optimize = einsum_type)
temp -= 1/2 * einsum('i,IiXa,JiYa->IXJY', e_val_so, t1_xvae, t1_xvae, optimize = einsum_type)
temp -= 1/2 * einsum('i,JiYa,IiXa->IXJY', e_val_so, t1_xvae, t1_xvae, optimize = einsum_type)
temp += einsum('a,JiYa,IiXa->IXJY', e_extern_so, t1_xxae, t1_xxae, optimize = einsum_type)
temp += einsum('a,JiYa,IiXa->IXJY', e_extern_so, t1_xvae, t1_xvae, optimize = einsum_type)
temp += 1/2 * einsum('Xx,Iixa,JiYa->IXJY', h_aa_so, t1_xxae, t1_xxae, optimize = einsum_type)
temp += 1/2 * einsum('Xx,Iixa,JiYa->IXJY', h_aa_so, t1_xvae, t1_xvae, optimize = einsum_type)
temp += 1/2 * einsum('Yx,Jixa,IiXa->IXJY', h_aa_so, t1_xxae, t1_xxae, optimize = einsum_type)
temp += 1/2 * einsum('Yx,Jixa,IiXa->IXJY', h_aa_so, t1_xvae, t1_xvae, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ijXa,ijYa->IXJY', np.identity(ncvs_so), t1_xxae, v_xxae_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ijYa,ijXa->IXJY', np.identity(ncvs_so), t1_xxae, v_xxae_so, optimize = einsum_type)
temp -= einsum('IJ,ijXa,ijYa->IXJY', np.identity(ncvs_so), t1_xvae, v_xvae_so, optimize = einsum_type)
temp -= einsum('IJ,ijYa,ijXa->IXJY', np.identity(ncvs_so), t1_xvae, v_xvae_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ijXa,ijYa->IXJY', np.identity(ncvs_so), t1_vvae, v_vvae_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ijYa,ijXa->IXJY', np.identity(ncvs_so), t1_vvae, v_vvae_so, optimize = einsum_type)
temp -= einsum('XY,Iixa,Jixa->IXJY', np.identity(ncas_so), t1_xxae, v_xxae_so, optimize = einsum_type)
temp -= einsum('XY,Iixa,Jixa->IXJY', np.identity(ncas_so), t1_xvae, v_xvae_so, optimize = einsum_type)
temp -= einsum('XY,Jixa,Iixa->IXJY', np.identity(ncas_so), t1_xxae, v_xxae_so, optimize = einsum_type)
temp -= einsum('XY,Jixa,Iixa->IXJY', np.identity(ncas_so), t1_xvae, v_xvae_so, optimize = einsum_type)
temp -= einsum('XxYy,Jixa,Iiya->IXJY', v_aaaa_so, t1_xxae, t1_xxae, optimize = einsum_type)
temp -= einsum('XxYy,Jixa,Iiya->IXJY', v_aaaa_so, t1_xvae, t1_xvae, optimize = einsum_type)
temp += 1/2 * einsum('I,XY,Iixa,Jixa->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxae, t1_xxae, optimize = einsum_type)
temp += 1/2 * einsum('I,XY,Iixa,Jixa->IXJY', e_cvs_so, np.identity(ncas_so), t1_xvae, t1_xvae, optimize = einsum_type)
temp += 1/2 * einsum('J,XY,Iixa,Jixa->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxae, t1_xxae, optimize = einsum_type)
temp += 1/2 * einsum('J,XY,Iixa,Jixa->IXJY', e_cvs_so, np.identity(ncas_so), t1_xvae, t1_xvae, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijXa,ijYa->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xxae, t1_xxae, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijYa,ijXa->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xxae, t1_xxae, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijXa,ijYa->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xvae, t1_xvae, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijYa,ijXa->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xvae, t1_xvae, optimize = einsum_type)
temp += 1/2 * einsum('i,XY,Iixa,Jixa->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxae, t1_xxae, optimize = einsum_type)
temp += 1/2 * einsum('i,XY,Jixa,Iixa->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxae, t1_xxae, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijXa,ijYa->IXJY', e_val_so, np.identity(ncvs_so), t1_vxae, t1_vxae, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijYa,ijXa->IXJY', e_val_so, np.identity(ncvs_so), t1_vxae, t1_vxae, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijXa,ijYa->IXJY', e_val_so, np.identity(ncvs_so), t1_vvae, t1_vvae, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijYa,ijXa->IXJY', e_val_so, np.identity(ncvs_so), t1_vvae, t1_vvae, optimize = einsum_type)
temp += 1/2 * einsum('i,XY,Iixa,Jixa->IXJY', e_val_so, np.identity(ncas_so), t1_xvae, t1_xvae, optimize = einsum_type)
temp += 1/2 * einsum('i,XY,Jixa,Iixa->IXJY', e_val_so, np.identity(ncas_so), t1_xvae, t1_xvae, optimize = einsum_type)
temp -= 1/2 * einsum('a,IJ,ijYa,ijXa->IXJY', e_extern_so, np.identity(ncvs_so), t1_xxae, t1_xxae, optimize = einsum_type)
temp -= 1/2 * einsum('a,IJ,ijYa,ijXa->IXJY', e_extern_so, np.identity(ncvs_so), t1_xvae, t1_xvae, optimize = einsum_type)
temp -= 1/2 * einsum('a,IJ,ijYa,ijXa->IXJY', e_extern_so, np.identity(ncvs_so), t1_vxae, t1_vxae, optimize = einsum_type)
temp -= 1/2 * einsum('a,IJ,ijYa,ijXa->IXJY', e_extern_so, np.identity(ncvs_so), t1_vvae, t1_vvae, optimize = einsum_type)
temp -= einsum('a,XY,Jixa,Iixa->IXJY', e_extern_so, np.identity(ncas_so), t1_xxae, t1_xxae, optimize = einsum_type)
temp -= einsum('a,XY,Jixa,Iixa->IXJY', e_extern_so, np.identity(ncas_so), t1_xvae, t1_xvae, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,IJ,ijxa,ijYa->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxae, t1_xxae, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,ijxa,ijYa->IXJY', h_aa_so, np.identity(ncvs_so), t1_vxae, t1_vxae, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,IJ,ijxa,ijYa->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvae, t1_vvae, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,ijxa,ijXa->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxae, t1_xxae, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ijxa,ijXa->IXJY', h_aa_so, np.identity(ncvs_so), t1_vxae, t1_vxae, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,ijxa,ijXa->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvae, t1_vvae, optimize = einsum_type)
temp -= einsum('xy,XY,Iixa,Jiya->IXJY', h_aa_so, np.identity(ncas_so), t1_xxae, t1_xxae, optimize = einsum_type)
temp -= einsum('xy,XY,Iixa,Jiya->IXJY', h_aa_so, np.identity(ncas_so), t1_xvae, t1_xvae, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,ijxa,ijya->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxae, t1_xxae, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,ijxa,ijya->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvae, t1_xvae, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,ijxa,ijya->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxae, t1_vxae, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,ijxa,ijya->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvae, t1_vvae, optimize = einsum_type)
temp -= einsum('IiXa,Jixa,Yx->IXJY', t1_xxae, v_xxae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Iixa,JiYa,xX->IXJY', t1_xxae, v_xxae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Iixa,Jixa,YX->IXJY', t1_xxae, v_xxae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IiXa,Jixa,Yx->IXJY', t1_xvae, v_xvae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Iixa,JiYa,xX->IXJY', t1_xvae, v_xvae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Iixa,Jixa,YX->IXJY', t1_xvae, v_xvae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('JiYa,Iixa,xX->IXJY', t1_xxae, v_xxae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Jixa,IiXa,Yx->IXJY', t1_xxae, v_xxae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Jixa,Iixa,YX->IXJY', t1_xxae, v_xxae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('JiYa,Iixa,xX->IXJY', t1_xvae, v_xvae_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Jixa,IiXa,Yx->IXJY', t1_xvae, v_xvae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Jixa,Iixa,YX->IXJY', t1_xvae, v_xvae_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,IiXa,Jixa,Yx->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Iixa,Jixa,YX->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,Iixa,JiYa,xX->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,IiXa,Jixa,Yx->IXJY', e_cvs_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Iixa,Jixa,YX->IXJY', e_cvs_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,Iixa,JiYa,xX->IXJY', e_cvs_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,IiXa,Jixa,Yx->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Iixa,Jixa,YX->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,Iixa,JiYa,xX->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,IiXa,Jixa,Yx->IXJY', e_cvs_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Iixa,Jixa,YX->IXJY', e_cvs_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,Iixa,JiYa,xX->IXJY', e_cvs_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IiXa,Jixa,Yx->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Iixa,Jixa,YX->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,Iixa,JiYa,xX->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,JiYa,Iixa,xX->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Jixa,Iixa,YX->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,Jixa,IiXa,Yx->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IiXa,Jixa,Yx->IXJY', e_val_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Iixa,Jixa,YX->IXJY', e_val_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,Iixa,JiYa,xX->IXJY', e_val_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,JiYa,Iixa,xX->IXJY', e_val_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Jixa,Iixa,YX->IXJY', e_val_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,Jixa,IiXa,Yx->IXJY', e_val_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,JiYa,Iixa,xX->IXJY', e_extern_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,Jixa,IiXa,Yx->IXJY', e_extern_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,Jixa,Iixa,YX->IXJY', e_extern_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,JiYa,Iixa,xX->IXJY', e_extern_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= einsum('a,Jixa,IiXa,Yx->IXJY', e_extern_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,Jixa,Iixa,YX->IXJY', e_extern_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,Iixa,Jiya,Yy->IXJY', h_aa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,Iixa,Jiya,Yy->IXJY', h_aa_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,Jixa,Iiya,yX->IXJY', h_aa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,Jixa,Iiya,yX->IXJY', h_aa_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Iixa,JiYa,yX->IXJY', h_aa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,Iixa,Jiya,YX->IXJY', h_aa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Iixa,JiYa,yX->IXJY', h_aa_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,Iixa,Jiya,YX->IXJY', h_aa_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jixa,IiXa,Yy->IXJY', h_aa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jixa,IiXa,Yy->IXJY', h_aa_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ijYa,ijxa,xX->IXJY', np.identity(ncvs_so), t1_xxae, v_xxae_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ijxa,ijYa,xX->IXJY', np.identity(ncvs_so), t1_xxae, v_xxae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ijYa,ijxa,xX->IXJY', np.identity(ncvs_so), t1_xvae, v_xvae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ijxa,ijYa,xX->IXJY', np.identity(ncvs_so), t1_xvae, v_xvae_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ijYa,ijxa,xX->IXJY', np.identity(ncvs_so), t1_vvae, v_vvae_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ijxa,ijYa,xX->IXJY', np.identity(ncvs_so), t1_vvae, v_vvae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,Iixa,Jiya,xy->IXJY', np.identity(ncas_so), t1_xxae, v_xxae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,Iixa,Jiya,xy->IXJY', np.identity(ncas_so), t1_xvae, v_xvae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,Jixa,Iiya,yx->IXJY', np.identity(ncas_so), t1_xxae, v_xxae_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,Jixa,Iiya,yx->IXJY', np.identity(ncas_so), t1_xvae, v_xvae_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XxYy,Iiya,Jiza,xz->IXJY', v_aaaa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XxYy,Iiya,Jiza,xz->IXJY', v_aaaa_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XxYy,Jixa,Iiza,zy->IXJY', v_aaaa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XxYy,Jixa,Iiza,zy->IXJY', v_aaaa_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Iiya,JiYa,xz->IXJY', v_aaaa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Iiya,JiYa,xz->IXJY', v_aaaa_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Xxyz,Jixa,Iiya,Yz->IXJY', v_aaaa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Xxyz,Jixa,Iiya,Yz->IXJY', v_aaaa_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Yxyz,Iixa,Jiya,zX->IXJY', v_aaaa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Yxyz,Iixa,Jiya,zX->IXJY', v_aaaa_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Jiya,IiXa,zx->IXJY', v_aaaa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Jiya,IiXa,zx->IXJY', v_aaaa_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,XY,Iixa,Jiya,xy->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,XY,Iixa,Jiya,xy->IXJY', e_cvs_so, np.identity(ncas_so), t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,XY,Iixa,Jiya,xy->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,XY,Iixa,Jiya,xy->IXJY', e_cvs_so, np.identity(ncas_so), t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijYa,ijxa,xX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijxa,ijYa,xX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijYa,ijxa,xX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijxa,ijYa,xX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,XY,Iixa,Jiya,xy->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,XY,Jixa,Iiya,yx->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijYa,ijxa,xX->IXJY', e_val_so, np.identity(ncvs_so), t1_vxae, t1_vxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijxa,ijYa,xX->IXJY', e_val_so, np.identity(ncvs_so), t1_vxae, t1_vxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijYa,ijxa,xX->IXJY', e_val_so, np.identity(ncvs_so), t1_vvae, t1_vvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijxa,ijYa,xX->IXJY', e_val_so, np.identity(ncvs_so), t1_vvae, t1_vvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,XY,Iixa,Jiya,xy->IXJY', e_val_so, np.identity(ncas_so), t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,XY,Jixa,Iiya,yx->IXJY', e_val_so, np.identity(ncas_so), t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('a,IJ,ijYa,ijxa,xX->IXJY', e_extern_so, np.identity(ncvs_so), t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('a,IJ,ijYa,ijxa,xX->IXJY', e_extern_so, np.identity(ncvs_so), t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('a,IJ,ijYa,ijxa,xX->IXJY', e_extern_so, np.identity(ncvs_so), t1_vxae, t1_vxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('a,IJ,ijYa,ijxa,xX->IXJY', e_extern_so, np.identity(ncvs_so), t1_vvae, t1_vvae, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,XY,Jixa,Iiya,yx->IXJY', e_extern_so, np.identity(ncas_so), t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += einsum('a,XY,Jixa,Iiya,yx->IXJY', e_extern_so, np.identity(ncas_so), t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,ijxa,ijya,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ijxa,ijya,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vxae, t1_vxae, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,ijxa,ijya,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvae, t1_vvae, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ijxa,ijYa,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ijxa,ijYa,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vxae, t1_vxae, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ijxa,ijYa,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvae, t1_vvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,XY,Iixa,Jiza,yz->IXJY', h_aa_so, np.identity(ncas_so), t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,XY,Iixa,Jiza,yz->IXJY', h_aa_so, np.identity(ncas_so), t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,XY,Jixa,Iiza,zy->IXJY', h_aa_so, np.identity(ncas_so), t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,XY,Jixa,Iiza,zy->IXJY', h_aa_so, np.identity(ncas_so), t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,ijxa,ijza,zy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,ijya,ijza,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,ijxa,ijza,zy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxae, t1_vxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,ijya,ijza,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxae, t1_vxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,ijxa,ijza,zy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvae, t1_vvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,ijya,ijza,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvae, t1_vvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,ijya,ijYa,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,ijya,ijYa,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxae, t1_vxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,ijya,ijYa,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvae, t1_vvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijxa,ijya,zX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijya,ijXa,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijxa,ijya,zX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijxa,ijya,zX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxae, t1_vxae, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,ijya,ijXa,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxae, t1_vxae, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijxa,ijya,zX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvae, t1_vvae, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijya,ijXa,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvae, t1_vvae, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,xyzw,Iixa,Jiza,wy->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xxae, t1_xxae, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,xyzw,Iixa,Jiza,wy->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xvae, t1_xvae, rdm_ca_so, optimize = einsum_type)
temp += einsum('Iixa,Jiya,YxXy->IXJY', t1_xxae, v_xxae_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Iixa,Jiya,YxXy->IXJY', t1_xvae, v_xvae_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Jixa,Iiya,YyXx->IXJY', t1_xxae, v_xxae_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Jixa,Iiya,YyXx->IXJY', t1_xvae, v_xvae_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Iixa,Jiya,YxXy->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Iixa,Jiya,YxXy->IXJY', e_cvs_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Iixa,Jiya,YxXy->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Iixa,Jiya,YxXy->IXJY', e_cvs_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Iixa,Jiya,YxXy->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Jixa,Iiya,YyXx->IXJY', e_cvs_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Iixa,Jiya,YxXy->IXJY', e_val_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Jixa,Iiya,YyXx->IXJY', e_val_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('a,Jixa,Iiya,YyXx->IXJY', e_extern_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('a,Jixa,Iiya,YyXx->IXJY', e_extern_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Iixa,Jiza,YyXz->IXJY', h_aa_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Iixa,Jiza,YyXz->IXJY', h_aa_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Jixa,Iiza,YzXy->IXJY', h_aa_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Jixa,Iiza,YzXy->IXJY', h_aa_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Iiya,Jiwa,Yxzw->IXJY', v_aaaa_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Iiya,Jiwa,Yxzw->IXJY', v_aaaa_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Jixa,Iiwa,Ywyz->IXJY', v_aaaa_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Jixa,Iiwa,Ywyz->IXJY', v_aaaa_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Iixa,Jiwa,yzXw->IXJY', v_aaaa_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Iixa,Jiwa,yzXw->IXJY', v_aaaa_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Jiya,Iiwa,zwXx->IXJY', v_aaaa_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Jiya,Iiwa,zwXx->IXJY', v_aaaa_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iixa,JiYa,zwXy->IXJY', v_aaaa_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xyzw,Iixa,Jiza,YwXy->IXJY', v_aaaa_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iixa,JiYa,zwXy->IXJY', v_aaaa_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xyzw,Iixa,Jiza,YwXy->IXJY', v_aaaa_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Jixa,IiXa,Yyzw->IXJY', v_aaaa_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Jixa,IiXa,Yyzw->IXJY', v_aaaa_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,ijxa,ijwa,yzXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,ijya,ijwa,zwXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijxa,ijwa,yzXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxae, t1_vxae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijya,ijwa,zwXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxae, t1_vxae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,ijxa,ijwa,yzXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvae, t1_vvae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,ijya,ijwa,zwXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvae, t1_vvae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,ijxa,ijYa,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ijxa,ijYa,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxae, t1_vxae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,ijxa,ijYa,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvae, t1_vvae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Iixa,Jiua,zwyu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Iixa,Jiua,zwyu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Jixa,Iiua,yuzw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xxae, t1_xxae, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Jixa,Iiua,yuzw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xvae, t1_xvae, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Iixa,Jiua,YzwXyu->IXJY', v_aaaa_so, t1_xxae, t1_xxae, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Iixa,Jiua,YzwXyu->IXJY', v_aaaa_so, t1_xvae, t1_xvae, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Jixa,Iiua,YyuXzw->IXJY', v_aaaa_so, t1_xxae, t1_xxae, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Jixa,Iiua,YyuXzw->IXJY', v_aaaa_so, t1_xvae, t1_xvae, rdm_cccaaa_so, optimize = einsum_type)
temp  = einsum('Ix,JXYx->IXJY', h_xa_so, t1_xaaa, optimize = einsum_type)
temp += einsum('Jx,IYXx->IXJY', h_xa_so, t1_xaaa, optimize = einsum_type)
temp -= 1/2 * einsum('IYxy,JXxy->IXJY', t1_xaaa, v_xaaa_so, optimize = einsum_type)
temp += einsum('Ix,JXYx->IXJY', t1_xa, v_xaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('JXxy,IYxy->IXJY', t1_xaaa, v_xaaa_so, optimize = einsum_type)
temp += einsum('Jx,IYXx->IXJY', t1_xa, v_xaaa_so, optimize = einsum_type)
temp += einsum('iXYx,IiJx->IXJY', t1_xaaa, v_xxxa_so, optimize = einsum_type)
temp += einsum('iXYx,IiJx->IXJY', t1_vaaa, v_xvxa_so, optimize = einsum_type)
temp += einsum('iYXx,JiIx->IXJY', t1_xaaa, v_xxxa_so, optimize = einsum_type)
temp += einsum('iYXx,JiIx->IXJY', t1_vaaa, v_xvxa_so, optimize = einsum_type)
temp += einsum('iX,JiIY->IXJY', t1_xa, v_xxxa_so, optimize = einsum_type)
temp += einsum('iY,IiJX->IXJY', t1_xa, v_xxxa_so, optimize = einsum_type)
temp += einsum('iX,JiIY->IXJY', t1_va, v_xvxa_so, optimize = einsum_type)
temp += einsum('iY,IiJX->IXJY', t1_va, v_xvxa_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,IYXx,Jx->IXJY', e_cvs_so, t1_xaaa, t1_xa, optimize = einsum_type)
temp += 1/4 * einsum('I,IYxy,JXxy->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, optimize = einsum_type)
temp -= 1/2 * einsum('I,Ix,JXYx->IXJY', e_cvs_so, t1_xa, t1_xaaa, optimize = einsum_type)
temp -= 1/2 * einsum('J,IYXx,Jx->IXJY', e_cvs_so, t1_xaaa, t1_xa, optimize = einsum_type)
temp += 1/4 * einsum('J,IYxy,JXxy->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, optimize = einsum_type)
temp -= 1/2 * einsum('J,Ix,JXYx->IXJY', e_cvs_so, t1_xa, t1_xaaa, optimize = einsum_type)
temp -= einsum('Ix,XY,Jx->IXJY', h_xa_so, np.identity(ncas_so), t1_xa, optimize = einsum_type)
temp -= einsum('Jx,XY,Ix->IXJY', h_xa_so, np.identity(ncas_so), t1_xa, optimize = einsum_type)
temp -= einsum('iX,IJ,iY->IXJY', h_xa_so, np.identity(ncvs_so), t1_xa, optimize = einsum_type)
temp -= einsum('iX,IJ,iY->IXJY', h_va_so, np.identity(ncvs_so), t1_va, optimize = einsum_type)
temp -= einsum('iY,IJ,iX->IXJY', h_xa_so, np.identity(ncvs_so), t1_xa, optimize = einsum_type)
temp -= einsum('iY,IJ,iX->IXJY', h_va_so, np.identity(ncvs_so), t1_va, optimize = einsum_type)
temp -= einsum('ix,IJ,iXYx->IXJY', h_xa_so, np.identity(ncvs_so), t1_xaaa, optimize = einsum_type)
temp -= einsum('ix,IJ,iYXx->IXJY', h_xa_so, np.identity(ncvs_so), t1_xaaa, optimize = einsum_type)
temp -= einsum('ix,IJ,iXYx->IXJY', h_va_so, np.identity(ncvs_so), t1_vaaa, optimize = einsum_type)
temp -= einsum('ix,IJ,iYXx->IXJY', h_va_so, np.identity(ncvs_so), t1_vaaa, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IYxy,Jy->IXJY', h_aa_so, t1_xaaa, t1_xa, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,JxYy,Iy->IXJY', h_aa_so, t1_xaaa, t1_xa, optimize = einsum_type)
temp += 1/4 * einsum('Xx,Jxyz,IYyz->IXJY', h_aa_so, t1_xaaa, t1_xaaa, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IxXy,Jy->IXJY', h_aa_so, t1_xaaa, t1_xa, optimize = einsum_type)
temp += 1/4 * einsum('Yx,Ixyz,JXyz->IXJY', h_aa_so, t1_xaaa, t1_xaaa, optimize = einsum_type)
temp += 1/2 * einsum('Yx,JXxy,Iy->IXJY', h_aa_so, t1_xaaa, t1_xa, optimize = einsum_type)
temp += einsum('xy,IYXx,Jy->IXJY', h_aa_so, t1_xaaa, t1_xa, optimize = einsum_type)
temp -= einsum('xy,IYxz,JXyz->IXJY', h_aa_so, t1_xaaa, t1_xaaa, optimize = einsum_type)
temp += einsum('xy,Ix,JXYy->IXJY', h_aa_so, t1_xa, t1_xaaa, optimize = einsum_type)
temp += 1/2 * einsum('IJ,iXxy,iYxy->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,iXxy,iYxy->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,iYxy,iXxy->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,iYxy,iXxy->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, optimize = einsum_type)
temp -= einsum('IJ,ix,iYXx->IXJY', np.identity(ncvs_so), t1_xa, v_xaaa_so, optimize = einsum_type)
temp -= einsum('IJ,ix,iXYx->IXJY', np.identity(ncvs_so), t1_xa, v_xaaa_so, optimize = einsum_type)
temp -= einsum('IJ,ix,iYXx->IXJY', np.identity(ncvs_so), t1_va, v_vaaa_so, optimize = einsum_type)
temp -= einsum('IJ,ix,iXYx->IXJY', np.identity(ncvs_so), t1_va, v_vaaa_so, optimize = einsum_type)
temp -= einsum('XY,ix,IiJx->IXJY', np.identity(ncas_so), t1_xa, v_xxxa_so, optimize = einsum_type)
temp -= einsum('XY,ix,JiIx->IXJY', np.identity(ncas_so), t1_xa, v_xxxa_so, optimize = einsum_type)
temp -= einsum('XY,ix,IiJx->IXJY', np.identity(ncas_so), t1_va, v_xvxa_so, optimize = einsum_type)
temp -= einsum('XY,ix,JiIx->IXJY', np.identity(ncas_so), t1_va, v_xvxa_so, optimize = einsum_type)
temp -= einsum('XxYy,Jx,Iy->IXJY', v_aaaa_so, t1_xa, t1_xa, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Jx,IYyz->IXJY', v_aaaa_so, t1_xa, t1_xaaa, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Ix,JXyz->IXJY', v_aaaa_so, t1_xa, t1_xaaa, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,IYxy,JXzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, optimize = einsum_type)
temp += 1/2 * einsum('I,XY,Ix,Jx->IXJY', e_cvs_so, np.identity(ncas_so), t1_xa, t1_xa, optimize = einsum_type)
temp += 1/2 * einsum('J,XY,Ix,Jx->IXJY', e_cvs_so, np.identity(ncas_so), t1_xa, t1_xa, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iXYx,ix->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xa, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,iXxy,iYxy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYXx,ix->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xa, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,iYxy,iXxy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, optimize = einsum_type)
temp += einsum('i,IJ,iX,iY->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xa, t1_xa, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ix,iXYx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xa, t1_xaaa, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ix,iYXx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xa, t1_xaaa, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iXYx,ix->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_va, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,iXxy,iYxy->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYXx,ix->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_va, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,iYxy,iXxy->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, optimize = einsum_type)
temp += einsum('i,IJ,iX,iY->IXJY', e_val_so, np.identity(ncvs_so), t1_va, t1_va, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ix,iXYx->IXJY', e_val_so, np.identity(ncvs_so), t1_va, t1_vaaa, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ix,iYXx->IXJY', e_val_so, np.identity(ncvs_so), t1_va, t1_vaaa, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,iYxy,iy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,iYxy,iy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,ixYy,iy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,IJ,ixyz,iYyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,ixYy,iy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,IJ,ixyz,iYyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,ix,iY->IXJY', h_aa_so, np.identity(ncvs_so), t1_xa, t1_xa, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,ix,iY->IXJY', h_aa_so, np.identity(ncvs_so), t1_va, t1_va, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iXxy,iy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iXxy,iy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ixXy,iy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,ixyz,iXyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ixXy,iy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,ixyz,iXyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ix,iX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xa, t1_xa, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ix,iX->IXJY', h_aa_so, np.identity(ncvs_so), t1_va, t1_va, optimize = einsum_type)
temp -= einsum('xy,IJ,iXYx,iy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, optimize = einsum_type)
temp += einsum('xy,IJ,iXxz,iYyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, optimize = einsum_type)
temp -= einsum('xy,IJ,iXYx,iy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, optimize = einsum_type)
temp += einsum('xy,IJ,iXxz,iYyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, optimize = einsum_type)
temp -= einsum('xy,IJ,iYXx,iy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, optimize = einsum_type)
temp -= einsum('xy,IJ,iYXx,iy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, optimize = einsum_type)
temp -= einsum('xy,XY,Ix,Jy->IXJY', h_aa_so, np.identity(ncas_so), t1_xa, t1_xa, optimize = einsum_type)
temp += einsum('IJ,XxYy,ix,iy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xa, optimize = einsum_type)
temp += einsum('IJ,XxYy,ix,iy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_va, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,ix,iYyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,ix,iYyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,ix,iXyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,ix,iXyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iXxy,iYzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iXxy,iYzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, optimize = einsum_type)
temp += einsum('Ix,JXxy,Yy->IXJY', h_xa_so, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('Ix,Jx,YX->IXJY', h_xa_so, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Ix,JyYx,yX->IXJY', h_xa_so, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('Jx,IYxy,yX->IXJY', h_xa_so, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('Jx,Ix,YX->IXJY', h_xa_so, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Jx,IyXx,Yy->IXJY', h_xa_so, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IYXx,Jyxz,yz->IXJY', t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IYxy,Jzxy,zX->IXJY', t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IYxy,JXxz,yz->IXJY', t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Ix,JyYx,yX->IXJY', t1_xa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Ix,JXxy,Yy->IXJY', t1_xa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IxXy,JzYy,zx->IXJY', t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IxXy,JxYz,yz->IXJY', t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Ixyz,JXYy,zx->IXJY', t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Ixyz,JXyz,Yx->IXJY', t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('JXYx,Iyxz,zy->IXJY', t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('JXxy,IYxz,zy->IXJY', t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('JXxy,Izxy,Yz->IXJY', t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Jx,IYxy,yX->IXJY', t1_xa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Jx,IyXx,Yy->IXJY', t1_xa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('JxYy,IxXz,zy->IXJY', t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('JxYy,IzXy,xz->IXJY', t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Jxyz,IYXy,xz->IXJY', t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Jxyz,IYyz,xX->IXJY', t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('iXYx,IiJy,yx->IXJY', t1_xaaa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('iXxy,IiJx,Yy->IXJY', t1_xaaa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('iXYx,IiJy,yx->IXJY', t1_vaaa, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('iXxy,IiJx,Yy->IXJY', t1_vaaa, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('iYXx,JiIy,xy->IXJY', t1_xaaa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('iYxy,JiIx,yX->IXJY', t1_xaaa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('iYXx,JiIy,xy->IXJY', t1_vaaa, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('iYxy,JiIx,yX->IXJY', t1_vaaa, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('iX,JiIx,Yx->IXJY', t1_xa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('iY,IiJx,xX->IXJY', t1_xa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('ix,JiIY,xX->IXJY', t1_xa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('ix,IiJX,Yx->IXJY', t1_xa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ix,IiJx,YX->IXJY', t1_xa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ix,JiIx,YX->IXJY', t1_xa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ixXy,JiIY,yx->IXJY', t1_xaaa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('ixXy,JiIy,Yx->IXJY', t1_xaaa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ixYy,IiJX,xy->IXJY', t1_xaaa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('ixYy,IiJy,xX->IXJY', t1_xaaa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('iX,JiIx,Yx->IXJY', t1_va, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('iY,IiJx,xX->IXJY', t1_va, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('ix,JiIY,xX->IXJY', t1_va, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('ix,IiJX,Yx->IXJY', t1_va, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ix,IiJx,YX->IXJY', t1_va, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ix,JiIx,YX->IXJY', t1_va, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ixXy,JiIY,yx->IXJY', t1_vaaa, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('ixXy,JiIy,Yx->IXJY', t1_vaaa, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('ixYy,IiJX,xy->IXJY', t1_vaaa, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('ixYy,IiJy,xX->IXJY', t1_vaaa, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,IYXx,Jyxz,yz->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,IYxy,JXxz,yz->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,IYxy,Jx,yX->IXJY', e_cvs_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('I,IYxy,Jzxy,zX->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Ix,JXxy,Yy->IXJY', e_cvs_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Ix,Jx,YX->IXJY', e_cvs_so, t1_xa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,Ix,JyYx,yX->IXJY', e_cvs_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,IxXy,JxYz,yz->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,IxXy,Jy,Yx->IXJY', e_cvs_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,IxXy,JzYy,zx->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Ixyz,JXYy,zx->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('I,Ixyz,JXyz,Yx->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,IYXx,Jyxz,yz->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,IYxy,JXxz,yz->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,IYxy,Jx,yX->IXJY', e_cvs_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('J,IYxy,Jzxy,zX->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Ix,JXxy,Yy->IXJY', e_cvs_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Ix,Jx,YX->IXJY', e_cvs_so, t1_xa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,Ix,JyYx,yX->IXJY', e_cvs_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,IxXy,JxYz,yz->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,IxXy,Jy,Yx->IXJY', e_cvs_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,IxXy,JzYy,zx->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Ixyz,JXYy,zx->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('J,Ixyz,JXyz,Yx->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Ix,XY,Jyxz,yz->IXJY', h_xa_so, np.identity(ncas_so), t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Jx,XY,Iyxz,zy->IXJY', h_xa_so, np.identity(ncas_so), t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('iX,IJ,ixYy,xy->IXJY', h_xa_so, np.identity(ncvs_so), t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('iX,IJ,ixYy,xy->IXJY', h_va_so, np.identity(ncvs_so), t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('iY,IJ,ix,xX->IXJY', h_xa_so, np.identity(ncvs_so), t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('iY,IJ,ixXy,yx->IXJY', h_xa_so, np.identity(ncvs_so), t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('iY,IJ,ix,xX->IXJY', h_va_so, np.identity(ncvs_so), t1_va, rdm_ca_so, optimize = einsum_type)
temp -= einsum('iY,IJ,ixXy,yx->IXJY', h_va_so, np.identity(ncvs_so), t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('ix,IJ,iXYy,xy->IXJY', h_xa_so, np.identity(ncvs_so), t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('ix,IJ,iYXy,yx->IXJY', h_xa_so, np.identity(ncvs_so), t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('ix,IJ,iYxy,yX->IXJY', h_xa_so, np.identity(ncvs_so), t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('ix,IJ,iY,xX->IXJY', h_xa_so, np.identity(ncvs_so), t1_xa, rdm_ca_so, optimize = einsum_type)
temp += einsum('ix,IJ,iyYx,yX->IXJY', h_xa_so, np.identity(ncvs_so), t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('ix,IJ,iXYy,xy->IXJY', h_va_so, np.identity(ncvs_so), t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('ix,IJ,iYXy,yx->IXJY', h_va_so, np.identity(ncvs_so), t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('ix,IJ,iYxy,yX->IXJY', h_va_so, np.identity(ncvs_so), t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('ix,IJ,iY,xX->IXJY', h_va_so, np.identity(ncvs_so), t1_va, rdm_ca_so, optimize = einsum_type)
temp += einsum('ix,IJ,iyYx,yX->IXJY', h_va_so, np.identity(ncvs_so), t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IYxy,Jzyw,zw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,Iyxz,JyYw,zw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,Iyxz,Jz,Yy->IXJY', h_aa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,Iyxz,JwYz,wy->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,JxYy,Izyw,wz->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,Jxyz,IYyw,wz->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,Jxyz,Iy,Yz->IXJY', h_aa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,Jxyz,Iwyz,Yw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IxXy,Jzyw,zw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,Ixyz,JXyw,zw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,Ixyz,Jy,zX->IXJY', h_aa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,Ixyz,Jwyz,wX->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,JXxy,Izyw,wz->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,Jyxz,IyXw,wz->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,Jyxz,Iz,yX->IXJY', h_aa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,Jyxz,IwXz,yw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,IYXx,Jzyw,zw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,IYxz,JXyw,zw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IYxz,JXzw,yw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,IYxz,Jy,zX->IXJY', h_aa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IYxz,Jz,yX->IXJY', h_aa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,IYxz,Jwyz,wX->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,Ix,JXyz,Yz->IXJY', h_aa_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,Ix,Jy,YX->IXJY', h_aa_so, t1_xa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,Ix,JzYy,zX->IXJY', h_aa_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,IxXz,JyYw,zw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IxXz,Jz,Yy->IXJY', h_aa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IxXz,JwYz,wy->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Ixzw,JXYz,wy->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,Ixzw,JXzw,Yy->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IzXx,Jy,Yz->IXJY', h_aa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IzXx,JzYw,yw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,IzXx,JwYy,wz->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,Izxw,JXYy,wz->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Izxw,JXYw,yz->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,Izxw,JXyw,Yz->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,JXxz,IYzw,wy->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,JXxz,Iz,Yy->IXJY', h_aa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,JxYz,Iz,yX->IXJY', h_aa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,JxYz,IwXz,yw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jxzw,IYXz,yw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,Jxzw,IYzw,yX->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,JzYx,IzXw,wy->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jzxw,IYXw,zy->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iXYx,iyxz,zy->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iXxy,iYxz,zy->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iXYx,iyxz,zy->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iXxy,iYxz,zy->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iYXx,iyxz,yz->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,iYxy,izxy,zX->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iYxy,iXxz,yz->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iYXx,iyxz,yz->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,iYxy,izxy,zX->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iYxy,iXxz,yz->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iX,ixYy,xy->IXJY', np.identity(ncvs_so), t1_xa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iY,ixXy,yx->IXJY', np.identity(ncvs_so), t1_xa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ix,iYXy,yx->IXJY', np.identity(ncvs_so), t1_xa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ix,iYxy,yX->IXJY', np.identity(ncvs_so), t1_xa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ix,iyYx,yX->IXJY', np.identity(ncvs_so), t1_xa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ix,iXYy,xy->IXJY', np.identity(ncvs_so), t1_xa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ixXy,izYy,zx->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ixYy,izXy,xz->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ixyz,iYXy,xz->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ixyz,iYyz,xX->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ixyz,iXYy,zx->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iX,ixYy,xy->IXJY', np.identity(ncvs_so), t1_va, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,iY,ixXy,yx->IXJY', np.identity(ncvs_so), t1_va, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ix,iYXy,yx->IXJY', np.identity(ncvs_so), t1_va, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ix,iYxy,yX->IXJY', np.identity(ncvs_so), t1_va, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ix,iyYx,yX->IXJY', np.identity(ncvs_so), t1_va, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ix,iXYy,xy->IXJY', np.identity(ncvs_so), t1_va, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ixXy,izYy,zx->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ixYy,izXy,xz->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ixyz,iYXy,xz->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ixyz,iYyz,xX->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ixyz,iXYy,zx->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,Ix,Jyxz,yz->IXJY', np.identity(ncas_so), t1_xa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,Ixyz,Jwyz,wx->IXJY', np.identity(ncas_so), t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,Jx,Iyxz,zy->IXJY', np.identity(ncas_so), t1_xa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,Jxyz,Iwyz,xw->IXJY', np.identity(ncas_so), t1_xaaa, v_xaaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,ix,IiJy,yx->IXJY', np.identity(ncas_so), t1_xa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,ix,JiIy,xy->IXJY', np.identity(ncas_so), t1_xa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,ixyz,IiJy,xz->IXJY', np.identity(ncas_so), t1_xaaa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,ixyz,JiIy,zx->IXJY', np.identity(ncas_so), t1_xaaa, v_xxxa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,ix,IiJy,yx->IXJY', np.identity(ncas_so), t1_va, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,ix,JiIy,xy->IXJY', np.identity(ncas_so), t1_va, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,ixyz,IiJy,xz->IXJY', np.identity(ncas_so), t1_vaaa, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,ixyz,JiIy,zx->IXJY', np.identity(ncas_so), t1_vaaa, v_xvxa_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XxYy,Ixzw,Jz,wy->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('XxYy,Ixzw,Juzw,uy->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XxYy,Izyw,Jw,xz->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XxYy,Jx,Izyw,wz->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XxYy,Jyzw,Iz,xw->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('XxYy,Jyzw,Iuzw,xu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XxYy,Jzxw,Iy,zw->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XxYy,Jzxw,Iw,zy->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XxYy,Jzxw,Iuyw,zu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,IYyw,Jzwu,xu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,IYyw,Jw,xz->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Xxyz,Iy,JzYw,xw->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xxyz,Iwyz,JwYu,xu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Iwyu,JzYu,xw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Xxyz,Jx,IYyw,wz->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Xxyz,Jx,Iy,Yz->IXJY', v_aaaa_so, t1_xa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Jx,Iwyz,Yw->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,JyYw,Iw,xz->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Jywu,IYwu,xz->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('Xxyz,JwYx,Iy,wz->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,JwYx,Iuyz,wu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Jwxu,IYyz,wu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Xxyz,Jwxu,IYyu,wz->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Yxyz,Ix,JXyw,zw->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Yxyz,Ix,Jy,zX->IXJY', v_aaaa_so, t1_xa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Ix,Jwyz,wX->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('Yxyz,IyXw,Jz,wx->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,IyXw,Jw,zx->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,IyXw,Juzw,ux->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Iywu,JXzw,ux->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Iywu,JXwu,zx->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('Yxyz,IwXx,Jy,zw->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,IwXx,Juyz,uw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Iwxu,JXyz,uw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Yxyz,Iwxu,JXyu,zw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,JXyw,Iw,zx->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yxyz,Jwyz,IwXu,ux->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xyzw,IYXx,Jz,wy->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,IYXx,Juzw,uy->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,IYxy,JXzu,wu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,IYxy,Jz,wX->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,IYxy,Juzw,uX->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,IYxu,JXzw,uy->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xyzw,IYxu,JXzu,wy->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xyzw,Ix,JXYz,wy->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,Ix,JXzw,Yy->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,Iuxy,JXYz,wu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iuxy,JXzw,Yu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,XY,Ix,Jyxz,yz->IXJY', e_cvs_so, np.identity(ncas_so), t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,XY,Ixyz,Jy,zx->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('I,XY,Ixyz,Jwyz,wx->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,XY,Ix,Jyxz,yz->IXJY', e_cvs_so, np.identity(ncas_so), t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,XY,Ixyz,Jy,zx->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('J,XY,Ixyz,Jwyz,wx->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iXYx,iyxz,zy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iXxy,iYxz,zy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('i,IJ,iYXx,iy,xy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYXx,iyxz,yz->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYxy,iXxz,yz->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYxy,ix,yX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('i,IJ,iYxy,izxy,zX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('i,IJ,iX,ixYy,xy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('i,IJ,ix,iXYy,xy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ix,iYxy,yX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('i,IJ,ix,iY,xX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ix,iyYx,yX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('i,IJ,ixXy,iY,yx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixXy,ixYz,yz->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixXy,izYy,zx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ixYy,ixXz,zy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ixYy,iy,xX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixYy,izXy,xz->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixyz,iXYy,zx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixyz,iYXy,xz->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('i,IJ,ixyz,iYyz,xX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iXYx,iyxz,zy->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iXxy,iYxz,zy->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('i,IJ,iYXx,iy,xy->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYXx,iyxz,yz->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYxy,iXxz,yz->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYxy,ix,yX->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('i,IJ,iYxy,izxy,zX->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('i,IJ,iX,ixYy,xy->IXJY', e_val_so, np.identity(ncvs_so), t1_va, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('i,IJ,ix,iXYy,xy->IXJY', e_val_so, np.identity(ncvs_so), t1_va, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ix,iYxy,yX->IXJY', e_val_so, np.identity(ncvs_so), t1_va, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('i,IJ,ix,iY,xX->IXJY', e_val_so, np.identity(ncvs_so), t1_va, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ix,iyYx,yX->IXJY', e_val_so, np.identity(ncvs_so), t1_va, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('i,IJ,ixXy,iY,yx->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixXy,ixYz,yz->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixXy,izYy,zx->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ixYy,ixXz,zy->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ixYy,iy,xX->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixYy,izXy,xz->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixyz,iXYy,zx->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixyz,iYXy,xz->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('i,IJ,ixyz,iYyz,xX->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,iYxy,iz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,iYxy,izyw,zw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,iYxy,iz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,iYxy,izyw,zw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,ixYy,iz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,ixYy,izyw,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,ixyz,iYyw,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,ixYy,iz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,ixYy,izyw,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,ixyz,iYyw,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,iyxz,iyYw,zw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,iyxz,iyYw,zw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,ix,iyYz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,iyxz,iY,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,iyxz,iyYw,zw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,iyxz,iwYz,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,ix,iyYz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_va, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,iyxz,iY,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,iyxz,iyYw,zw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,iyxz,iwYz,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iXxy,iz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iXxy,izyw,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iXxy,iz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iXxy,izyw,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ixXy,iz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ixXy,izyw,zw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ixyz,iXyw,zw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ixyz,iy,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,ixyz,iwyz,wX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ixXy,iz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ixXy,izyw,zw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ixyz,iXyw,zw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ixyz,iy,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,ixyz,iwyz,wX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iyxz,iyXw,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iyxz,iyXw,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ix,iy,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ix,iyXz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iyxz,iX,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iyxz,iyXw,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iyxz,iz,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iyxz,iwXz,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ix,iy,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_va, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ix,iyXz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_va, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iyxz,iX,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iyxz,iyXw,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iyxz,iz,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iyxz,iwXz,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,iXYx,iz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IJ,iXYx,izyw,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IJ,iXxz,iYyw,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,iXxz,iYzw,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,iXYx,iz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IJ,iXYx,izyw,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IJ,iXxz,iYyw,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,iXxz,iYzw,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,iYXx,iz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IJ,iYXx,izyw,zw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,iYxz,iXzw,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IJ,iYxz,iy,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,iYxz,iz,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IJ,iYxz,iwyz,wX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,iYXx,iz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IJ,iYXx,izyw,zw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,iYxz,iXzw,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IJ,iYxz,iy,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,iYxz,iz,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IJ,iYxz,iwyz,wX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixXz,iY,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixXz,iwYz,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixYz,iX,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixYz,iz,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixYz,iwXz,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixzw,iXYz,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixzw,iYXz,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ixzw,iYzw,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixXz,iY,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixXz,iwYz,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixYz,iX,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixYz,iz,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixYz,iwXz,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixzw,iXYz,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixzw,iYXz,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ixzw,iYzw,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izXx,izYw,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izYx,izXw,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izXx,izYw,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izYx,izXw,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ix,iXYz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ix,iYXz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ix,iY,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,IJ,ix,izYy,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izXx,iY,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izXx,izYw,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IJ,izXx,iwYy,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izYx,iX,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izYx,izXw,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izxw,iXYw,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izxw,iYXw,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ix,iXYz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_va, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ix,iYXz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_va, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ix,iY,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_va, t1_va, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,IJ,ix,izYy,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_va, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izXx,iY,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izXx,izYw,yw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,IJ,izXx,iwYy,wz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izYx,iX,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izYx,izXw,wy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izxw,iXYw,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izxw,iYXw,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,XY,Ix,Jzyw,zw->IXJY', h_aa_so, np.identity(ncas_so), t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,XY,Ixzw,Jz,wy->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,XY,Ixzw,Juzw,uy->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,XY,Izxw,Jy,wz->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,XY,Izxw,Jw,yz->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('xy,XY,Izxw,Juyw,uz->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,XY,Jxzw,Iz,yw->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,XY,Jxzw,Iuzw,yu->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,XY,Jzxw,Iw,zy->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,ixzw,iz,wy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,ixzw,iuzw,uy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,ixzw,iz,wy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,ixzw,iuzw,uy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,iyzw,iz,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,iyzw,iuzw,xu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,iyzw,iz,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,iyzw,iuzw,xu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,ix,iz,zy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,XxYy,ix,izyw,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,iy,iz,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,XxYy,izxw,iy,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,izxw,iw,zy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,XxYy,izxw,iuyw,zu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,izyw,iw,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,ix,iz,zy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_va, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,XxYy,ix,izyw,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,iy,iz,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_va, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,XxYy,izxw,iy,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,izxw,iw,zy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,XxYy,izxw,iuyw,zu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,izyw,iw,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,iYyz,iw,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iYyw,izwu,xu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iYyw,iw,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,iYyz,iw,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iYyw,izwu,xu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iYyw,iw,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iyYw,iz,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iyYw,iw,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iyYw,iuzw,xu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,iywu,iYwu,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iyYw,iz,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iyYw,iw,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iyYw,iuzw,xu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,iywu,iYwu,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,iwyz,iwYu,xu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,iwyz,iwYu,xu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Xxyz,ix,iYyw,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iy,iY,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,Xxyz,iwYx,iy,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iwYx,iuyz,wu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iwxu,iYyz,wu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Xxyz,iwxu,iYyu,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,iwyz,iY,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,iwyz,iwYu,xu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Xxyz,ix,iYyw,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iy,iY,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,Xxyz,iwYx,iy,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iwYx,iuyz,wu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iwxu,iYyz,wu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Xxyz,iwxu,iYyu,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,iwyz,iY,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,iwyz,iwYu,xu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iXyz,iw,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iXyw,izwu,ux->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iXyw,iw,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iXyz,iw,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iXyw,izwu,ux->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iXyw,iw,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyXw,iz,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iyXw,iw,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyXw,iuzw,ux->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iywu,iXwu,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyXw,iz,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iyXw,iw,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyXw,iuzw,ux->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iywu,iXwu,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iwyz,iwXu,ux->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iwyz,iwXu,ux->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Yxyz,ix,iXyw,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Yxyz,ix,iy,zX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ix,iwyz,wX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iy,iX,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,Yxyz,iwXx,iy,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iwXx,iuyz,uw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iwxu,iXyz,uw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Yxyz,iwxu,iXyu,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iwyz,iX,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwyz,iwXu,ux->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Yxyz,ix,iXyw,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Yxyz,ix,iy,zX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ix,iwyz,wX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iy,iX,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,Yxyz,iwXx,iy,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iwXx,iuyz,uw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iwxu,iXyz,uw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,Yxyz,iwxu,iXyu,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iwyz,iX,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwyz,iwXu,ux->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,xyzw,iXYx,iz,yw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,iXYx,iuzw,yu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,iXxy,iYzu,uw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,iXxu,iYzw,yu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,iXxu,iYzu,yw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,xyzw,iXYx,iz,yw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,iXYx,iuzw,yu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,iXxy,iYzu,uw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,iXxu,iYzw,yu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,iXxu,iYzu,yw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,xyzw,iYXx,iz,wy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,iYXx,iuzw,uy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,iYxy,iz,wX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iYxy,iuzw,uX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,xyzw,iYXx,iz,wy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,iYXx,iuzw,uy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,iYxy,iz,wX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iYxy,iuzw,uX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,xyzw,Ix,Jz,wy->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,xyzw,Ix,Juzw,uy->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,xyzw,Iuxy,Jz,wu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Iuxy,Jvzw,vu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Ix,Jyxz,YyXz->IXJY', h_xa_so, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Jx,Iyxz,YzXy->IXJY', h_xa_so, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IYxy,Jzxw,yzXw->IXJY', t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Ix,Jyxz,YyXz->IXJY', t1_xa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IxXy,Jzyw,Yzxw->IXJY', t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IxXy,Jxzw,Yyzw->IXJY', t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Ixyz,JwYy,zwXx->IXJY', t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Ixyz,JxYw,yzXw->IXJY', t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Ixyz,Jwyz,YwXx->IXJY', t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Ixyz,JXyw,Yzxw->IXJY', t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('JXxy,Izxw,Ywyz->IXJY', t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Jx,Iyxz,YzXy->IXJY', t1_xa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('JxYy,Ixzw,zwXy->IXJY', t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('JxYy,Izyw,xwXz->IXJY', t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Jxyz,IYyw,xwXz->IXJY', t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Jxyz,IxXw,Ywyz->IXJY', t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Jxyz,IwXy,Yxzw->IXJY', t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Jxyz,Iwyz,YxXw->IXJY', t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('iXxy,IiJz,Yzxy->IXJY', t1_xaaa, v_xxxa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('iXxy,IiJz,Yzxy->IXJY', t1_vaaa, v_xvxa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('iYxy,JiIz,xyXz->IXJY', t1_xaaa, v_xxxa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('iYxy,JiIz,xyXz->IXJY', t1_vaaa, v_xvxa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('ix,IiJy,YyXx->IXJY', t1_xa, v_xxxa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('ix,JiIy,YxXy->IXJY', t1_xa, v_xxxa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('ixXy,JiIz,Yyxz->IXJY', t1_xaaa, v_xxxa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('ixYy,IiJz,xzXy->IXJY', t1_xaaa, v_xxxa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('ixyz,JiIY,yzXx->IXJY', t1_xaaa, v_xxxa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('ixyz,IiJX,Yxyz->IXJY', t1_xaaa, v_xxxa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('ixyz,IiJy,YxXz->IXJY', t1_xaaa, v_xxxa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('ixyz,JiIy,YzXx->IXJY', t1_xaaa, v_xxxa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('ix,IiJy,YyXx->IXJY', t1_va, v_xvxa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('ix,JiIy,YxXy->IXJY', t1_va, v_xvxa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('ixXy,JiIz,Yyxz->IXJY', t1_vaaa, v_xvxa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('ixYy,IiJz,xzXy->IXJY', t1_vaaa, v_xvxa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('ixyz,JiIY,yzXx->IXJY', t1_vaaa, v_xvxa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('ixyz,IiJX,Yxyz->IXJY', t1_vaaa, v_xvxa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('ixyz,IiJy,YxXz->IXJY', t1_vaaa, v_xvxa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('ixyz,JiIy,YzXx->IXJY', t1_vaaa, v_xvxa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('I,IYxy,Jzxw,yzXw->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('I,Ix,Jyxz,YyXz->IXJY', e_cvs_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('I,IxXy,Jxzw,Yyzw->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,IxXy,Jzyw,Yzxw->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Ixyz,JXyw,Yzxw->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('I,Ixyz,JxYw,yzXw->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('I,Ixyz,Jy,YzXx->IXJY', e_cvs_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('I,Ixyz,JwYy,zwXx->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('I,Ixyz,Jwyz,YwXx->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('J,IYxy,Jzxw,yzXw->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('J,Ix,Jyxz,YyXz->IXJY', e_cvs_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('J,IxXy,Jxzw,Yyzw->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,IxXy,Jzyw,Yzxw->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Ixyz,JXyw,Yzxw->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('J,Ixyz,JxYw,yzXw->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('J,Ixyz,Jy,YzXx->IXJY', e_cvs_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('J,Ixyz,JwYy,zwXx->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('J,Ixyz,Jwyz,YwXx->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('iY,IJ,ixyz,yzXx->IXJY', h_xa_so, np.identity(ncvs_so), t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('iY,IJ,ixyz,yzXx->IXJY', h_va_so, np.identity(ncvs_so), t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('ix,IJ,iYyz,yzXx->IXJY', h_xa_so, np.identity(ncvs_so), t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('ix,IJ,iyYz,xyXz->IXJY', h_xa_so, np.identity(ncvs_so), t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('ix,IJ,iYyz,yzXx->IXJY', h_va_so, np.identity(ncvs_so), t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('ix,IJ,iyYz,xyXz->IXJY', h_va_so, np.identity(ncvs_so), t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,Iyxz,Jywu,Yzwu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,Iyxz,Jwzu,Ywyu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,Jxyz,Iwyu,Yuzw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,Ixyz,Jwyu,zwXu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,Jyxz,Iywu,wuXz->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,Jyxz,Iwzu,yuXw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xy,IYxz,Jwyu,zwXu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IYxz,Jwzu,ywXu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xy,Ix,Jzyw,YzXw->IXJY', h_aa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IxXz,Jywu,Yzwu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IxXz,Jwzu,Ywyu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Ixzw,JXzu,Ywyu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Ixzw,JyYu,zwXu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Ixzw,Jz,YwXy->IXJY', h_aa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Ixzw,JuYz,wuXy->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,Ixzw,Juzw,YuXy->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IzXx,Jzwu,Yywu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xy,IzXx,Jwyu,Ywzu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xy,Izxw,JXyu,Ywzu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Izxw,JXwu,Yyzu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xy,Izxw,Jy,YwXz->IXJY', h_aa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Izxw,JzYu,ywXu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Izxw,Jw,YyXz->IXJY', h_aa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xy,Izxw,JuYy,wuXz->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Izxw,JuYw,yuXz->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xy,Izxw,Juyw,YuXz->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,JXxz,Iwzu,Yuyw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,JxYz,Iwzu,yuXw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jxzw,IYzu,yuXw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Jxzw,Iz,YyXw->IXJY', h_aa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Jxzw,IuXz,Yywu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,Jxzw,Iuzw,YyXu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,JzYx,Izwu,wuXy->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jzxw,IYwu,zuXy->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jzxw,IzXu,Yuyw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Jzxw,Iw,YzXy->IXJY', h_aa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Jzxw,IuXw,Yzyu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,iXYx,iyzw,zwxy->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,iXxy,iYzw,zwxy->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,iXYx,iyzw,zwxy->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,iXxy,iYzw,zwxy->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,iYXx,iyzw,xyzw->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,iYxy,izxw,yzXw->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,iYxy,iXzw,xyzw->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,iYXx,iyzw,xyzw->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,iYxy,izxw,yzXw->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,iYxy,iXzw,xyzw->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,iY,ixyz,yzXx->IXJY', np.identity(ncvs_so), t1_xa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ix,iYyz,yzXx->IXJY', np.identity(ncvs_so), t1_xa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,ix,iyYz,xyXz->IXJY', np.identity(ncvs_so), t1_xa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,ixXy,izYw,yzxw->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,ixYy,izXw,xwyz->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,ixYy,izyw,xwXz->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ixyz,iYXw,xwyz->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,ixyz,iYyw,xwXz->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,ixyz,iwYy,zwXx->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ixyz,iXYw,yzxw->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,iY,ixyz,yzXx->IXJY', np.identity(ncvs_so), t1_va, v_vaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ix,iYyz,yzXx->IXJY', np.identity(ncvs_so), t1_va, v_vaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,ix,iyYz,xyXz->IXJY', np.identity(ncvs_so), t1_va, v_vaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,ixXy,izYw,yzxw->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,ixYy,izXw,xwyz->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,ixYy,izyw,xwXz->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ixyz,iYXw,xwyz->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,ixyz,iYyw,xwXz->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,ixyz,iwYy,zwXx->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ixyz,iXYw,yzxw->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('XY,Ixyz,Jwyu,zwxu->IXJY', np.identity(ncas_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,Ixyz,Jxwu,yzwu->IXJY', np.identity(ncas_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,Jxyz,Ixwu,wuyz->IXJY', np.identity(ncas_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('XY,Jxyz,Iwyu,xuzw->IXJY', np.identity(ncas_so), t1_xaaa, v_xaaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('XY,ixyz,IiJw,xwyz->IXJY', np.identity(ncas_so), t1_xaaa, v_xxxa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('XY,ixyz,JiIw,yzxw->IXJY', np.identity(ncas_so), t1_xaaa, v_xxxa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('XY,ixyz,IiJw,xwyz->IXJY', np.identity(ncas_so), t1_vaaa, v_xvxa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('XY,ixyz,JiIw,yzxw->IXJY', np.identity(ncas_so), t1_vaaa, v_xvxa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('XxYy,Ixzw,Jyuv,zwuv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('XxYy,Ixzw,Juzv,wuyv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XxYy,Izyw,Jzuv,xwuv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('XxYy,Izyw,Juwv,xuzv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('XxYy,Jyzw,Iuzv,xvwu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XxYy,Jzxw,Izuv,uvyw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('XxYy,Jzxw,Iuyv,zvwu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('XxYy,Jzxw,Iuwv,zvyu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,IYyw,Jzuv,xwuv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,IYyw,Juwv,xuzv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Ixwu,JyYv,wuzv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Ixwu,Jw,Yuyz->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Ixwu,JvYw,uvyz->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('Xxyz,Ixwu,Jvwu,Yvyz->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Iy,Jzwu,Yxwu->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Xxyz,Iwyz,Jwuv,Yxuv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Xxyz,Iwyu,JzYv,xuwv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Iwyu,Jzuv,Yxwv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Iwyu,JwYv,xuzv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Iwyu,Ju,Yxzw->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Iwyu,JvYu,xvzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Xxyz,Jx,Iwyu,Yuzw->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,JyYw,Iuwv,xvzu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Jywu,IYwv,xvzu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Jywu,Iw,Yxzu->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xxyz,Jywu,Ivwu,Yxzv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Xxyz,JwYx,Iwuv,uvyz->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Xxyz,JwYx,Iuyv,wvzu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Xxyz,Jwxu,IYyv,wvzu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xxyz,Jwxu,IYuv,wvyz->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Xxyz,Jwxu,Iy,Ywzu->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Jwxu,Iu,Ywyz->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Jwxu,Ivyz,Ywuv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Xxyz,Jwxu,Ivyu,Ywzv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Yxyz,Ix,Jwyu,zwXu->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Yxyz,IyXw,Juzv,wuxv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,IyXw,Juwv,zuxv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Iywu,JXzv,wuxv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Iywu,JXwv,zuxv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Iywu,Jz,wuXx->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Iywu,Jw,zuXx->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Iywu,Jvzw,uvXx->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yxyz,Iywu,Jvwu,zvXx->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Yxyz,IwXx,Jwuv,yzuv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Yxyz,IwXx,Juyv,zuwv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Yxyz,Iwxu,JXyv,zuwv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yxyz,Iwxu,JXuv,yzwv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Yxyz,Iwxu,Jy,zuXw->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Iwxu,Ju,yzXw->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Iwxu,Jvyz,uvXw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Yxyz,Iwxu,Jvyu,zvXw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,JXyw,Iuwv,zvxu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Jxwu,IyXv,zvwu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Jxwu,Iw,yzXu->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Jxwu,IvXw,yzuv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('Yxyz,Jxwu,Ivwu,yzXv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Yxyz,Jwyz,Iwuv,uvXx->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Jwyu,IwXv,zvxu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Jwyu,Iu,zwXx->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Jwyu,IvXu,zwxv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,IYXx,Jyuv,zwuv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xyzw,IYXx,Juzv,wuyv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xyzw,IYxy,Juzv,wuXv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xyzw,IYxu,JXzv,wuyv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,IYxu,JXuv,zwyv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,IYxu,Jyuv,zwXv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xyzw,IYxu,Jz,wuXy->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,IYxu,Ju,zwXy->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xyzw,IYxu,Jvzw,uvXy->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xyzw,IYxu,Jvzu,wvXy->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xyzw,Ix,JXzu,Ywyu->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xyzw,Ix,JyYu,zwXu->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xyzw,Ix,Jz,YwXy->IXJY', v_aaaa_so, t1_xa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xyzw,Ix,JuYz,wuXy->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xyzw,Ix,Juzw,YuXy->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,IxXu,Jy,Yuzw->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xyzw,IxXu,JzYv,yuwv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,IxXu,Ju,Yyzw->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,IxXu,JvYy,uvzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,IxXu,JvYu,yvzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,IxXu,Jvyu,Yvzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Ixuv,JXYy,uvzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Ixuv,JXYu,yvzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Ixuv,JXyu,Yvzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('xyzw,Ixuv,JXuv,Yyzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,IuXx,JyYv,zwuv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xyzw,IuXx,Jz,Ywyu->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,IuXx,JuYv,zwyv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xyzw,IuXx,JvYz,wvyu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xyzw,IuXx,Jvzw,Yvyu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,Iuxy,JXzv,Ywuv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xyzw,Iuxy,Jz,YwXu->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Iuxy,JuYv,zwXv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xyzw,Iuxy,JvYz,wvXu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Iuxy,Jvzw,YvXu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xyzw,Iuxv,JXYz,wvyu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Iuxv,JXYv,zwyu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xyzw,Iuxv,JXzw,Yvyu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xyzw,Iuxv,JXzv,Ywyu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Iuxv,JyYv,zwXu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,JXxu,IYuv,yvzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,JXxu,Iu,Yyzw->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,JxYu,Iu,zwXy->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,JxYu,IvXu,zwyv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Jxuv,IYXu,zwyv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('xyzw,Jxuv,IYuv,zwXy->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,JuYx,IuXv,yvzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Juxy,IuXv,Yvzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Juxv,IYXv,yuzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('I,XY,Ixyz,Jxwu,yzwu->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,XY,Ixyz,Jwyu,zwxu->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('J,XY,Ixyz,Jxwu,yzwu->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,XY,Ixyz,Jwyu,zwxu->IXJY', e_cvs_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYXx,iyzw,xyzw->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('i,IJ,iYxy,iXzw,xyzw->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iYxy,iz,xyXz->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iYxy,izxw,yzXw->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('i,IJ,ix,iyYz,xyXz->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('i,IJ,ixXy,izYw,yzxw->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,ixYy,ixzw,zwXy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixYy,izyw,xwXz->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ixyz,iXYw,yzxw->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixyz,iYyw,xwXz->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixyz,iY,yzXx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('i,IJ,ixyz,ixYw,yzXw->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ixyz,iwYy,zwXx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,iYXx,iyzw,xyzw->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('i,IJ,iYxy,iXzw,xyzw->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iYxy,iz,xyXz->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,iYxy,izxw,yzXw->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('i,IJ,ix,iyYz,xyXz->IXJY', e_val_so, np.identity(ncvs_so), t1_va, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('i,IJ,ixXy,izYw,yzxw->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,ixYy,ixzw,zwXy->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixYy,izyw,xwXz->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ixyz,iXYw,yzxw->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixyz,iYyw,xwXz->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixyz,iY,yzXx->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('i,IJ,ixyz,ixYw,yzXw->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ixyz,iwYy,zwXx->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,IJ,iYxy,izwu,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,IJ,iYxy,izwu,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xx,IJ,ixYy,izwu,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('Xx,IJ,ixyz,iYwu,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xx,IJ,ixYy,izwu,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('Xx,IJ,ixyz,iYwu,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,iyxz,iwYu,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,iyxz,iwYu,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,iXxy,izwu,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,iXxy,izwu,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,ixXy,izwu,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('Yx,IJ,ixyz,iXwu,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,ixyz,iw,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ixyz,iwyu,zwXu->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,ixXy,izwu,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('Yx,IJ,ixyz,iXwu,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,ixyz,iw,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ixyz,iwyu,zwXu->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,iyxz,iywu,wuXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,iyxz,iywu,wuXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,ix,iyzw,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,iyxz,iywu,wuXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iyxz,iw,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iyxz,iwXu,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iyxz,iwzu,yuXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,ix,iyzw,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_va, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,iyxz,iywu,wuXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iyxz,iw,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,iyxz,iwXu,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,iyxz,iwzu,yuXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,iXYx,izwu,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,iXxz,iYwu,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,iXYx,izwu,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,iXxz,iYwu,wuyz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,iYXx,izwu,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,iYxz,iXwu,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,iYxz,iw,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xy,IJ,iYxz,iwyu,zwXu->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,iYxz,iwzu,ywXu->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,iYXx,izwu,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,iYxz,iXwu,yzwu->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,iYxz,iw,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xy,IJ,iYxz,iwyu,zwXu->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,iYxz,iwzu,ywXu->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixXz,iwYu,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixYz,iw,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixYz,iwXu,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixYz,iwzu,yuXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,ixzw,iXYu,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,ixzw,iYXu,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixzw,iYzu,yuXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ixzw,iY,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixzw,iuYz,wuXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixXz,iwYu,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixYz,iw,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixYz,iwXu,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixYz,iwzu,yuXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,ixzw,iXYu,zwyu->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,ixzw,iYXu,yuzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ixzw,iYzu,yuXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ixzw,iY,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ixzw,iuYz,wuXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,izYx,izwu,wuXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izxw,izYu,ywXu->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,izYx,izwu,wuXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izxw,izYu,ywXu->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ix,iYzw,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ix,izYw,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izXx,iwYu,ywzu->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,izYx,izwu,wuXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izYx,iw,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izYx,iwXu,zuyw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xy,IJ,izYx,iwyu,zuXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izxw,iXYu,ywzu->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izxw,iYXu,zuyw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izxw,iYwu,zuXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izxw,iY,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izxw,izYu,ywXu->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izxw,iuYw,yuXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ix,iYzw,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_va, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ix,izYw,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_va, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izXx,iwYu,ywzu->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,izYx,izwu,wuXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izYx,iw,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izYx,iwXu,zuyw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xy,IJ,izYx,iwyu,zuXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izxw,iXYu,ywzu->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izxw,iYXu,zuyw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izxw,iYwu,zuXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izxw,iY,ywXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,izxw,izYu,ywXu->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izxw,iuYw,yuXz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,XY,Ixzw,Jyuv,zwuv->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,XY,Ixzw,Juzv,wuyv->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,XY,Izxw,Jzuv,ywuv->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xy,XY,Izxw,Juyv,wuzv->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,XY,Izxw,Juwv,yuzv->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,XY,Jxzw,Iuzv,yvwu->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,XY,Jzxw,Izuv,uvyw->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,XY,Jzxw,Iuwv,zvyu->IXJY', h_aa_so, np.identity(ncas_so), t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,ixzw,iu,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,ixzw,iuzv,wuyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,ixzw,iu,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,ixzw,iuzv,wuyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,iyzw,iu,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,iyzw,iuzv,xvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,iyzw,iu,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,iyzw,iuzv,xvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,izxw,izuv,uvyw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,izyw,izuv,xwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,izxw,izuv,uvyw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,izyw,izuv,xwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,ix,izwu,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,iy,izwu,xzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,izxw,izuv,uvyw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,izxw,iu,zuyw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,XxYy,izxw,iuyv,zvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,izxw,iuwv,zvyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,izyw,izuv,xwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,izyw,iu,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,izyw,iuwv,xuzv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,ix,izwu,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,iy,izwu,xzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,izxw,izuv,uvyw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,izxw,iu,zuyw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,XxYy,izxw,iuyv,zvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,izxw,iuwv,zvyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,izyw,izuv,xwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,izyw,iu,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,izyw,iuwv,xuzv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Xxyz,iYyz,iwuv,xwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,iYyw,izuv,xwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iYyw,iu,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iYyw,iuwv,xuzv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Xxyz,iYyz,iwuv,xwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,iYyw,izuv,xwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iYyw,iu,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iYyw,iuwv,xuzv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,ixwu,iY,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,ixwu,ivYw,uvyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,ixwu,iY,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,ixwu,ivYw,uvyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iyYw,iu,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iyYw,iuzv,xvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iyYw,iuwv,xvzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iywu,iYwv,xvzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iyYw,iu,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iyYw,iuzv,xvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iyYw,iuwv,xvzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iywu,iYwv,xvzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Xxyz,iwYx,iwuv,uvyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iwyu,iwYv,xuzv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Xxyz,iwYx,iwuv,uvyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iwyu,iwYv,xuzv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,ix,iYwu,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iy,iwYu,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,iwYx,iwuv,uvyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,iwYx,iu,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,Xxyz,iwYx,iuyv,wvzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,Xxyz,iwxu,iYyv,wvzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,iwxu,iYuv,wvyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,iwyz,iuYv,xuwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iwyu,iY,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iwyu,iwYv,xuzv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iwyu,ivYu,xvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,ix,iYwu,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iy,iwYu,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,iwYx,iwuv,uvyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,iwYx,iu,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,Xxyz,iwYx,iuyv,wvzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,Xxyz,iwxu,iYyv,wvzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,iwxu,iYuv,wvyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,iwyz,iuYv,xuwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iwyu,iY,xuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,iwyu,iwYv,xuzv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iwyu,ivYu,xvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,iXyz,iwuv,uvxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iXyw,izuv,uvxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iXyw,iu,zuxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iXyw,iuwv,zvxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,iXyz,iwuv,uvxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iXyw,izuv,uvxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iXyw,iu,zuxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iXyw,iuwv,zvxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,ixwu,iX,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iw,yzXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivXw,yzuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,ixwu,ivwu,yzXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,ixwu,iX,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iw,yzXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivXw,yzuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,ixwu,ivwu,yzXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iyXw,iu,zwxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iyXw,iuzv,wuxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyXw,iuwv,zuxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iywu,iXwv,zuxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iywu,iz,wuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iywu,iw,zuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iywu,ivzw,uvXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iywu,ivwu,zvXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iyXw,iu,zwxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iyXw,iuzv,wuxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iyXw,iuwv,zuxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iywu,iXwv,zuxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iywu,iz,wuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iywu,iw,zuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iywu,ivzw,uvXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iywu,ivwu,zvXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,iwXx,iwuv,yzuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,iwyz,iwuv,uvXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iwyu,iwXv,zvxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,iwXx,iwuv,yzuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,iwyz,iwuv,uvXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iwyu,iwXv,zvxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,ix,iXwu,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ix,iw,yzXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,Yxyz,ix,iwyu,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iy,iw,zwXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iy,iwXu,zuxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,iwXx,iwuv,yzuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwXx,iu,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,Yxyz,iwXx,iuyv,zuwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,Yxyz,iwxu,iXyv,zuwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwxu,iXuv,yzwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,Yxyz,iwxu,iy,zuXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iwxu,iu,yzXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iwxu,ivyz,uvXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,Yxyz,iwxu,ivyu,zvXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,iwyz,iwuv,uvXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwyz,iu,wuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwyz,iuXv,wvxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iwyu,iX,zwxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iwyu,iwXv,zvxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iwyu,iu,zwXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivXu,zwxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,ix,iXwu,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ix,iw,yzXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,Yxyz,ix,iwyu,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iy,iw,zwXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iy,iwXu,zuxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,iwXx,iwuv,yzuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwXx,iu,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,Yxyz,iwXx,iuyv,zuwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,Yxyz,iwxu,iXyv,zuwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwxu,iXuv,yzwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,Yxyz,iwxu,iy,zuXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iwxu,iu,yzXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iwxu,ivyz,uvXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,Yxyz,iwxu,ivyu,zvXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,iwyz,iwuv,uvXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwyz,iu,wuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwyz,iuXv,wvxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iwyu,iX,zwxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iwyu,iwXv,zvxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iwyu,iu,zwXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivXu,zwxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iXYx,iyuv,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iXYx,iu,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,iXYx,iuzv,yvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('IJ,xyzw,iXxy,iYuv,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,iXxu,iYzv,yvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iXxu,iYuv,yvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iXYx,iyuv,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iXYx,iu,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,iXYx,iuzv,yvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('IJ,xyzw,iXxy,iYuv,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,iXxu,iYzv,yvwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iXxu,iYuv,yvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iYXx,iyuv,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iYXx,iu,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,iYXx,iuzv,wuyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('IJ,xyzw,iYxy,iXuv,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iYxy,iu,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,xyzw,iYxy,iuzv,wuXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iYxu,iXuv,zwyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iYxu,iyuv,zwXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,xyzw,iYxu,iz,wuXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iYxu,iu,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,xyzw,iYxu,ivzw,uvXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,xyzw,iYxu,ivzu,wvXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iYXx,iyuv,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iYXx,iu,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,iYXx,iuzv,wuyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('IJ,xyzw,iYxy,iXuv,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iYxy,iu,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,xyzw,iYxy,iuzv,wuXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iYxu,iXuv,zwyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iYxu,iyuv,zwXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,xyzw,iYxu,iz,wuXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iYxu,iu,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,xyzw,iYxu,ivzw,uvXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('IJ,xyzw,iYxu,ivzu,wvXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixXu,iY,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixXu,ivYy,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixXu,ivYu,yvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixYu,iX,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixYu,iy,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixYu,iu,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivXy,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixYu,ivXu,zwyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivyu,zwXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixuv,iXYu,yvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixuv,iYXu,zwyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,ixuv,iYuv,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixXu,iY,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixXu,ivYy,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixXu,ivYu,yvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixYu,iX,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixYu,iy,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixYu,iu,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivXy,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixYu,ivXu,zwyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivyu,zwXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixuv,iXYu,yvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixuv,iYXu,zwyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,ixuv,iYuv,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuXx,iuYv,zwyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuYx,iuXv,yvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,iuxy,iuYv,zwXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuXx,iuYv,zwyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuYx,iuXv,yvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,iuxy,iuYv,zwXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ix,iXYu,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ix,iYXu,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ix,iY,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,ix,iuYz,wuXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuXx,iY,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuXx,iuYv,zwyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,iuXx,ivYz,wvyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuYx,iX,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuYx,iuXv,yvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,xyzw,iuYx,ivzw,yuXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iuxy,iXYv,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iuxy,iYXv,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,iuxy,iY,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iuxy,iuYv,zwXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuxv,iXYv,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuxv,iYXv,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ix,iXYu,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ix,iYXu,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ix,iY,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,ix,iuYz,wuXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuXx,iY,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuXx,iuYv,zwyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,iuXx,ivYz,wvyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuYx,iX,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuYx,iuXv,yvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,xyzw,iuYx,ivzw,yuXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iuxy,iXYv,zwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iuxy,iYXv,uvzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,iuxy,iY,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iuxy,iuYv,zwXv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuxv,iXYv,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuxv,iYXv,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Ix,Jyuv,zwuv->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('XY,xyzw,Ix,Juzv,wuyv->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Ixuv,Jy,uvzw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Ixuv,Ju,yvzw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Ixuv,Jsyu,vszw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('XY,xyzw,Ixuv,Jsuv,yszw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/16 * einsum('XY,xyzw,Iuxy,Juvs,zwvs->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('XY,xyzw,Iuxy,Jvzs,wvus->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Iuxv,Jyvs,zwus->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('XY,xyzw,Iuxv,Jz,wvyu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Iuxv,Jv,zwyu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,xyzw,Iuxv,Jszw,vsyu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('XY,xyzw,Iuxv,Jszv,wsyu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Jxuv,Iu,zwyv->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('XY,xyzw,Jxuv,Isuv,zwys->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/16 * einsum('XY,xyzw,Juxy,Iuvs,vszw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Juxv,Iv,yuzw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Ixyz,Jwyu,YzwXxu->IXJY', t1_xaaa, v_xaaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Ixyz,Jxwu,YyzXwu->IXJY', t1_xaaa, v_xaaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Jxyz,Ixwu,YwuXyz->IXJY', t1_xaaa, v_xaaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= einsum('Jxyz,Iwyu,YxuXzw->IXJY', t1_xaaa, v_xaaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('ixyz,IiJw,YxwXyz->IXJY', t1_xaaa, v_xxxa_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('ixyz,JiIw,YyzXxw->IXJY', t1_xaaa, v_xxxa_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('ixyz,IiJw,YxwXyz->IXJY', t1_vaaa, v_xvxa_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('ixyz,JiIw,YyzXxw->IXJY', t1_vaaa, v_xvxa_so, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('I,Ixyz,Jxwu,YyzXwu->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('I,Ixyz,Jwyu,YzwXxu->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('J,Ixyz,Jxwu,YyzXwu->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('J,Ixyz,Jwyu,YzwXxu->IXJY', e_cvs_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,Ixzw,Jyuv,YzwXuv->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Ixzw,Juzv,YwuXyv->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,Izxw,Jzuv,YywXuv->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= einsum('xy,Izxw,Juyv,YwuXzv->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Izxw,Juwv,YyuXzv->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Jxzw,Iuzv,YyvXwu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,Jzxw,Izuv,YuvXyw->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,Jzxw,Iuwv,YzvXyu->IXJY', h_aa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,iYxy,izwu,xyzXwu->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,iYxy,izwu,xyzXwu->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ixYy,izwu,xwuXyz->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,ixyz,iYwu,xwuXyz->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ixyz,iwYu,yzwXxu->IXJY', np.identity(ncvs_so), t1_xaaa, v_xaaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ixYy,izwu,xwuXyz->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,ixyz,iYwu,xwuXyz->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ixyz,iwYu,yzwXxu->IXJY', np.identity(ncvs_so), t1_vaaa, v_vaaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xxyz,Ixwu,Jyvs,Ywuzvs->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Ixwu,Jvws,Yuvyzs->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Iwyu,Jzvs,Yxuwvs->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Iwyu,Jwvs,Yxuzvs->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Iwyu,Jvus,Yxvzws->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xxyz,Jywu,Ivws,Yxszuv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Xxyz,Jwxu,Iwvs,Yvsyzu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += einsum('Xxyz,Jwxu,Ivys,Ywszuv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Jwxu,Ivus,Ywsyzv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Iywu,Jvzs,wuvXxs->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Iywu,Jvws,zuvXxs->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Yxyz,Iwxu,Jwvs,yzuXvs->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += einsum('Yxyz,Iwxu,Jvys,zuvXws->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Iwxu,Jvus,yzvXws->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yxyz,Jxwu,Iyvs,zvsXwu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Jxwu,Ivws,yzsXuv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Jwyu,Iwvs,zvsXxu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yxyz,Jwyu,Ivus,zwsXxv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,IYxu,Jyvs,zwuXvs->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += einsum('xyzw,IYxu,Jvzs,wuvXys->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,IYxu,Jvus,zwvXys->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Ix,Jyuv,YzwXuv->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= einsum('xyzw,Ix,Juzv,YwuXyv->IXJY', v_aaaa_so, t1_xa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xyzw,IxXu,Jzvs,Yyuwvs->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,IxXu,Jvys,Yuvzws->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,IxXu,Jvus,Yyvzws->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Ixuv,JXys,Yuvzws->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Ixuv,JXus,Yyvzws->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Ixuv,Jy,YuvXzw->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xyzw,Ixuv,JzYs,yuvXws->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Ixuv,Ju,YyvXzw->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Ixuv,JsYy,uvsXzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Ixuv,JsYu,yvsXzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Ixuv,Jsyu,YvsXzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Ixuv,Jsuv,YysXzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,IuXx,Jyvs,Yzwuvs->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,IuXx,Juvs,Yzwyvs->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= einsum('xyzw,IuXx,Jvzs,Ywvyus->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('xyzw,Iuxy,Juvs,YzwXvs->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xyzw,Iuxy,Jvzs,YwvXus->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= einsum('xyzw,Iuxv,JXzs,Ywvyus->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Iuxv,JXvs,Yzwyus->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,Iuxv,JyYs,zwvXus->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Iuxv,Jyvs,YzwXus->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= einsum('xyzw,Iuxv,Jz,YwvXyu->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Iuxv,JuYs,zwvXys->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Iuxv,Jv,YzwXyu->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_cccaaa_so, optimize = einsum_type)
temp += einsum('xyzw,Iuxv,JsYz,wvsXyu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iuxv,JsYv,zwsXyu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,Iuxv,Jszw,YvsXyu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= einsum('xyzw,Iuxv,Jszv,YwsXyu->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,JXxu,Ivus,Yyszwv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,JxYu,Ivus,zwsXyv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Jxuv,IYus,zwsXyv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Jxuv,Iu,YzwXyv->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Jxuv,IsXu,Yzwyvs->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Jxuv,Isuv,YzwXys->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,JuYx,Iuvs,yvsXzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('xyzw,Juxy,Iuvs,YvsXzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Juxv,IYvs,yusXzw->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Juxv,IuXs,Yyszwv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Juxv,Iv,YyuXzw->IXJY', v_aaaa_so, t1_xaaa, t1_xa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Juxv,IsXv,Yyuzws->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,iYxy,izwu,xyzXwu->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixyz,iwYu,yzwXxu->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,iYxy,izwu,xyzXwu->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ixyz,iwYu,yzwXxu->IXJY', e_val_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Yx,IJ,ixyz,iwuv,yzwXuv->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Yx,IJ,ixyz,iwuv,yzwXuv->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,iyxz,iwuv,yuvXzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,iyxz,iwuv,yuvXzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,iYxz,iwuv,yzwXuv->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,iYxz,iwuv,yzwXuv->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,ixYz,iwuv,yuvXzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xy,IJ,ixzw,iYuv,yuvXzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ixzw,iuYv,zwuXyv->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IJ,ixYz,iwuv,yuvXzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xy,IJ,ixzw,iYuv,yuvXzw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ixzw,iuYv,zwuXyv->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,izYx,iwuv,zuvXyw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,izxw,iYuv,zuvXyw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izxw,iuYv,ywuXzv->IXJY', h_aa_so, np.identity(ncvs_so), t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,izYx,iwuv,zuvXyw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,izxw,iYuv,zuvXyw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,izxw,iuYv,ywuXzv->IXJY', h_aa_so, np.identity(ncvs_so), t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,XxYy,ixzw,iuvs,zwuyvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,XxYy,ixzw,iuvs,zwuyvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,XxYy,iyzw,iuvs,xvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,XxYy,iyzw,iuvs,xvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,izxw,iuvs,zvsywu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,izyw,iuvs,xwuzvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,izxw,iuvs,zvsywu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,izyw,iuvs,xwuzvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,iYyw,iuvs,xwuzvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,iYyw,iuvs,xwuzvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,ixwu,ivYs,wuvyzs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,ixwu,ivYs,wuvyzs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,iyYw,iuvs,xvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,iywu,iYvs,xvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,iyYw,iuvs,xvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,iywu,iYvs,xvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,iwYx,iuvs,wvsyzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,iwxu,iYvs,wvsyzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iwyu,ivYs,xuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,iwYx,iuvs,wvsyzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,iwxu,iYvs,wvsyzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,iwyu,ivYs,xuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iXyw,iuvs,zvsxwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iXyw,iuvs,zvsxwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,ixwu,iv,yzvXwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,ixwu,ivXs,yzswuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivws,yzsXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,ixwu,iv,yzvXwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,ixwu,ivXs,yzswuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivws,yzsXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iyXw,iuvs,zwuxvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,iywu,iXvs,zwuxvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iywu,iv,zwuXxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivzs,wuvXxs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iywu,ivws,zuvXxs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iyXw,iuvs,zwuxvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,iywu,iXvs,zwuxvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iywu,iv,zwuXxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivzs,wuvXxs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iywu,ivws,zuvXxs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,iwxu,iwvs,yzuXvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwyu,iwvs,zvsXxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,iwxu,iwvs,yzuXvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwyu,iwvs,zvsXxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,ix,iwuv,yzwXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iy,iwuv,zuvXxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,iwXx,iuvs,yzuwvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,iwxu,iXvs,yzuwvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,iwxu,iwvs,yzuXvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwxu,iv,yzuXwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_cccaaa_so, optimize = einsum_type)
temp -= einsum('IJ,Yxyz,iwxu,ivys,zuvXws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iwxu,ivus,yzvXws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,iwyz,iuvs,wvsXxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iwyu,iwvs,zvsXxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iwyu,iv,zwvXxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivXs,zwsxuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivus,zwsXxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,ix,iwuv,yzwXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iy,iwuv,zuvXxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,iwXx,iuvs,yzuwvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,iwxu,iXvs,yzuwvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,iwxu,iwvs,yzuXvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwxu,iv,yzuXwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_cccaaa_so, optimize = einsum_type)
temp -= einsum('IJ,Yxyz,iwxu,ivys,zuvXws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iwxu,ivus,yzvXws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,iwyz,iuvs,wvsXxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,iwyu,iwvs,zvsXxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,iwyu,iv,zwvXxu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivXs,zwsxuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivus,zwsXxv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iXYx,iuvs,yvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iXxu,iYvs,yvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iXYx,iuvs,yvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iXxu,iYvs,yvszwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iYXx,iuvs,zwuyvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,xyzw,iYxy,iuvs,zwuXvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iYxu,iXvs,zwuyvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iYxu,iyvs,zwuXvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iYxu,iv,zwuXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_cccaaa_so, optimize = einsum_type)
temp -= einsum('IJ,xyzw,iYxu,ivzs,wuvXys->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iYxu,ivus,zwvXys->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iYXx,iuvs,zwuyvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,xyzw,iYxy,iuvs,zwuXvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iYxu,iXvs,zwuyvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iYxu,iyvs,zwuXvs->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iYxu,iv,zwuXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_cccaaa_so, optimize = einsum_type)
temp -= einsum('IJ,xyzw,iYxu,ivzs,wuvXys->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iYxu,ivus,zwvXys->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixXu,ivYs,yuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixYu,iv,zwvXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixYu,ivXs,zwsyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivys,zwsXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixYu,ivus,zwsXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ixuv,iXYs,yuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ixuv,iYXs,zwsyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixuv,iYus,zwsXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ixuv,iY,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ixuv,isYy,uvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixuv,isYu,yvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixXu,ivYs,yuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixYu,iv,zwvXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixYu,ivXs,zwsyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivys,zwsXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixYu,ivus,zwsXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ixuv,iXYs,yuvzws->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ixuv,iYXs,zwsyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ixuv,iYus,zwsXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ixuv,iY,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ixuv,isYy,uvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ixuv,isYu,yvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,iuYx,iuvs,yvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuxv,iuYs,zwvXys->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,iuYx,iuvs,yvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuxv,iuYs,zwvXys->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ix,iYuv,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ix,iuYv,zwuXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuXx,ivYs,zwvyus->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iuYx,iuvs,yvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuYx,iv,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuYx,ivXs,yuszwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,iuYx,ivzs,yusXwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,xyzw,iuxy,iYvs,uvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,iuxy,ivYs,zwvXus->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuxv,iXYs,zwvyus->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuxv,iYXs,yuszwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuxv,iYvs,yusXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuxv,iY,zwvXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuxv,iuYs,zwvXys->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuxv,isYv,zwsXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ix,iYuv,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ix,iuYv,zwuXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_va, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuXx,ivYs,zwvyus->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,iuYx,iuvs,yvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuYx,iv,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuYx,ivXs,yuszwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += einsum('IJ,xyzw,iuYx,ivzs,yusXwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,xyzw,iuxy,iYvs,uvsXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,iuxy,ivYs,zwvXus->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuxv,iXYs,zwvyus->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuxv,iYXs,yuszwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuxv,iYvs,yusXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuxv,iY,zwvXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_va, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuxv,iuYs,zwvXys->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,iuxv,isYv,zwsXyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Ixuv,Jzst,yuvwst->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Ixuv,Jsyt,uvszwt->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Ixuv,Jsut,yvszwt->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Iuxv,Jyst,zwvust->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('XY,xyzw,Iuxv,Just,zwvyst->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += einsum('XY,xyzw,Iuxv,Jszt,wvsyut->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Iuxv,Jsvt,zwsyut->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Jxuv,Isut,zwtyvs->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('XY,xyzw,Juxv,Iust,ystzwv->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,xyzw,Juxv,Isvt,yutzws->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Ixuv,Jzst,YyuvXwst->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Ixuv,Jsyt,YuvsXzwt->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Ixuv,Jsut,YyvsXzwt->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iuxv,Jyst,YzwvXust->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Iuxv,Just,YzwvXyst->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += einsum('xyzw,Iuxv,Jszt,YwvsXyut->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iuxv,Jsvt,YzwsXyut->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Jxuv,Isut,YzwtXyvs->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Juxv,Iust,YystXzwv->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Juxv,Isvt,YyutXzws->IXJY', v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,Yxyz,ixwu,ivst,yzstXwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,Yxyz,ixwu,ivst,yzstXwuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,iywu,ivst,zwuvXxst->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,iywu,ivst,zwuvXxst->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,iwxu,ivst,yzuvXwst->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwyu,ivst,zwstXxuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,iwxu,ivst,yzuvXwst->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,iwyu,ivst,zwstXxuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,iYxu,ivst,zwuvXyst->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,iYxu,ivst,zwuvXyst->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ixYu,ivst,zwstXyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,xyzw,ixuv,iYst,zwstXyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,ixuv,isYt,yuvsXzwt->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ixYu,ivst,zwstXyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,xyzw,ixuv,iYst,zwstXyuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,ixuv,isYt,yuvsXzwt->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,iuYx,ivst,yustXzwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,iuxv,iYst,yustXzwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuxv,isYt,zwvsXyut->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xaaa, t1_xaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,iuYx,ivst,yustXzwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,iuxv,iYst,yustXzwv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,iuxv,isYt,zwvsXyut->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vaaa, t1_vaaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp  = einsum('IiXx,JiYx->IXJY', t1_xxaa, v_xxaa_so, optimize = einsum_type)
temp += einsum('IiXx,JiYx->IXJY', t1_xvaa, v_xvaa_so, optimize = einsum_type)
temp += einsum('JiYx,IiXx->IXJY', t1_xxaa, v_xxaa_so, optimize = einsum_type)
temp += einsum('JiYx,IiXx->IXJY', t1_xvaa, v_xvaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,IiXx,JiYx->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, optimize = einsum_type)
temp -= 1/2 * einsum('I,IiXx,JiYx->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, optimize = einsum_type)
temp -= 1/2 * einsum('J,IiXx,JiYx->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, optimize = einsum_type)
temp -= 1/2 * einsum('J,IiXx,JiYx->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, optimize = einsum_type)
temp -= 1/2 * einsum('i,IiXx,JiYx->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, optimize = einsum_type)
temp -= 1/2 * einsum('i,JiYx,IiXx->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, optimize = einsum_type)
temp -= 1/2 * einsum('i,IiXx,JiYx->IXJY', e_val_so, t1_xvaa, t1_xvaa, optimize = einsum_type)
temp -= 1/2 * einsum('i,JiYx,IiXx->IXJY', e_val_so, t1_xvaa, t1_xvaa, optimize = einsum_type)
temp += 1/2 * einsum('Xx,Iixy,JiYy->IXJY', h_aa_so, t1_xxaa, t1_xxaa, optimize = einsum_type)
temp += 1/2 * einsum('Xx,Iixy,JiYy->IXJY', h_aa_so, t1_xvaa, t1_xvaa, optimize = einsum_type)
temp += 1/2 * einsum('Yx,Jixy,IiXy->IXJY', h_aa_so, t1_xxaa, t1_xxaa, optimize = einsum_type)
temp += 1/2 * einsum('Yx,Jixy,IiXy->IXJY', h_aa_so, t1_xvaa, t1_xvaa, optimize = einsum_type)
temp += einsum('xy,IiXx,JiYy->IXJY', h_aa_so, t1_xxaa, t1_xxaa, optimize = einsum_type)
temp += einsum('xy,IiXx,JiYy->IXJY', h_aa_so, t1_xvaa, t1_xvaa, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ijXx,ijYx->IXJY', np.identity(ncvs_so), t1_xxaa, v_xxaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ijYx,ijXx->IXJY', np.identity(ncvs_so), t1_xxaa, v_xxaa_so, optimize = einsum_type)
temp -= einsum('IJ,ijXx,ijYx->IXJY', np.identity(ncvs_so), t1_xvaa, v_xvaa_so, optimize = einsum_type)
temp -= einsum('IJ,ijYx,ijXx->IXJY', np.identity(ncvs_so), t1_xvaa, v_xvaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ijXx,ijYx->IXJY', np.identity(ncvs_so), t1_vvaa, v_vvaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ijYx,ijXx->IXJY', np.identity(ncvs_so), t1_vvaa, v_vvaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,Iixy,Jixy->IXJY', np.identity(ncas_so), t1_xxaa, v_xxaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,Iixy,Jixy->IXJY', np.identity(ncas_so), t1_xvaa, v_xvaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,Jixy,Iixy->IXJY', np.identity(ncas_so), t1_xxaa, v_xxaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('XY,Jixy,Iixy->IXJY', np.identity(ncas_so), t1_xvaa, v_xvaa_so, optimize = einsum_type)
temp -= einsum('XxYy,Jixz,Iiyz->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, optimize = einsum_type)
temp -= einsum('XxYy,Jixz,Iiyz->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,JiYx,Iiyz->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,JiYx,Iiyz->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,IiXx,Jiyz->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,IiXx,Jiyz->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, optimize = einsum_type)
temp += 1/4 * einsum('I,XY,Iixy,Jixy->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, optimize = einsum_type)
temp += 1/4 * einsum('I,XY,Iixy,Jixy->IXJY', e_cvs_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, optimize = einsum_type)
temp += 1/4 * einsum('J,XY,Iixy,Jixy->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, optimize = einsum_type)
temp += 1/4 * einsum('J,XY,Iixy,Jixy->IXJY', e_cvs_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijXx,ijYx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijYx,ijXx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijXx,ijYx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijYx,ijXx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, optimize = einsum_type)
temp += 1/4 * einsum('i,XY,Iixy,Jixy->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, optimize = einsum_type)
temp += 1/4 * einsum('i,XY,Jixy,Iixy->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijXx,ijYx->IXJY', e_val_so, np.identity(ncvs_so), t1_vxaa, t1_vxaa, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijYx,ijXx->IXJY', e_val_so, np.identity(ncvs_so), t1_vxaa, t1_vxaa, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijXx,ijYx->IXJY', e_val_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijYx,ijXx->IXJY', e_val_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, optimize = einsum_type)
temp += 1/4 * einsum('i,XY,Iixy,Jixy->IXJY', e_val_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, optimize = einsum_type)
temp += 1/4 * einsum('i,XY,Jixy,Iixy->IXJY', e_val_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,IJ,ijxy,ijYy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,IJ,ijxy,ijYy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vxaa, t1_vxaa, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,IJ,ijxy,ijYy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,ijxy,ijXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ijxy,ijXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vxaa, t1_vxaa, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,ijxy,ijXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ijXx,ijYy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ijXx,ijYy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ijXx,ijYy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vxaa, t1_vxaa, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ijXx,ijYy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, optimize = einsum_type)
temp -= einsum('xy,XY,Iixz,Jiyz->IXJY', h_aa_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, optimize = einsum_type)
temp -= einsum('xy,XY,Iixz,Jiyz->IXJY', h_aa_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,ijxz,ijyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,ijxz,ijyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,ijxz,ijyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,ijxz,ijyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,ijYx,ijyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,ijYx,ijyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,ijYx,ijyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,ijYx,ijyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijXx,ijyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijXx,ijyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijXx,ijyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijXx,ijyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Iixy,Jizw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xxaa, t1_xxaa, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Iixy,Jizw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xvaa, t1_xvaa, optimize = einsum_type)
temp -= einsum('IiXx,JiYy,xy->IXJY', t1_xxaa, v_xxaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IiXx,Jixy,Yy->IXJY', t1_xxaa, v_xxaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Iixy,JiYx,yX->IXJY', t1_xxaa, v_xxaa_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Iixy,Jixy,YX->IXJY', t1_xxaa, v_xxaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IiXx,JiYy,xy->IXJY', t1_xvaa, v_xvaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IiXx,Jixy,Yy->IXJY', t1_xvaa, v_xvaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Iixy,JiYx,yX->IXJY', t1_xvaa, v_xvaa_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Iixy,Jixy,YX->IXJY', t1_xvaa, v_xvaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('JiYx,IiXy,yx->IXJY', t1_xxaa, v_xxaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('JiYx,Iixy,yX->IXJY', t1_xxaa, v_xxaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Jixy,IiXx,Yy->IXJY', t1_xxaa, v_xxaa_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Jixy,Iixy,YX->IXJY', t1_xxaa, v_xxaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('JiYx,IiXy,yx->IXJY', t1_xvaa, v_xvaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('JiYx,Iixy,yX->IXJY', t1_xvaa, v_xvaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('Jixy,IiXx,Yy->IXJY', t1_xvaa, v_xvaa_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Jixy,Iixy,YX->IXJY', t1_xvaa, v_xvaa_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,IiXx,JiYy,xy->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,IiXx,Jixy,Yy->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Iixy,JiYx,yX->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('I,Iixy,Jixy,YX->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('I,IiXx,JiYy,xy->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,IiXx,Jixy,Yy->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Iixy,JiYx,yX->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('I,Iixy,Jixy,YX->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,IiXx,JiYy,xy->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,IiXx,Jixy,Yy->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Iixy,JiYx,yX->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('J,Iixy,Jixy,YX->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('J,IiXx,JiYy,xy->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,IiXx,Jixy,Yy->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Iixy,JiYx,yX->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('J,Iixy,Jixy,YX->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('i,IiXx,JiYy,xy->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IiXx,Jixy,Yy->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Iixy,JiYx,yX->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,Iixy,Jixy,YX->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,JiYx,Iixy,yX->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Jixy,IiXx,Yy->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,Jixy,Iixy,YX->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('i,IiXx,JiYy,xy->IXJY', e_val_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IiXx,Jixy,Yy->IXJY', e_val_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Iixy,JiYx,yX->IXJY', e_val_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,Iixy,Jixy,YX->IXJY', e_val_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,JiYx,Iixy,yX->IXJY', e_val_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Jixy,IiXx,Yy->IXJY', e_val_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,Jixy,Iixy,YX->IXJY', e_val_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,Iixy,JiYz,yz->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,Iixy,Jiyz,Yz->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Xx,Iixy,JiYz,yz->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,Iixy,Jiyz,Yz->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,Jixy,IiXz,zy->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,Jixy,Iiyz,zX->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,Jixy,IiXz,zy->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,Jixy,Iiyz,zX->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IiXx,JiYz,yz->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,IiXx,Jiyz,Yz->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,Iixz,JiYy,zX->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Iixz,JiYz,yX->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,Iixz,Jiyz,YX->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IiXx,JiYz,yz->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,IiXx,Jiyz,Yz->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,Iixz,JiYy,zX->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Iixz,JiYz,yX->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,Iixz,Jiyz,YX->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,JiYx,IiXz,zy->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jixz,IiXz,Yy->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,JiYx,IiXz,zy->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jixz,IiXz,Yy->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ijXx,ijYy,xy->IXJY', np.identity(ncvs_so), t1_xxaa, v_xxaa_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ijYx,ijXy,yx->IXJY', np.identity(ncvs_so), t1_xxaa, v_xxaa_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ijYx,ijxy,yX->IXJY', np.identity(ncvs_so), t1_xxaa, v_xxaa_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ijxy,ijYx,yX->IXJY', np.identity(ncvs_so), t1_xxaa, v_xxaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ijYx,ijxy,yX->IXJY', np.identity(ncvs_so), t1_xvaa, v_xvaa_so, rdm_ca_so, optimize = einsum_type)
temp -= einsum('IJ,ijxy,ijYx,yX->IXJY', np.identity(ncvs_so), t1_xvaa, v_xvaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ijXx,ijYy,xy->IXJY', np.identity(ncvs_so), t1_vxaa, v_vxaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('IJ,ijYx,ijXy,yx->IXJY', np.identity(ncvs_so), t1_vxaa, v_vxaa_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ijXx,ijYy,xy->IXJY', np.identity(ncvs_so), t1_vvaa, v_vvaa_so, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ijYx,ijXy,yx->IXJY', np.identity(ncvs_so), t1_vvaa, v_vvaa_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ijYx,ijxy,yX->IXJY', np.identity(ncvs_so), t1_vvaa, v_vvaa_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,ijxy,ijYx,yX->IXJY', np.identity(ncvs_so), t1_vvaa, v_vvaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,Iixy,Jixz,yz->IXJY', np.identity(ncas_so), t1_xxaa, v_xxaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,Iixy,Jixz,yz->IXJY', np.identity(ncas_so), t1_xvaa, v_xvaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,Jixy,Iixz,zy->IXJY', np.identity(ncas_so), t1_xxaa, v_xxaa_so, rdm_ca_so, optimize = einsum_type)
temp += einsum('XY,Jixy,Iixz,zy->IXJY', np.identity(ncas_so), t1_xvaa, v_xvaa_so, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('XxYy,Iiyz,Jizw,xw->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('XxYy,Iiyz,Jizw,xw->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('XxYy,Jixz,Iiyw,wz->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('XxYy,Jixz,Iizw,wy->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('XxYy,Jixz,Iiyw,wz->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('XxYy,Jixz,Iizw,wy->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xxyz,Iiyz,JiYw,xw->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Iiyw,JiYw,xz->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xxyz,Iiyz,JiYw,xw->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Iiyw,JiYw,xz->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Xxyz,JiYx,Iiyw,wz->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Jixw,Iiyz,Yw->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Xxyz,Jixw,Iiyw,Yz->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Xxyz,JiYx,Iiyw,wz->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Jixw,Iiyz,Yw->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Xxyz,Jixw,Iiyw,Yz->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Yxyz,IiXx,Jiyw,zw->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Iixw,Jiyz,wX->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Yxyz,Iixw,Jiyw,zX->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Yxyz,IiXx,Jiyw,zw->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Iixw,Jiyz,wX->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('Yxyz,Iixw,Jiyw,zX->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yxyz,Jiyz,IiXw,wx->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Jiyw,IiXw,zx->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yxyz,Jiyz,IiXw,wx->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Jiyw,IiXw,zx->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xyzw,IiXx,JiYz,wy->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,IiXx,Jizw,Yy->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,Iixy,JiYz,wX->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iixy,Jizw,YX->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xyzw,IiXx,JiYz,wy->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,IiXx,Jizw,Yy->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,Iixy,JiYz,wX->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iixy,Jizw,YX->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,XY,Iixy,Jixz,yz->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,XY,Iixy,Jixz,yz->IXJY', e_cvs_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,XY,Iixy,Jixz,yz->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,XY,Iixy,Jixz,yz->IXJY', e_cvs_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijXx,ijYy,xy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijYx,ijXy,yx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijYx,ijxy,yX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijxy,ijYx,yX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijXx,ijYy,xy->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijYx,ijXy,yx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijYx,ijxy,yX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijxy,ijYx,yX->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,XY,Iixy,Jixz,yz->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,XY,Jixy,Iixz,zy->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijXx,ijYy,xy->IXJY', e_val_so, np.identity(ncvs_so), t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijYx,ijXy,yx->IXJY', e_val_so, np.identity(ncvs_so), t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijYx,ijxy,yX->IXJY', e_val_so, np.identity(ncvs_so), t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijxy,ijYx,yX->IXJY', e_val_so, np.identity(ncvs_so), t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijXx,ijYy,xy->IXJY', e_val_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,IJ,ijYx,ijXy,yx->IXJY', e_val_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijYx,ijxy,yX->IXJY', e_val_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IJ,ijxy,ijYx,yX->IXJY', e_val_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,XY,Iixy,Jixz,yz->IXJY', e_val_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,XY,Jixy,Iixz,zy->IXJY', e_val_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('Xx,IJ,ijxy,ijYz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Xx,IJ,ijxy,ijYz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('Xx,IJ,ijxy,ijYz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,ijxy,ijXz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,ijxy,ijyz,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('Yx,IJ,ijxy,ijXz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('Yx,IJ,ijxy,ijyz,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,ijxy,ijXz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,IJ,ijxy,ijyz,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ijXx,ijYz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ijYx,ijXz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ijYx,ijyz,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ijxz,ijYz,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ijXx,ijYz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ijYx,ijXz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ijYx,ijyz,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ijYx,ijyz,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ijxz,ijYz,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ijXx,ijYz,yz->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ijYx,ijXz,zy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,IJ,ijYx,ijyz,zX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ijxz,ijYz,yX->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,XY,Iixz,Jiyw,zw->IXJY', h_aa_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,XY,Iixz,Jizw,yw->IXJY', h_aa_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += einsum('xy,XY,Iixz,Jiyw,zw->IXJY', h_aa_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,XY,Iixz,Jizw,yw->IXJY', h_aa_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,XY,Jixz,Iizw,wy->IXJY', h_aa_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,XY,Jixz,Iizw,wy->IXJY', h_aa_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,ijxz,ijyw,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,ijxz,ijzw,wy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,ijyz,ijzw,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,ijxz,ijyw,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,ijxz,ijyw,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,ijxz,ijzw,wy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,XxYy,ijyz,ijzw,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,XxYy,ijxz,ijyw,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,ijxz,ijzw,wy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,XxYy,ijyz,ijzw,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,ijYx,ijyw,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,ijyz,ijYw,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,ijyw,ijYw,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,ijYx,ijyw,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Xxyz,ijyz,ijYw,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,ijYx,ijyw,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,ijyw,ijYw,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Xxyz,ijYx,ijyw,wz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,ijyz,ijYw,xw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,ijyw,ijYw,xz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijXx,ijyw,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijxw,ijyz,wX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijxw,ijyw,zX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,ijyz,ijXw,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijyw,ijXw,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijXx,ijyw,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijxw,ijyz,wX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijxw,ijyw,zX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,ijyz,ijXw,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijXx,ijyw,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijxw,ijyz,wX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijxw,ijyw,zX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,ijyw,ijXw,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijXx,ijyw,zw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijxw,ijyz,wX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijxw,ijyw,zX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,ijyz,ijXw,wx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijyw,ijXw,zx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,ijXx,ijYz,wy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ijYx,ijzw,yX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,ijXx,ijYz,wy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ijYx,ijzw,yX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,ijXx,ijYz,wy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ijYx,ijzw,yX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,ijXx,ijYz,wy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ijYx,ijzw,yX->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XY,xyzw,Iixy,Jizu,wu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XY,xyzw,Iixu,Jizw,uy->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,xyzw,Iixu,Jizu,wy->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XY,xyzw,Iixy,Jizu,wu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp += 1/2 * einsum('XY,xyzw,Iixu,Jizw,uy->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= einsum('XY,xyzw,Iixu,Jizu,wy->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ca_so, optimize = einsum_type)
temp -= 1/2 * einsum('IiXx,Jiyz,Yxyz->IXJY', t1_xxaa, v_xxaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Iixy,JiYz,xyXz->IXJY', t1_xxaa, v_xxaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Iixy,Jixz,YyXz->IXJY', t1_xxaa, v_xxaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IiXx,Jiyz,Yxyz->IXJY', t1_xvaa, v_xvaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Iixy,JiYz,xyXz->IXJY', t1_xvaa, v_xvaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Iixy,Jixz,YyXz->IXJY', t1_xvaa, v_xvaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('JiYx,Iiyz,yzXx->IXJY', t1_xxaa, v_xxaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Jixy,IiXz,Yzxy->IXJY', t1_xxaa, v_xxaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Jixy,Iixz,YzXy->IXJY', t1_xxaa, v_xxaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('JiYx,Iiyz,yzXx->IXJY', t1_xvaa, v_xvaa_so, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('Jixy,IiXz,Yzxy->IXJY', t1_xvaa, v_xvaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('Jixy,Iixz,YzXy->IXJY', t1_xvaa, v_xvaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('I,IiXx,Jiyz,Yxyz->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('I,Iixy,JiYz,xyXz->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Iixy,Jixz,YyXz->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('I,IiXx,Jiyz,Yxyz->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('I,Iixy,JiYz,xyXz->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('I,Iixy,Jixz,YyXz->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('J,IiXx,Jiyz,Yxyz->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('J,Iixy,JiYz,xyXz->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Iixy,Jixz,YyXz->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('J,IiXx,Jiyz,Yxyz->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('J,Iixy,JiYz,xyXz->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('J,Iixy,Jixz,YyXz->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IiXx,Jiyz,Yxyz->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,Iixy,JiYz,xyXz->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Iixy,Jixz,YyXz->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Jixy,Iixz,YzXy->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,IiXx,Jiyz,Yxyz->IXJY', e_val_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('i,Iixy,JiYz,xyXz->IXJY', e_val_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Iixy,Jixz,YyXz->IXJY', e_val_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('i,Jixy,Iixz,YzXy->IXJY', e_val_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,Iixy,Jizw,Yyzw->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xx,Iixy,Jizw,Yyzw->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,Jixy,Iizw,zwXy->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yx,Jixy,Iizw,zwXy->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IiXx,Jizw,Yyzw->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Iixz,JiYw,yzXw->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xy,Iixz,Jiyw,YzXw->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Iixz,Jizw,YyXw->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,IiXx,Jizw,Yyzw->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Iixz,JiYw,yzXw->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xy,Iixz,Jiyw,YzXw->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Iixz,Jizw,YyXw->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,JiYx,Iizw,zwXy->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jixz,IiXw,Ywyz->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jixz,Iizw,YwXy->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,JiYx,Iizw,zwXy->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jixz,IiXw,Ywyz->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('xy,Jixz,Iizw,YwXy->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,ijYx,ijyz,yzXx->IXJY', np.identity(ncvs_so), t1_xxaa, v_xxaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,ijxy,ijYz,xyXz->IXJY', np.identity(ncvs_so), t1_xxaa, v_xxaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ijYx,ijyz,yzXx->IXJY', np.identity(ncvs_so), t1_vxaa, v_vxaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,ijxy,ijYz,xyXz->IXJY', np.identity(ncvs_so), t1_vxaa, v_vxaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,ijYx,ijyz,yzXx->IXJY', np.identity(ncvs_so), t1_vvaa, v_vvaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,ijxy,ijYz,xyXz->IXJY', np.identity(ncvs_so), t1_vvaa, v_vvaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,Iixy,Jizw,xyzw->IXJY', np.identity(ncas_so), t1_xxaa, v_xxaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,Iixy,Jizw,xyzw->IXJY', np.identity(ncas_so), t1_xvaa, v_xvaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,Jixy,Iizw,zwxy->IXJY', np.identity(ncas_so), t1_xxaa, v_xxaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XY,Jixy,Iizw,zwxy->IXJY', np.identity(ncas_so), t1_xvaa, v_xvaa_so, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XxYy,Iiyz,Jiwu,xzwu->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XxYy,Iiyz,Jiwu,xzwu->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XxYy,Jixz,Iiwu,wuyz->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('XxYy,Jixz,Iiwu,wuyz->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Xxyz,Iiyz,Jiwu,Yxwu->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Iiyw,JiYu,xwzu->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Iiyw,Jiwu,Yxzu->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Xxyz,Iiyz,Jiwu,Yxwu->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Iiyw,JiYu,xwzu->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Xxyz,Iiyw,Jiwu,Yxzu->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Xxyz,JiYx,Iiwu,wuyz->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Xxyz,Jixw,Iiyu,Yuzw->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xxyz,Jixw,Iiwu,Yuyz->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Xxyz,JiYx,Iiwu,wuyz->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Xxyz,Jixw,Iiyu,Yuzw->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Xxyz,Jixw,Iiwu,Yuyz->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Yxyz,IiXx,Jiwu,yzwu->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Yxyz,Iixw,Jiyu,zwXu->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yxyz,Iixw,Jiwu,yzXu->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Yxyz,IiXx,Jiwu,yzwu->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('Yxyz,Iixw,Jiyu,zwXu->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Yxyz,Iixw,Jiwu,yzXu->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Yxyz,Jiyz,Iiwu,wuXx->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Jiyw,IiXu,zuxw->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Jiyw,Iiwu,zuXx->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Yxyz,Jiyz,Iiwu,wuXx->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Jiyw,IiXu,zuxw->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('Yxyz,Jiyw,Iiwu,zuXx->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,IiXx,JiYu,zwyu->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xyzw,IiXx,Jizu,Ywyu->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Iixy,JiYu,zwXu->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,Iixy,Jizu,YwXu->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xyzw,Iixu,JiYz,wuXy->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iixu,JiYu,zwXy->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,Iixu,Jizw,YuXy->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xyzw,Iixu,Jizu,YwXy->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,IiXx,JiYu,zwyu->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xyzw,IiXx,Jizu,Ywyu->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Iixy,JiYu,zwXu->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,Iixy,Jizu,YwXu->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += einsum('xyzw,Iixu,JiYz,wuXy->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iixu,JiYu,zwXy->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xyzw,Iixu,Jizw,YuXy->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('xyzw,Iixu,Jizu,YwXy->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,JiYx,IiXu,yuzw->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Jixy,IiXu,Yuzw->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Jixu,IiXu,Yyzw->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,JiYx,IiXu,yuzw->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Jixy,IiXu,Yuzw->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Jixu,IiXu,Yyzw->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('I,XY,Iixy,Jizw,xyzw->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('I,XY,Iixy,Jizw,xyzw->IXJY', e_cvs_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('J,XY,Iixy,Jizw,xyzw->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('J,XY,Iixy,Jizw,xyzw->IXJY', e_cvs_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,ijYx,ijyz,yzXx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,ijxy,ijYz,xyXz->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,ijYx,ijyz,yzXx->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,ijxy,ijYz,xyXz->IXJY', e_cvs_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,XY,Iixy,Jizw,xyzw->IXJY', e_cvs_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,ijYx,ijyz,yzXx->IXJY', e_val_so, np.identity(ncvs_so), t1_vxaa, t1_vxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,ijxy,ijYz,xyXz->IXJY', e_val_so, np.identity(ncvs_so), t1_vxaa, t1_vxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,ijYx,ijyz,yzXx->IXJY', e_val_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,IJ,ijxy,ijYz,xyXz->IXJY', e_val_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('i,XY,Iixy,Jizw,xyzw->IXJY', e_val_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('Yx,IJ,ijxy,ijzw,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yx,IJ,ijxy,ijzw,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('Yx,IJ,ijxy,ijzw,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('xy,IJ,ijYx,ijzw,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ijxz,ijYw,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ijYx,ijzw,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('xy,IJ,ijxz,ijYw,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('xy,IJ,ijYx,ijzw,zwXy->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,IJ,ijxz,ijYw,yzXw->IXJY', h_aa_so, np.identity(ncvs_so), t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,XY,Iixz,Jiwu,yzwu->IXJY', h_aa_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,XY,Iixz,Jiwu,yzwu->IXJY', h_aa_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,XY,Jixz,Iiwu,wuyz->IXJY', h_aa_so, np.identity(ncas_so), t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xy,XY,Jixz,Iiwu,wuyz->IXJY', h_aa_so, np.identity(ncas_so), t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,XxYy,ijxz,ijwu,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,XxYy,ijyz,ijwu,xzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,ijxz,ijwu,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,XxYy,ijyz,ijwu,xzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,XxYy,ijxz,ijwu,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,XxYy,ijyz,ijwu,xzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,Xxyz,ijYx,ijwu,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,ijyw,ijYu,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Xxyz,ijYx,ijwu,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Xxyz,ijyw,ijYu,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,Xxyz,ijYx,ijwu,wuyz->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Xxyz,ijyw,ijYu,xwzu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,Yxyz,ijXx,ijwu,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijxw,ijyu,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,ijxw,ijwu,yzXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,Yxyz,ijyz,ijwu,wuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijyw,ijXu,zuxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijyw,ijwu,zuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,ijXx,ijwu,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijxw,ijyu,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,ijyz,ijwu,wuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,ijyw,ijXu,zuxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijxw,ijyu,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,Yxyz,ijxw,ijwu,yzXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,Yxyz,ijyw,ijwu,zuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,Yxyz,ijXx,ijwu,yzwu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/2 * einsum('IJ,Yxyz,ijxw,ijyu,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,ijxw,ijwu,yzXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,Yxyz,ijyz,ijwu,wuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijyw,ijXu,zuxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijyw,ijwu,zuXx->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ijXx,ijYu,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ijYx,ijXu,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijzu,yuXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,xyzw,ijxy,ijYu,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,ijxu,ijYu,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ijXx,ijYu,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ijYx,ijXu,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijzu,yuXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ijxy,ijYu,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijzu,yuXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,xyzw,ijxu,ijYu,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vxaa, t1_vxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ijXx,ijYu,zwyu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ijYx,ijXu,yuzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijzu,yuXw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,xyzw,ijxy,ijYu,zwXu->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,xyzw,ijxu,ijYu,zwXy->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/16 * einsum('XY,xyzw,Iixy,Jiuv,zwuv->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('XY,xyzw,Iixu,Jizv,wuyv->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Iixu,Jiuv,zwyv->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/16 * einsum('XY,xyzw,Iixy,Jiuv,zwuv->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= einsum('XY,xyzw,Iixu,Jizv,wuyv->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Iixu,Jiuv,zwyv->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/16 * einsum('XY,xyzw,Jixy,Iiuv,uvzw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Jixu,Iiuv,yvzw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccaa_so, optimize = einsum_type)
temp += 1/16 * einsum('XY,xyzw,Jixy,Iiuv,uvzw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('XY,xyzw,Jixu,Iiuv,yvzw->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Iixy,Jizw,YxyXzw->IXJY', t1_xxaa, v_xxaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Iixy,Jizw,YxyXzw->IXJY', t1_xvaa, v_xvaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Jixy,Iizw,YzwXxy->IXJY', t1_xxaa, v_xxaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('Jixy,Iizw,YzwXxy->IXJY', t1_xvaa, v_xvaa_so, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('I,Iixy,Jizw,YxyXzw->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('I,Iixy,Jizw,YxyXzw->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('J,Iixy,Jizw,YxyXzw->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('J,Iixy,Jizw,YxyXzw->IXJY', e_cvs_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('i,Iixy,Jizw,YxyXzw->IXJY', e_cvs_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('i,Iixy,Jizw,YxyXzw->IXJY', e_val_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,Iixz,Jiwu,YyzXwu->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,Iixz,Jiwu,YyzXwu->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,Jixz,Iiwu,YwuXyz->IXJY', h_aa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xy,Jixz,Iiwu,YwuXyz->IXJY', h_aa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Iiyw,Jiuv,Yxwzuv->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Xxyz,Iiyw,Jiuv,Yxwzuv->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Xxyz,Jixw,Iiuv,Yuvyzw->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Xxyz,Jixw,Iiuv,Yuvyzw->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Yxyz,Iixw,Jiuv,yzwXuv->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('Yxyz,Iixw,Jiuv,yzwXuv->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Jiyw,Iiuv,zuvXxw->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('Yxyz,Jiyw,Iiuv,zuvXxw->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,IiXx,Jiuv,Yzwyuv->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('xyzw,Iixy,Jiuv,YzwXuv->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Iixu,JiYv,zwuXyv->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp += einsum('xyzw,Iixu,Jizv,YwuXyv->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iixu,Jiuv,YzwXyv->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,IiXx,Jiuv,Yzwyuv->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('xyzw,Iixy,Jiuv,YzwXuv->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Iixu,JiYv,zwuXyv->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp += einsum('xyzw,Iixu,Jizv,YwuXyv->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Iixu,Jiuv,YzwXyv->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,JiYx,Iiuv,yuvXzw->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('xyzw,Jixy,Iiuv,YuvXzw->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Jixu,IiXv,Yyvzwu->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Jixu,Iiuv,YyvXzw->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,JiYx,Iiuv,yuvXzw->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/16 * einsum('xyzw,Jixy,Iiuv,YuvXzw->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('xyzw,Jixu,IiXv,Yyvzwu->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('xyzw,Jixu,Iiuv,YyvXzw->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,Yxyz,ijxw,ijuv,yzwXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,ijyw,ijuv,zuvXxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,Yxyz,ijxw,ijuv,yzwXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/4 * einsum('IJ,Yxyz,ijyw,ijuv,zuvXxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,Yxyz,ijxw,ijuv,yzwXuv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('IJ,Yxyz,ijyw,ijuv,zuvXxw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,xyzw,ijYx,ijuv,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ijxu,ijYv,zwuXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ijYx,ijuv,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/4 * einsum('IJ,xyzw,ijxu,ijYv,zwuXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/16 * einsum('IJ,xyzw,ijYx,ijuv,yuvXzw->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_cccaaa_so, optimize = einsum_type)
temp += 1/8 * einsum('IJ,xyzw,ijxu,ijYv,zwuXyv->IXJY', np.identity(ncvs_so), v_aaaa_so, t1_vvaa, t1_vvaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('XY,xyzw,Iixu,Jivs,zwuyvs->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('XY,xyzw,Iixu,Jivs,zwuyvs->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('XY,xyzw,Jixu,Iivs,yvszwu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xxaa, t1_xxaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('XY,xyzw,Jixu,Iivs,yvszwu->IXJY', np.identity(ncas_so), v_aaaa_so, t1_xvaa, t1_xvaa, rdm_cccaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Iixu,Jivs,YzwuXyvs->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Iixu,Jivs,YzwuXyvs->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Jixu,Iivs,YyvsXzwu->IXJY', v_aaaa_so, t1_xxaa, t1_xxaa, rdm_ccccaaaa_so, optimize = einsum_type)
temp -= 1/8 * einsum('xyzw,Jixu,Iivs,YyvsXzwu->IXJY', v_aaaa_so, t1_xvaa, t1_xvaa, rdm_ccccaaaa_so, optimize = einsum_type)
